{"version":3,"sources":["js/actions/game.js","js/reducers/island.js","js/actions/warehouse.js","js/actions/construction.js","js/data/building-definitions.js","js/actions/housing.js","js/actions/trade.js","js/data/resource-definitions.js","js/reducers/warehouse.js","js/reducers/construction.js","js/actions/building.js","js/reducers/building.js","js/reducers/couriers.js","js/reducers/housing.js","js/reducers/population.js","js/reducers/amenities.js","js/data/population-definitions.js","js/reducers/consume.js","js/reducers/growth.js","js/reducers/finance.js","js/data/level-up-definitions.js","js/reducers/level-up.js","js/actions/cheats.js","js/reducers/cheat.js","js/data/trader-info.js","js/reducers/trader.js","js/data/ship-definitions.js","js/reducers/navy.js","js/store/initial-state.js","js/reducers/root-reducer.js","js/scheduler.js","js/components/IslandNameView.js","js/components/cheats/TimeFactor.js","js/selectors.js","js/components/PriceTooltip.js","js/components/ResourcePanel.js","js/components/CourierMonitor.js","js/components/ConstructionPanel.js","js/components/BuildingDetails.js","js/components/BuildingIcon.js","js/components/BuildingPanel.js","js/components/PopulationPanel.js","js/components/HousingPanel.js","js/components/SaveLoad.js","js/components/TradePanel.js","js/components/MilestonePane.js","js/components/FleetDetails.js","js/components/FleetView.js","js/Game.js","js/serviceWorker.js","index.js","js/store/store.js"],"names":["ACTIONS","INIT","TICK","SAVE_GAME","LOAD_GAME","RESET_SAVE","CHANGE_NAME","saveGame","type","BUILD_WAREHOUSE","UPDGRADE_WAREHOUSE","UPGRADE_STOREHOUSE","CONSTRUCT_BUILDING","DESTROY_BUILDING","BUILDING_CATEGORY","AMENITY","PRODUCER","HOUSE","WAREHOUSE","NAVAL","BUILDING_SUB_CATEGORY","buildingStatus","AWAITING_RESOURCES","WORKING","OUTBOX_FULL","DISABLED","BuildingDefinitions","marketplace","name","abbreviation","description","category","produces","community","upkeep","chapel","faith","tavern","entertainment","church","prison","security","fishinghut","consumes","fish","produceTime","disabledUpkeep","lumberjackhut","wood","orchard","apple","ciderfarm","cider","hempfarm","hemp","weavers","linen","stonemason","stone","oremine","ore","charcoalhut","charcoal","smelter","iron","toolmaker","tool","ropeyard","rope","wheatfield","wheat","mill","flour","bakery","bread","weaponsmith","weapon","hopsfield","hop","brewery","ale","potashpit","potash","glasssmelter","quartz","glass","saltmine","brine","saltworks","salt","pigfarm","hide","tannery","leather","papermill","paper","printingpress","ink","book","alms","populationCategory","populationCap","peasanthouse","ascendsTo","citizenhouse","cost","patricianhouse","noblehouse","smallwarehouse","couriers","capacity","upgradesTo","upgradeCost","gold","mediumwarehouse","largewarehouse","smallstockpile","mediumstockpile","largestockpile","smallstorehouse","smallshipyard","subCategory","shipsBuilt","largeshipyard","repaircrane","BUILD_HOUSE","ASCEND_HOUSE","BUY_GOODS","SELL_GOODS","DISMISS_TRADER","ResourceDefinitions","baseTradePrice","spice","resourceDecorations","reserved","pending","initResourceState","owned","unlocked","deductCost","resources","resourceCopy","Object","assign","entries","ingredient","amount","ingredientCopy","DISABLE_BUILDING","ENABLE_BUILDING","initialProducerState","status","progress","efficiency","efficiencyTimer","efficiencySupplied","inbox","outbox","EFFICIENCY_FACTOR","EFFICIENCY_TIMER","EFFICIENCY_MINIMUM","BASE_EFFICIENCY_MAXIMUM","BASE_IN_OUT_BOX_CAPACITY","initializeInOutBox","building","buildingInfo","buildingId","keys","good","doProductionTick","timeIntervalS","buildingCopy","enabled","progressEfficiency","consumed","canAfford","produced","outboxHasRoom","inboxCopy","outboxCopy","Math","min","max","courierState","initCourier","timeThreshold","jobDescription","payload","markedForDeath","state","action","gameActions","startingWarehouse","warehouse","courierArrayCopy","slice","addCouriers","courierObjCopy","warehouseActions","thisWarehouse","toUpgrade","nextWarehouse","couriersToAdd","courierList","nextWarehouseId","builtWarehouse","toConstruct","id","addedCouriers","newState","newCouriers","newArray","constructionActions","toDestroy","couriersToRemove","couriersRemoved","courierIndex","length","courier","markmarkedForDeath","splice","stateCopy","couriersCopy","warehouseMax","totalCapacity","buildings","buildingRefCopy","newJobs","findJobs","jobArrayCopy","jobQueue","concat","jobList","jobRefCopy","jobQueueMap","jobRef","courierListCopy","map","newCourier","nextJobIndex","getNextAvailableJob","nextJob","pickupFromId","from","deliverToId","to","carrying","pickupFrom","deliverTo","inboxRoom","currentSupply","floor","currentOutbox","warehouseRoom","forEach","tickIntervalSeconds","fromId","toId","product","hasOwnProperty","resourceToTake","resourceToDeliver","killedCouriers","filter","courierArray","numToAdd","i","uuidv4","push","SUPPLY_SUFFIX","PICKUP_SUFFIX","existingJobs","supplies","values","supplyKey","resource","newJob","pickups","reduce","accumulator","pickupKey","jobArray","jobIndex","initHouseState","popProgress","currentPop","ascensionFactors","patrician","rightsLists","calculateAscensionRights","allTypes","toCheck","totalHouses","sum","pop","totalAscensionRights","ascendTo","alreadyAscended","remainingAscensionRights","initValues","maxPopulation","happiness","canAscend","consumeInfo","beggarValues","unhoused","beggarTimer","calculateBeggarCount","population","amenities","Buildings","amenity","PopulationDefinitions","beggar","taxRate","quantity","weight","peasant","citizen","noble","popType","popOriginal","currentHappiness","pctSatisfied","happinessDiff","abs","BEGGAR_ARRIVAL_MIN","BEGGAR_ARRIVAL_MAX","houses","housing","populationCounts","newAbodes","abodes","abodeOriginal","abode","curHappiness","houseId","growthFactor","popCategory","popCount","newPop","incomingBeggars","getIncomingBeggars","beggarDeficit","lowerBound","upperBound","rn","integer","financeInfo","maintenanceCost","taxRevenue","warehouseMaintenance","totalMaintenance","totalTaxes","happinessFactor","unlockThresholds","unlocks","title","island","level","unlockPopType","popRequired","constructions","construction","conId","resId","popUnlocked","types","unlockedHouse","SET_TIME_FACTOR","cheat","timeFactor","Traders","lord","rates","buy","sell","baseCapacity","prince","BASE_TRADER_STAY_TIME_SECONDS","BASE_TRADER_VACANCY_TIME_SECONDS","INIT_STATE","traderId","timer","timeToLeave","wares","newGame","dismissCost","newTrader","currentState","time","traders","selectedTrader","random","traderInfo","maxCapacity","goodBasePrice","buyPrice","sellPrice","held","ships","flagship","typeName","cargoSlots","speed","loadFactor","hp","attack","maintenance","smalltrader","points","smallwarship","largetrader","largewarship","cannon","corsair","smallpiratewarship","largepiratewarship","boatTemplate","cargo","fleetTemplate","currentLocation","currentDestination","INITIAL_STATE","combinedReducer","combineReducers","warehouseCopy","Resources","resourceId","newResources","newResource","housingActions","warehouseToBuild","currentWarehouse","tradeActions","updatedResources","atPrice","goodBought","toConstructId","newOwned","toDestroyId","GAME_ACTIONS","updatedBuilding","CONSTRUCTION_ACTIONS","buildingToBuild","newBuilding","newBuildings","newStorehouse","buildingToDestroy","toDisable","disabled","toEnable","toBuild","houseData","fromHouseId","fromHouse","toHouseId","fromType","toType","nextHouse","ascendIndex","findIndex","house","populationState","houseBuilt","modifiedPop","currentHouse","oldPop","nextPop","maxBeggars","trader","toBuy","navy","currentHp","Boats","fleets","dockBuildings","rootReducer","localStorage","setItem","btoa","JSON","stringify","initState","saveState","cheatState","intermediateState","amenityState","consumptionState","consume","growthState","growth","financeState","finance","levelUp","Scheduler","functionToRun","targetInterval","this","targetFunction","running","lastTick","Date","now","setTimeout","repeater","currentTime","elapsedTime","bind","IslandNameView","useSelector","dispatch","useDispatch","className","onClick","toName","prompt","changeName","substring","TimeFactor","useState","setTf","onSubmit","event","setTimeFactor","preventDefault","onChange","e","target","value","required","filterUnlocked","collectionObject","key","setAffordable","buyable","costProperty","PriceTooltip","props","ingredientsList","headerText","header","popover","Popover","Title","as","Content","OverlayTrigger","placement","delay","show","overlay","children","ResourcePanel","warehouseType","shallowEqual","warehouseInfo","upgradeButton","Button","variant","size","item","resourceName","toFixed","CourierMonitor","ConstructionPanel","buyableCollection","buyableId","setAllAffordable","constructionList","buyFunction","Container","BuildingDetails","destroyBuildingFn","destroyBuilding","toggleEnableFn","enableBuilding","upgradeWarehouseFn","storehouseToUpgrade","Modal","onHide","onClose","Header","closeButton","Body","Footer","BuildingIcon","showDetails","setShowDetails","toolTipContent","statusColor","Tooltip","BuildingPanel","buildingIcons","PopulationPanel","populationList","popName","HousingPanel","housingList","houseInfo","nextHouseInfo","housedPopulation","availableAscensions","toHouse","toBuilding","ascendHouse","SaveLoad","getItem","navigator","clipboard","writeText","then","alert","loadState","parse","atob","window","confirm","TradePanel","traderState","goldOnHand","goodsToTrade","tradeData","goodInWarehouse","canBuy","canSell","goodToBuy","goodToSell","MilestonePane","islandLevel","unlockReqs","Population","FleetDetails","fleet","fleetId","fluid","Row","Col","FleetView","setKey","fleetLinks","fleetSize","Nav","Item","Link","eventKey","Tab","activeKey","onSelect","sm","Pane","MS_TO_S","Game","timeIntervalMs","scheduler","console","log","autoSaveScheduler","useEffect","start","Tabs","defaultActiveKey","Boolean","location","hostname","match","ReactDOM","render","store","initialState","loaded","createStore","applyMiddleware","thunk","__REDUX_DEVTOOLS_EXTENSION__","configureStore","document","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.5a131fd6.chunk.js","sourcesContent":["export const ACTIONS = {\n  INIT: 'INIT',\n  TICK: 'TICK',\n  SAVE_GAME: 'SAVE_GAME',\n  LOAD_GAME: 'LOAD_GAME',\n  RESET_SAVE: 'RESET_SAVE',\n  CHANGE_NAME: 'CHANGE_NAME'\n};\n\nexport function init() {\n  return { type: ACTIONS.INIT };\n}\n\nexport function tick(tickIntervalSeconds) {\n  return { type: ACTIONS.TICK, payload: { tickIntervalSeconds: tickIntervalSeconds }};\n}\n\nexport function saveGame() {\n  return { type: ACTIONS.SAVE_GAME };\n}\n\nexport function loadGame(saveState) {\n  return { type: ACTIONS.LOAD_GAME, payload: { saveState: saveState }};\n}\n\nexport function resetSave() {\n  return { type: ACTIONS.RESET_SAVE };\n}\n\nexport function changeName(name) {\n  return { type: ACTIONS.CHANGE_NAME, payload: { name: name }};\n}\n","import { ACTIONS as gameActions } from '../actions/game';\n\nexport default function(island={}, action) {\n  const payload = action.payload;\n  switch (action.type) {\n    case gameActions.CHANGE_NAME: {\n      return {...island, name: payload.name};\n    }\n    default:\n      return island;\n  }\n}\n","export const ACTIONS = {\n  BUILD_WAREHOUSE: 'BUILD_WAREHOUSE',\n  UPDGRADE_WAREHOUSE: 'UPGRADE_WAREHOUSE',\n  UPGRADE_STOREHOUSE: 'UPGRADE_STOREHOUSE'\n};\n\nexport function buildWarehouse(warehouse) {\n  return { type: ACTIONS.BUILD_WAREHOUSE, payload: { toConstruct: warehouse }};\n}\n\nexport function upgradeWarehouse(currentWarehouse) {\n  return { type: ACTIONS.UPDGRADE_WAREHOUSE, payload: { toUpgrade: currentWarehouse }};\n}\n\nexport function upgradeStorehouse(storehouseToUpgrade) {\n  return { type: ACTIONS.UPGRADE_STOREHOUSE, payload: { toUpgrade: storehouseToUpgrade }};\n}\n","export const ACTIONS = {\n  CONSTRUCT_BUILDING: 'CONSTRUCT_BUILDING',\n  DESTROY_BUILDING: 'DESTROY_BUILDING'\n};\n\nexport function constructBuilding(toConstruct) {\n  return { type: ACTIONS.CONSTRUCT_BUILDING, payload: { toConstruct: toConstruct } };\n};\n\nexport function destroyBuilding(toDestroy) {\n  return { type: ACTIONS.DESTROY_BUILDING, payload: { toDestroy: toDestroy }};\n};\n","export const BUILDING_CATEGORY = {\n  AMENITY: 'AMENITY',\n  PRODUCER: 'PRODUCER',\n  HOUSE: 'HOUSE',\n  WAREHOUSE: 'WAREHOUSE',\n  NAVAL: 'NAVAL'\n}\n\nexport const BUILDING_SUB_CATEGORY = {\n  SHIPYARD: 'SHIPYARD'\n}\n\nexport const buildingStatus = {\n  AWAITING_RESOURCES: 'AWAITING_RESOURCES',\n  WORKING: 'WORKING',\n  OUTBOX_FULL: 'OUTBOX_FULL',\n  DISABLED: 'DISABLED'\n}\n\nconst BuildingDefinitions = {\n  // Amenities\n  marketplace: {\n    name: 'Marketplace',\n    abbreviation: 'M',\n    description: 'Provides a place for villagers to meet',\n    category: BUILDING_CATEGORY.AMENITY,\n    produces: {\n      community: 2.5\n    },\n    upkeep: 10\n  },\n  chapel: {\n    name: 'Chapel',\n    abbreviation: 'Ch',\n    description: 'A basic building for villagers to worship',\n    category: BUILDING_CATEGORY.AMENITY,\n    produces: {\n      faith: 3\n    },\n    upkeep: 15\n  },\n  tavern: {\n    name: 'Tavern',\n    abbreviation: 'Tv',\n    description: 'Provides citizens a place to drink',\n    category: BUILDING_CATEGORY.AMENITY,\n    produces: {\n      entertainment: 9\n    },\n    upkeep: 30\n  },\n  church: {\n    name: 'Church',\n    abbreviation: 'Ch',\n    description: 'Provides a larger location to worship',\n    category: BUILDING_CATEGORY.AMENITY,\n    produces: {\n      faith: 12\n    },\n    upkeep: 40\n  },\n  prison: {\n    name: 'Prison',\n    abbreviation: 'Pr',\n    description: 'Jails bad folks. Provides a sense of security',\n    category: BUILDING_CATEGORY.AMENITY,\n    produces: {\n      security: 16\n    }\n  },\n\n  // Producers\n  fishinghut: {\n    name: 'Fisherman\\'s Hut',\n    abbreviation: 'F',\n    description: 'Gathers fish',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {},\n    produces: {\n      fish: 1\n    },\n    produceTime: 30,\n    upkeep: 15,\n    disabledUpkeep: 5\n  },\n  lumberjackhut: {\n    name: 'Lumberjack\\'s Hut',\n    abbreviation: 'L',\n    description: 'Gathers wood',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {},\n    produces: {\n      wood: 1\n    },\n    produceTime: 40,\n    upkeep: 5,\n    disabledUpkeep: 0\n  },\n  orchard: {\n    name: 'Orchard',\n    abbreviation: 'O',\n    description: 'Grows apples to be turned into cider',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {},\n    produces: {\n      apple: 1\n    },\n    produceTime: 100,\n    upkeep: 5,\n    disabledUpkeep: 0\n  },\n  ciderfarm: {\n    name: 'Cidery',\n    abbreviation: 'C',\n    description: 'Processes apples into cider',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {\n      apple: 1\n    },\n    produces: {\n      cider: 1\n    },\n    produceTime: 40,\n    upkeep: 15,\n    disabledUpkeep: 5\n  },\n  hempfarm: {\n    name: 'Hemp Plantation',\n    abbreviation: 'H',\n    description: 'Grows hemp',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {},\n    produces: {\n      hemp: 1\n    },\n    produceTime: 60,\n    upkeep: 20,\n    disabledUpkeep: 10\n  },\n  weavers: {\n    name: 'Weaver\\'s Hut',\n    abbreviation: 'W',\n    description: 'Uses hemp to create clothing',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {\n      hemp: 1\n    },\n    produces: {\n      linen: 1\n    },\n    produceTime: 30,\n    upkeep: 25,\n    disabledUpkeep: 12\n  },\n  stonemason: {\n    name: 'Stonemason',\n    abbreviation: 'Sm',\n    description: 'Turns raw stone into stone bricks',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {},\n    produces: {\n      stone: 1\n    },\n    produceTime: 30,\n    upkeep: 20,\n    disabledUpkeep: 10\n  },\n  oremine: {\n    name: 'Ore mine',\n    abbreviation: 'Om',\n    description: 'Mines raw ore from the ground',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {},\n    produces: {\n      ore: 1\n    },\n    produceTime: 30,\n    upkeep: 20,\n    disabledUpkeep: 10\n  },\n  charcoalhut: {\n    name: 'Charcoal Burner\\'s Hut',\n    abbreviation: 'Cc',\n    description: 'Burns wood down into charcoal',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {},\n    produces: {\n      charcoal: 1\n    },\n    produceTime: 30,\n    upkeep: 10,\n    disabledUpkeep: 0\n  },\n  smelter: {\n    name: 'Iron Smelter',\n    abbreviation: 'I',\n    description: 'Converts raw ore to iron ingots',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {\n      ore: 1,\n      charcoal: 1\n    },\n    produces: {\n      iron: 1\n    },\n    produceTime: 30,\n    upkeep: 20,\n    disabledUpkeep: 10\n  },\n  toolmaker: {\n    name: 'Toolmaker\\'s Workshop',\n    abbreviation: 'TW',\n    description: 'Creates tools out of iron',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {\n      iron: 0.5\n    },\n    produces: {\n      tool: 1\n    },\n    produceTime: 30,\n    upkeep: 30,\n    disabledUpkeep: 15\n  },\n  ropeyard: {\n    name: 'Ropeyard',\n    abbreviation: 'Rp',\n    description: 'Creates rope from hemp',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {\n      hemp: 0.5\n    },\n    produces: {\n      rope: 1\n    },\n    produceTime: 30,\n    upkeep: 40,\n    disabledUpkeep: 20\n  },\n  wheatfield: {\n    name: 'Wheat Field',\n    abbreviation: 'W',\n    description: 'Grows wheat',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {},\n    produces: {\n      wheat: 1\n    },\n    produceTime: 30,\n    upkeep: 5,\n    disabledUpkeep: 0\n  },\n  mill: {\n    name: 'Flour Mill',\n    abbreviation: 'FM',\n    description: 'Grinds wheat into flour',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {\n      wheat: 1\n    },\n    produces: {\n      flour: 1\n    },\n    produceTime: 15,\n    upkeep: 30,\n    disabledUpkeep: 15\n  },\n  bakery: {\n    name: 'Bakery',\n    abbreviation: 'Bk',\n    description: 'Bakes flour into bread',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {\n      flour: 1\n    },\n    produces: {\n      bread: 1\n    },\n    produceTime: 15,\n    upkeep: 30,\n    disabledUpkeep: 15\n  },\n  weaponsmith: {\n    name: 'Weaponsmith',\n    abbreviation: 'Ws',\n    description: 'Forges weapons',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {\n      iron: 1\n    },\n    produces: {\n      weapon: 1\n    },\n    produceTime: 30,\n    upkeep: 30,\n    disabledUpkeep: 15\n  },\n  hopsfield: {\n    name: 'Hops Farm',\n    abbreviation: 'HF',\n    description: 'Grows Hops',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {},\n    produces: {\n      hop: 1\n    },\n    produceTime: 30,\n    upkeep: 10,\n    disabledUpkeep: 5\n  },\n  brewery: {\n    name: 'Brewery',\n    abbreviation: 'Bw',\n    description: 'Brews Ale',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {\n      hop: 1.333,\n      wheat: 1.333\n    },\n    produces: {\n      ale: 1\n    },\n    produceTime: 40,\n    upkeep: 30,\n    disabledUpkeep: 15\n  },\n  potashpit: {\n    name: 'Potash Pit',\n    abbreviation: 'Pp',\n    description: 'Produces Potash',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {},\n    produces: {\n      potash: 1\n    },\n    produceTime: 30,\n    upkeep: 30,\n    disabledUpkeep: 15\n  },\n  glasssmelter: {\n    name: 'Glass Smelter',\n    abbreviation: 'GS',\n    description: 'Melts quartz down into glass',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {\n      potash: 1,\n      quartz: 0.5\n    },\n    produces: {\n      glass: 1\n    },\n    produceTime: 60,\n    upkeep: 30,\n    disabledUpkeep: 15\n  },\n  saltmine: {\n    name: 'Salt Mine',\n    abbreviation: 'SM',\n    description: 'Extracts brine from underground deposits',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {},\n    produces: {\n      brine: 1\n    },\n    produceTime: 15,\n    upkeep: 20,\n    disabledUpkeep: 10\n  },\n  saltworks: {\n    name: 'Saltworks',\n    abbreviation: 'SW',\n    description: 'Refines brine into salt',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {\n      brine: 1,\n      charcoal: 0.5\n    },\n    produces: {\n      salt: 1\n    },\n    produceTime: 15,\n    upkeep: 25,\n    disabledUpkeep: 15\n  },\n  pigfarm: {\n    name: 'Pig Farm',\n    abbreviation: 'PF',\n    description: 'Raises pigs for slaughter. Produces hides',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {},\n    produces: {\n      hide: 1\n    },\n    produceTime: 30,\n    upkeep: 15,\n    disabledUpkeep: 5\n  },\n  tannery: {\n    name: 'Tannery',\n    abbreviation: 'Tn',\n    description: 'Tans hides into leather',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {\n      hide: 1,\n      salt: 0.5\n    },\n    produces: {\n      leather: 1\n    },\n    produceTime: 15,\n    upkeep: 20,\n    disabledUpkeep: 10\n  },\n  papermill: {\n    name: 'Paper Mill',\n    abbreviation: 'PM',\n    description: 'Produces Paper',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {\n      wood: 1\n    },\n    produces: {\n      paper: 1\n    },\n    produceTime: 20,\n    upkeep: 50,\n    disabledUpkeep: 25\n  },\n  printingpress: {\n    name: 'Printing Press',\n    abbreviation: 'PP',\n    description: 'Prints books',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {\n      paper: 0.5,\n      ink: 1\n    },\n    produces: {\n      book: 1\n    },\n    produceTime: 20,\n    upkeep: 50,\n    disabledUpkeep: 25\n  },\n\n\n  // Houses\n  alms: {\n    name: 'Alms House',\n    abbreviation: 'Ah',\n    description: 'Provides shelter for 500 beggars',\n    category: BUILDING_CATEGORY.HOUSE,\n    upkeep: 0,\n    populationCategory: 'beggar',\n    populationCap: 500\n  },\n  peasanthouse: {\n    name: 'Peasant Shack',\n    description: 'Basic home for villagers. Houses 8',\n    category: BUILDING_CATEGORY.HOUSE,\n    upkeep: 0,\n    populationCategory: 'peasant',\n    populationCap: 8,\n    ascendsTo: 'citizenhouse'\n  },\n  citizenhouse: {\n    name: 'Citizen House',\n    description: 'Home for citizens',\n    category: BUILDING_CATEGORY.HOUSE,\n    upkeep: 0,\n    populationCategory: 'citizen',\n    populationCap: 15,\n    ascendsTo: 'patricianhouse',\n    cost: {\n      wood: 1,\n      tool: 1\n    }\n  },\n  patricianhouse: {\n    name: 'Patrician House',\n    description: 'Home for patricians',\n    category: BUILDING_CATEGORY.HOUSE,\n    upkeep: 0,\n    populationCategory: 'patrician',\n    populationCap: 25,\n    ascendsTo: 'noblehouse',\n    cost: {\n      wood: 1,\n      tool: 1,\n      stone: 4\n    }\n  },\n  noblehouse: {\n    name: 'Noble House',\n    description: 'Home for nobles',\n    category: BUILDING_CATEGORY.HOUSE,\n    upkeep: 0,\n    populationCategory: 'noble',\n    populationCap: 40,\n    cost: {\n      wood: 1,\n      tool: 1,\n      stone: 3,\n      glass: 4\n    }\n  },\n\n  // Warehouses\n  smallwarehouse: {\n    name: 'Small Warehouse',\n    description: 'Basic warehouse for your island',\n    category: BUILDING_CATEGORY.WAREHOUSE,\n    upkeep: 10,\n    couriers: 3,\n    capacity: 40,\n    upgradesTo: 'mediumwarehouse',\n    upgradeCost: {\n      gold: 150,\n      wood: 2,\n      tool: 3,\n      stone: 4\n    }\n  },\n  mediumwarehouse: {\n    name: 'Medium Warehouse',\n    description: 'Expanded warehouse',\n    category: BUILDING_CATEGORY.WAREHOUSE,\n    upkeep: 15,\n    couriers: 1,\n    capacity: 10,\n    upgradesTo: 'largewarehouse',\n    upgradeCost: {\n      gold: 350,\n      wood: 2,\n      tool: 1,\n      stone: 3,\n      glass: 2\n    }\n  },\n  largewarehouse: {\n    name: 'Large Warehouse',\n    description: 'Large Warehouse',\n    category: BUILDING_CATEGORY.WAREHOUSE,\n    upkeep: 20,\n    couriers: 1,\n    capacity: 10\n  },\n  smallstockpile: {\n    name: 'Small Stockpile',\n    abbreviation: 'SS',\n    description: 'Small depot. Provides 1 courier',\n    category: BUILDING_CATEGORY.WAREHOUSE,\n    upkeep: 10,\n    couriers: 1,\n    capacity: 0,\n    upgradesTo: 'mediumstockpile',\n    upgradeCost: {\n      gold: 200,\n      wood: 3,\n      tool: 1,\n      stone: 3\n    }\n  },\n  mediumstockpile: {\n    name: 'Medium Stockpile',\n    abbreviation: 'MS',\n    description: 'Medium depot. Provides 2 couriers, and 5 storage',\n    category: BUILDING_CATEGORY.WAREHOUSE,\n    upkeep: 20,\n    couriers: 2,\n    capacity: 5,\n    upgradesTo: 'largestockpile',\n    upgradeCost: {\n      gold: 300,\n      wood: 3,\n      tool: 1,\n      stone: 3,\n      glass: 2\n    }\n  },\n  largestockpile: {\n    name: 'Large Stockpile',\n    abbreviation: 'LS',\n    description: 'Large depot. Provides 3 couriers, and 10 storage',\n    category: BUILDING_CATEGORY.WAREHOUSE,\n    upkeep: 30,\n    couriers: 3,\n    capacity: 5\n  },\n  smallstorehouse: {\n    name: 'Small Storehouse',\n    abbreviation: 'So',\n    description: 'Increases the warehouse capacity',\n    category: BUILDING_CATEGORY.WAREHOUSE,\n    upkeep: 15,\n    couriers: 0,\n    capacity: 15\n  },\n\n  // Shipyard\n  smallshipyard: {\n    name: 'Small Shipyard',\n    description: 'Allows construction of small ships',\n    category: BUILDING_CATEGORY.NAVAL,\n    subCategory: BUILDING_SUB_CATEGORY.SHIPYARD,\n    upkeep: 10,\n    shipsBuilt: ['smalltrader', 'smallwarship']\n  },\n  largeshipyard: {\n    name: 'Large Shipyard',\n    description: 'Allows construction of large vessels',\n    category: BUILDING_CATEGORY.NAVAL,\n    subCategory: BUILDING_SUB_CATEGORY.SHIPYARD,\n    upkeep: 20,\n    shipsBuilt: ['largetrader', 'largewarship']\n  },\n  repaircrane: {\n    name: 'Repair Crane',\n    description: 'Repairs ships that are docked here',\n    category: BUILDING_CATEGORY.NAVAL,\n    upkeep: 20\n  }\n};\n\nexport default BuildingDefinitions;\n","import BuildingDefinitions from '../data/building-definitions';\n\nexport const ACTIONS = {\n  BUILD_HOUSE: 'BUILD_HOUSE',\n  ASCEND_HOUSE: 'ASCEND_HOUSE'\n};\n\nexport function buildHouse(house) {\n  return { type: ACTIONS.BUILD_HOUSE, payload: { toConstruct: house } };\n}\n\nexport function ascendHouse(fromHouse, toHouse) {\n  const toBuilding = BuildingDefinitions[toHouse];\n  return { type: ACTIONS.ASCEND_HOUSE, payload: { toConstruct: toBuilding, fromHouse: fromHouse }};\n}\n","export const ACTIONS = {\n  BUY_GOODS: 'BUY_GOODS',\n  SELL_GOODS: 'SELL_GOODS',\n  DISMISS_TRADER: 'DISMISS_TRADER'\n};\n\nexport function buyGood(goodToBuy, amount, atPrice) {\n  return { type: ACTIONS.BUY_GOODS, payload: { product: goodToBuy, amount: amount, atPrice: atPrice }};\n};\n\nexport function sellGood(goodToSell, amount, atPrice) {\n  return { type: ACTIONS.SELL_GOODS, payload: { product: goodToSell, amount: amount, atPrice: atPrice }};\n};\n\nexport function dismissTrader(dismissCost) {\n  return { type: ACTIONS.DISMISS_TRADER, payload: { cost: { gold: dismissCost }}};\n}\n","const ResourceDefinitions = {\n  gold: {\n    name: 'Gold',\n    baseTradePrice: 1\n  },\n  tool: {\n    name: 'Tool',\n    baseTradePrice: 15\n  },\n  fish: {\n    name: 'Fish',\n    baseTradePrice: 3\n  },\n  wood: {\n    name: 'Wood',\n    baseTradePrice: 1\n  },\n  apple: {\n    name: 'Apple',\n    baseTradePrice: 0.2\n  },\n  cider: {\n    name: 'Cider',\n    baseTradePrice: 3\n  },\n  spice: {\n    name: 'Spice',\n    baseTradePrice: 6\n  },\n  hemp: {\n    name: 'Hemp',\n    baseTradePrice: 4\n  },\n  linen: {\n    name: 'Clothing',\n    baseTradePrice: 27\n  },\n  stone: {\n    name: 'Stone Brick',\n    baseTradePrice: 8\n  },\n  ore: {\n    name: 'Iron Ore',\n    baseTradePrice: 4\n  },\n  charcoal: {\n    name: 'Charcoal',\n    baseTradePrice: 8\n  },\n  iron: {\n    name: 'Iron',\n    baseTradePrice: 16\n  },\n  rope: {\n    name: 'Rope',\n    baseTradePrice: 18\n  },\n  wheat: {\n    name: 'Wheat',\n    baseTradePrice: 1\n  },\n  flour: {\n    name: 'Flour',\n    baseTradePrice: 24\n  },\n  bread: {\n    name: 'Bread',\n    baseTradePrice: 34\n  },\n  weapon: {\n    name: 'Weapons',\n    baseTradePrice: 24\n  },\n  hop: {\n    name: 'Hops',\n    baseTradePrice: 2\n  },\n  ale: {\n    name: 'Ale',\n    baseTradePrice: 14\n  },\n  potash: {\n    name: 'Potash',\n    baseTradePrice: 10\n  },\n  quartz: {\n    name: 'Quartz',\n    baseTradePrice: 4\n  },\n  glass: {\n    name: 'Glass',\n    baseTradePrice: 16\n  },\n  brine: {\n    name: 'Brine',\n    baseTradePrice: 1\n  },\n  salt: {\n    name: 'Salt',\n    baseTradePrice: 4\n  },\n  hide: {\n    name: 'Hide',\n    baseTradePrice: 33\n  },\n  leather: {\n    name: 'Leather',\n    baseTradePrice: 87\n  },\n  paper: {\n    name: 'Paper',\n    baseTradePrice: 12\n  },\n  book: {\n    name: 'Books',\n    baseTradePrice: 30\n  },\n  ink: {\n    name: 'Ink',\n    baseTradePrice: 9\n  }\n};\n\nexport default ResourceDefinitions;\n","import { ACTIONS } from '../actions/warehouse';\nimport { ACTIONS as gameActions } from '../actions/game';\nimport { ACTIONS as constructionActions } from '../actions/construction';\nimport { ACTIONS as housingActions } from '../actions/housing';\nimport { ACTIONS as tradeActions } from '../actions/trade';\nimport BuildingDefinitions from '../data/building-definitions';\nimport Resources from '../data/resource-definitions';\n\nconst resourceDecorations = {\n  reserved: 0,\n  pending: 0\n}\n\nconst initResourceState = {\n  owned: 0,\n  unlocked: false\n}\n\nexport default function(warehouse = {}, action) {\n  const payload = action.payload;\n  switch(action.type) {\n    case gameActions.INIT: {\n      const warehouseCopy = Object.assign({}, warehouse);\n      const resources = {...warehouseCopy.resources};\n\n      // Add each resource and add it to the warehouse if not already added\n      Object.keys(Resources).forEach(resourceId => {\n        if (!resources.hasOwnProperty(resourceId)) {\n          resources[resourceId] = {...initResourceState, id: resourceId};\n        }\n      });\n\n      // go through each resource and add the decorator, because I don't wanna copy and paste it a billion times\n      const newResources = Object.entries(resources).reduce((accumulator, [resourceId, resource]) => {\n        const newResource = Object.assign({}, resource, resourceDecorations);\n        accumulator[resourceId] = newResource;\n        return accumulator;\n      }, resources);\n      warehouseCopy.resources = newResources;\n      return warehouseCopy;\n    }\n    case housingActions.BUILD_HOUSE:\n    case housingActions.ASCEND_HOUSE:\n    case constructionActions.CONSTRUCT_BUILDING: {\n      const warehouseCopy = Object.assign({}, warehouse);\n      let cost = payload.toConstruct.cost;\n      let newResources = deductCost(warehouseCopy.resources, cost);\n      warehouseCopy.resources = newResources;\n      return warehouseCopy;\n    }\n    case ACTIONS.BUILD_WAREHOUSE: {\n      const warehouseCopy = Object.assign({}, warehouse);\n      let cost = payload.toConstruct.cost;\n      let newResources = deductCost(warehouseCopy.resources, cost);\n      warehouseCopy.resources = newResources;\n\n      const warehouseToBuild = BuildingDefinitions[payload.toConstruct.id];\n\n      warehouseCopy.totalCapacity += warehouseToBuild.capacity;\n\n      return warehouseCopy;\n    }\n    case ACTIONS.UPDGRADE_WAREHOUSE: {\n      const warehouseCopy = Object.assign({}, warehouse);\n      const currentWarehouse = BuildingDefinitions[warehouse.type];\n      const nextWarehouse = BuildingDefinitions[currentWarehouse.upgradesTo];\n      if (!nextWarehouse) {\n        return warehouse;\n      }\n\n      const cost = currentWarehouse.upgradeCost;\n      const newResources = deductCost(warehouseCopy.resources, cost);\n      warehouseCopy.resources = newResources;\n\n      warehouseCopy.totalCapacity += nextWarehouse.capacity;\n      warehouseCopy.type = BuildingDefinitions[warehouse.type].upgradesTo;\n\n      return warehouseCopy;\n    }\n    case ACTIONS.UPGRADE_STOREHOUSE: {\n      const warehouseCopy = Object.assign({}, warehouse);\n      const currentWarehouse = BuildingDefinitions[payload.toUpgrade.buildingId];\n      const nextWarehouse = BuildingDefinitions[currentWarehouse.upgradesTo];\n      if (!nextWarehouse) {\n        return warehouse;\n      }\n\n      const cost = currentWarehouse.upgradeCost;\n      const newResources = deductCost(warehouseCopy.resources, cost);\n      warehouseCopy.resources = newResources;\n\n      warehouseCopy.totalCapacity += nextWarehouse.capacity;\n\n      return warehouseCopy;\n    }\n    case tradeActions.DISMISS_TRADER: {\n      const cost = payload.cost;\n      const updatedResources = deductCost(warehouse.resources, cost);\n      return {...warehouse, resources: updatedResources};\n    }\n    case tradeActions.BUY_GOODS: {\n      const good = payload.product;\n      const amount = payload.amount;\n      const atPrice = payload.atPrice;\n\n      const gold = {...warehouse.resources.gold};\n      gold.owned -= amount * atPrice;\n\n      const goodBought = {...warehouse.resources[good]};\n      goodBought.owned += amount;\n\n      const resources = {...warehouse.resources, gold: gold, [good]: goodBought};\n      return {...warehouse, resources: resources};\n    }\n    case tradeActions.SELL_GOODS: {\n      const good = payload.product;\n      const amount = payload.amount;\n      const atPrice = payload.atPrice;\n\n      const gold = {...warehouse.resources.gold};\n      gold.owned += amount * atPrice;\n\n      const goodBought = {...warehouse.resources[good]};\n      goodBought.owned -= amount;\n\n      const resources = {...warehouse.resources, gold: gold, [good]: goodBought};\n      return {...warehouse, resources: resources};\n    }\n    default:\n      return warehouse;\n  }\n}\n\nfunction deductCost(resources, cost) {\n  let resourceCopy = Object.assign({}, resources);\n  for (let [ingredient, amount] of Object.entries(cost)) {\n    let ingredientCopy = Object.assign({}, resourceCopy[ingredient]);\n    ingredientCopy.owned -= amount;\n    resourceCopy[ingredient] = ingredientCopy;\n  }\n  return resourceCopy;\n}\n","import { ACTIONS } from '../actions/construction';\nimport { ACTIONS as housingActions } from '../actions/housing';\nimport { ACTIONS as warehouseActions } from '../actions/warehouse';\n\nexport default function(constructions = {}, action) {\n  let payload = action.payload;\n  switch(action.type) {\n    case warehouseActions.BUILD_WAREHOUSE:\n    case housingActions.BUILD_HOUSE:\n    case ACTIONS.CONSTRUCT_BUILDING:\n      let toConstructId = payload.toConstruct.id;\n      let toConstruct = constructions[toConstructId];\n      let newOwned = Object.assign({}, toConstruct, {owned: toConstruct.owned+1});\n      return Object.assign({}, constructions, {[toConstructId]: newOwned});\n    case ACTIONS.DESTROY_BUILDING:\n      const toDestroyId = payload.toDestroy.buildingId;\n      const toDestroy = {...constructions[toDestroyId]};\n      toDestroy.owned--;\n      return {...constructions, [toDestroyId]: toDestroy};\n    default:\n      return constructions;\n  }\n}\n","export const ACTIONS = {\n  DISABLE_BUILDING: 'DISABLE_BUILDING',\n  ENABLE_BUILDING: 'ENABLE_BUILDING'\n}\n\nexport function disableBuilding(id) {\n  return { type: ACTIONS.DISABLE_BUILDING, payload: { id: id }};\n}\n\nexport function enableBuilding(id) {\n  return { type: ACTIONS.ENABLE_BUILDING, payload: { id: id }};\n}\n","import uuidv4 from 'uuid/v4';\nimport { ACTIONS } from '../actions/building';\nimport { ACTIONS as CONSTRUCTION_ACTIONS } from '../actions/construction';\nimport { ACTIONS as GAME_ACTIONS } from '../actions/game';\nimport { ACTIONS as warehouseActions } from '../actions/warehouse';\nimport BuildingDefinitions, { BUILDING_CATEGORY, buildingStatus } from '../data/building-definitions';\n\nconst initialProducerState = {\n  status: buildingStatus.AWAITING_RESOURCES,\n  progress: 0,\n  efficiency: 1,\n  efficiencyTimer: 0,\n  efficiencySupplied: false,\n  inbox: {},\n  outbox: {}\n}\n\nconst EFFICIENCY_FACTOR = 1 / 100.0;\nconst EFFICIENCY_TIMER = 2;\nconst EFFICIENCY_MINIMUM = 1;\nconst BASE_EFFICIENCY_MAXIMUM = 100;\nexport const BASE_IN_OUT_BOX_CAPACITY = 5;\n\nexport default function(buildings = {}, action) {\n  const payload = action.payload;\n  switch(action.type) {\n    case GAME_ACTIONS.TICK: {\n      if (!buildings.owned) {\n        return buildings;\n      }\n      const newState = Object.assign({}, buildings);\n      const newOwned = Object.assign({}, newState.owned);\n      newState.owned = newOwned;\n\n      const timeIntervalS = payload.tickIntervalSeconds;\n      Object.values(buildings.owned).forEach((building) => {\n        const buildingInfo = BuildingDefinitions[building.buildingId];\n        let updatedBuilding = null;\n        if (buildingInfo.category === BUILDING_CATEGORY.PRODUCER) {\n          updatedBuilding = doProductionTick(building, timeIntervalS);\n        } else {\n          updatedBuilding = building;\n        }\n        newOwned[updatedBuilding.id] = updatedBuilding;\n      });\n      return newState;\n    }\n    case warehouseActions.BUILD_WAREHOUSE:\n    case CONSTRUCTION_ACTIONS.CONSTRUCT_BUILDING:\n      const buildingToBuild = BuildingDefinitions[payload.toConstruct.id];\n      let newBuilding = Object.assign({}, {id: uuidv4(), buildingId: payload.toConstruct.id, enabled: true});\n      if (buildingToBuild.category === BUILDING_CATEGORY.PRODUCER) {\n        newBuilding = Object.assign(newBuilding, initialProducerState);\n        initializeInOutBox(newBuilding);\n      }\n      const newBuildings = Object.assign({}, buildings.owned);\n      newBuildings[newBuilding.id] = newBuilding;\n      return Object.assign({}, buildings, {owned: newBuildings});\n    case warehouseActions.UPGRADE_STOREHOUSE: {\n      const newStorehouse = {...buildings.owned[payload.toUpgrade.id]};\n      newStorehouse.buildingId = BuildingDefinitions[payload.toUpgrade.buildingId].upgradesTo;\n      const owned = {...buildings.owned, [payload.toUpgrade.id]: newStorehouse};\n      return {...buildings, owned: owned};\n    }\n    case CONSTRUCTION_ACTIONS.DESTROY_BUILDING:\n      const buildingToDestroy = payload.toDestroy;\n      const newOwned = {...buildings.owned};\n      delete newOwned[buildingToDestroy.id];\n      return {...buildings, owned: newOwned};\n    case ACTIONS.DISABLE_BUILDING: {\n      const toDisable = payload.id;\n      const disabled = {...buildings.owned[toDisable], enabled: false};\n      const owned = {...buildings.owned, [toDisable]: disabled};\n      return {...buildings, owned: owned};\n    }\n    case ACTIONS.ENABLE_BUILDING: {\n      const toEnable = payload.id;\n      const enabled = {...buildings.owned[toEnable], enabled: true};\n      const owned = {...buildings.owned, [toEnable]: enabled};\n      return {...buildings, owned: owned};\n    }\n    default:\n      return buildings;\n  }\n}\n\nfunction initializeInOutBox(building) {\n  const buildingInfo = BuildingDefinitions[building.buildingId];\n  building.inbox = {};\n  for (let ingredient of Object.keys(buildingInfo.consumes)) {\n    building.inbox[ingredient] = 0;\n  }\n\n  building.outbox = {};\n  for (let good of Object.keys(buildingInfo.produces)) {\n    building.outbox[good] = 0;\n  }\n}\n\nfunction doProductionTick(building, timeIntervalS) {\n  let buildingCopy = Object.assign({}, building);\n  const buildingInfo = BuildingDefinitions[buildingCopy.buildingId];\n\n  if (!building.enabled) {\n    buildingCopy.status = buildingStatus.DISABLED;\n    if (buildingCopy.efficiencySupplied) {\n      buildingCopy.efficiencySupplied = false;\n      buildingCopy.efficiencyTimer = 0;\n    }\n    buildingCopy = progressEfficiency(buildingCopy, timeIntervalS);\n\n    return buildingCopy;\n  }\n\n  if (!canAfford(buildingCopy)) {\n    buildingCopy.status = buildingStatus.AWAITING_RESOURCES;\n    if (buildingCopy.efficiencySupplied) {\n      buildingCopy.efficiencySupplied = false;\n      buildingCopy.efficiencyTimer = 0;\n    }\n    buildingCopy = progressEfficiency(buildingCopy, timeIntervalS);\n\n    return buildingCopy;\n  }\n\n  if (!outboxHasRoom(buildingCopy)) {\n    buildingCopy.status = buildingStatus.OUTBOX_FULL;\n    if (buildingCopy.efficiencySupplied) {\n      buildingCopy.efficiencySupplied = false;\n      buildingCopy.efficiencyTimer = 0;\n    }\n    buildingCopy = progressEfficiency(buildingCopy, timeIntervalS);\n\n    return buildingCopy;\n  }\n\n  buildingCopy.status = buildingStatus.WORKING;\n  if (!buildingCopy.efficiencySupplied) {\n    buildingCopy.efficiencySupplied = true;\n    buildingCopy.efficiencyTimer = 0;\n  }\n  buildingCopy = progressEfficiency(buildingCopy, timeIntervalS);\n\n  buildingCopy.progress += timeIntervalS * buildingCopy.efficiency * EFFICIENCY_FACTOR;\n  if (buildingCopy.progress > buildingInfo.produceTime) {\n    buildingCopy.progress -= buildingInfo.produceTime;\n    let inboxCopy = Object.assign({}, buildingCopy.inbox);\n    let outboxCopy = Object.assign({}, buildingCopy.outbox);\n\n    for (let [ingredient, consumed] of Object.entries(buildingInfo.consumes)) {\n      inboxCopy[ingredient] -= consumed;\n    }\n\n    for (let [good, produced] of Object.entries(buildingInfo.produces)) {\n      outboxCopy[good] += produced;\n    }\n\n    buildingCopy.inbox = inboxCopy;\n    buildingCopy.outbox = outboxCopy;\n  }\n\n  return buildingCopy;\n}\n\nfunction canAfford(building) {\n  const buildingInfo = BuildingDefinitions[building.buildingId];\n  for (let [ingredient, consumed] of Object.entries(buildingInfo.consumes)) {\n    if (building.inbox[ingredient] < consumed) {\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction outboxHasRoom(building) {\n  const buildingInfo = BuildingDefinitions[building.buildingId];\n  for (let [good, produced] of Object.entries(buildingInfo.produces)) {\n    let outboxGood = building.outbox[good];\n    if (outboxGood + produced > BASE_IN_OUT_BOX_CAPACITY) {\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction progressEfficiency(building, timeIntervalS) {\n  building.efficiencyTimer += timeIntervalS;\n  if (building.efficiencyTimer > EFFICIENCY_TIMER) {\n    building.efficiencyTimer -= EFFICIENCY_TIMER;\n    if (building.efficiencySupplied) {\n      // efficiency going up\n      building.efficiency = Math.min(BASE_EFFICIENCY_MAXIMUM, building.efficiency + 1);\n    } else {\n      // efficiency going down\n      building.efficiency = Math.max(EFFICIENCY_MINIMUM, building.efficiency - 1);\n    }\n  }\n  return building;\n}\n","import uuidv4 from 'uuid/v4';\n\nimport { ACTIONS as gameActions } from '../actions/game';\nimport { ACTIONS as warehouseActions } from '../actions/warehouse';\nimport { ACTIONS as constructionActions } from '../actions/construction';\nimport BuildingDefinitions, { BUILDING_CATEGORY } from '../data/building-definitions';\nimport { BASE_IN_OUT_BOX_CAPACITY } from './building';\n\nconst courierState = {\n  IDLE: 'IDLE',\n  PICKING_UP: 'PICKING_UP',\n  EN_ROUTE: 'EN_ROUTE',\n  DROPPING_OFF: 'DROPPING_OFF'\n}\n\nconst BASE_TRAVEL_TIME_SECONDS = 20;\nconst BASE_PICK_UP_DROP_OFF_TIME_SECONDS = 8;\n\nconst initCourier = {\n  status: courierState.IDLE,\n  progress: 0,\n  timeThreshold: 0,\n  jobDescription: {},\n  payload: {},\n  markedForDeath: false\n}\n\nexport default function(state = {}, action) {\n  const payload = action.payload;\n  const couriers = state.couriers;\n  if (!couriers) {\n    return state;\n  }\n  switch(action.type) {\n    case gameActions.INIT:\n      const startingWarehouse = BuildingDefinitions[state.warehouse.type];\n      const courierArrayCopy = couriers.couriers.slice(0);\n      addCouriers(courierArrayCopy, startingWarehouse.couriers);\n      const courierObjCopy = Object.assign({}, couriers);\n      courierObjCopy.couriers = courierArrayCopy;\n      return Object.assign({}, state, {couriers: courierObjCopy});\n    case warehouseActions.UPGRADE_STOREHOUSE: {\n      const thisWarehouse = BuildingDefinitions[payload.toUpgrade.buildingId]\n      const nextWarehouse = BuildingDefinitions[thisWarehouse.upgradesTo];\n      const couriersToAdd = nextWarehouse.couriers - thisWarehouse.couriers;\n      const courierList = [...state.couriers.couriers];\n      addCouriers(courierList, couriersToAdd);\n      const courierState = {...state.couriers, couriers: courierList};\n      return {...state, couriers: courierState};\n    }\n    case warehouseActions.UPDGRADE_WAREHOUSE: {\n      const nextWarehouseId = BuildingDefinitions[payload.toUpgrade].upgradesTo;\n      const nextWarehouse = BuildingDefinitions[nextWarehouseId];\n      const courierList = [...state.couriers.couriers];\n      addCouriers(courierList, nextWarehouse.couriers);\n      const courierState = {...state.couriers, couriers: courierList};\n      return {...state, couriers: courierState};\n    }\n    case warehouseActions.BUILD_WAREHOUSE: {\n      const builtWarehouse = BuildingDefinitions[payload.toConstruct.id];\n      const addedCouriers = builtWarehouse.couriers;\n      const newState = Object.assign({}, state);\n      const newCouriers = Object.assign({}, newState.couriers);\n      newState.couriers = newCouriers;\n      const newArray = newCouriers.couriers.slice(0);\n      addCouriers(newArray, addedCouriers);\n      newCouriers.couriers = newArray;\n      return newState;\n    }\n    case constructionActions.DESTROY_BUILDING: {\n      const toDestroy = BuildingDefinitions[payload.toDestroy.buildingId];\n      if (toDestroy.category !== BUILDING_CATEGORY.WAREHOUSE) {\n        return state;\n      }\n\n      const courierList = [...state.couriers.couriers];\n      const couriers = {...state.couriers, couriers: courierList};\n      const newState = {...state, couriers: couriers};\n\n      const couriersToRemove = toDestroy.couriers;\n      let couriersRemoved = 0;\n\n      // try to find a courier that's idle\n      for (let courierIndex = 0; courierIndex < courierList.length; courierIndex++) {\n        const courier = courierList[courierIndex];\n        if (courier.status === courierState.IDLE && !courier.markmarkedForDeath) {\n          courierList.splice(courierIndex, 1);\n          couriersRemoved++;\n          if (couriersRemoved === couriersToRemove) {\n            return newState;\n          }\n        }\n      }\n\n      // if not, mark the last one for death that isn't already marked\n      for (let courierIndex = courierList.length-1; courierIndex >= 0; courierIndex--) {\n        const courier = courierList[courierIndex];\n        if (!courier.markmarkedForDeath) {\n          courier.markedForDeath = true;\n          couriersRemoved++;\n          if (couriersRemoved === couriersToRemove) {\n            return newState;\n          }\n        }\n      }\n\n      // no idle couriers, and all active ones are already marked for death so...uh...\n      return newState;\n    }\n    case gameActions.TICK: {\n      const stateCopy = Object.assign({}, state);\n      const couriersCopy = Object.assign({}, stateCopy.couriers);\n      const warehouse = Object.assign({}, stateCopy.warehouse);\n      const warehouseMax = warehouse.totalCapacity;\n      const resources = Object.assign({}, warehouse.resources);\n      warehouse.resources = resources;\n      const buildings = Object.assign({}, stateCopy.buildings);\n      const buildingRefCopy = Object.assign({}, buildings.owned);\n      buildings.owned = buildingRefCopy;\n      stateCopy.warehouse = warehouse;\n      stateCopy.buildings = buildings;\n      stateCopy.couriers = couriersCopy;\n\n      // add new jobs\n      const newJobs = findJobs(couriers, warehouse, buildingRefCopy);\n      let jobArrayCopy = couriers.jobQueue.slice(0).concat(newJobs.jobList);\n      const jobRefCopy = Object.assign({}, couriers.jobQueueMap, newJobs.jobRef);\n\n      // if any couriers are available, pick from the top of the queue\n      const courierListCopy = couriersCopy.couriers.map((courier) => {\n        if (courier.status === courierState.IDLE) {\n          const newCourier = Object.assign({}, courier);\n\n          let nextJobIndex = getNextAvailableJob(jobArrayCopy, buildingRefCopy);\n          const nextJob = jobArrayCopy[nextJobIndex];\n          jobArrayCopy = jobArrayCopy.slice(nextJobIndex+1);\n          if (!nextJob) {\n            return courier;\n          }\n\n          const pickupFromId = nextJob.from;\n          const deliverToId = nextJob.to;\n          const good = nextJob.carrying;\n          let pickupFrom = null;\n          let deliverTo = null;\n          let amount = 0;\n\n          if (pickupFromId !== 'warehouse') {\n            pickupFrom = buildings.owned[pickupFromId];\n          } else {\n            pickupFrom = warehouse;\n          }\n\n          if (deliverToId !== 'warehouse') {\n            deliverTo = buildings.owned[deliverToId];\n          } else {\n            deliverTo = warehouse;\n          }\n\n          if (pickupFromId === 'warehouse') {\n            const inboxRoom = BASE_IN_OUT_BOX_CAPACITY - deliverTo.inbox[good];\n            const currentSupply = Math.floor(resources[good].owned - resources[good].reserved);\n            amount = Math.min(inboxRoom, currentSupply);\n            const resourceCopy = Object.assign({}, resources[good]);\n            resourceCopy.reserved += amount;\n            resources[good] = resourceCopy;\n          } else {\n            const currentOutbox = pickupFrom.outbox[good];\n            const warehouseRoom = Math.floor(warehouseMax - resources[good].owned - resources[good].pending);\n            amount = Math.min(currentOutbox, warehouseRoom);\n            const resourceCopy = Object.assign({}, resources[good]);\n            resourceCopy.pending += amount;\n            resources[good] = resourceCopy;\n          }\n\n          nextJob.amount = amount;\n\n          newCourier.status = courierState.PICKING_UP;\n          newCourier.timeThreshold = BASE_PICK_UP_DROP_OFF_TIME_SECONDS;\n          newCourier.jobDescription = nextJob;\n\n          return newCourier;\n        } else {\n          return courier;\n        }\n      });\n\n      couriersCopy.jobQueue = jobArrayCopy;\n      couriersCopy.jobQueueMap = jobRefCopy;\n\n      // work the couriers already on the job (look into merging with the map function up above)\n      courierListCopy.forEach((courier) => {\n        if (courier.status === courierState.IDLE) {\n          return;\n        }\n\n        courier.progress += payload.tickIntervalSeconds;\n        if (courier.progress >= courier.timeThreshold) {\n          courier.progress -= courier.timeThreshold;\n          const jobDescription = courier.jobDescription;\n          const fromId = jobDescription.from;\n          const toId = jobDescription.to;\n          const product = jobDescription.carrying;\n          const amount = jobDescription.amount;\n          let pickupFrom = null;\n          let deliverTo = null;\n\n          if (fromId !== 'warehouse') {\n            if (buildingRefCopy.hasOwnProperty(fromId)) {\n              pickupFrom = Object.assign({}, buildingRefCopy[fromId]);\n              buildingRefCopy[fromId] = pickupFrom;\n            }\n          } else {\n            pickupFrom = warehouse;\n          }\n\n          if (toId !== 'warehouse') {\n            if (buildingRefCopy.hasOwnProperty(toId)) {\n              deliverTo = Object.assign({}, buildingRefCopy[toId]);\n              buildingRefCopy[toId] = deliverTo;\n            }\n          } else {\n            deliverTo = warehouse;\n          }\n\n          switch (courier.status) {\n            case courierState.PICKING_UP: {\n              const payload = Object.assign({}, courier.payload);\n              courier.payload = payload;\n\n              if (fromId === 'warehouse') {\n                const resourceToTake = Object.assign({}, resources[product]);\n                resources[product] = resourceToTake;\n                resourceToTake.owned -= amount;\n                resourceToTake.reserved -= amount;\n                payload[product] = amount;\n              } else {\n                if (!pickupFrom) { // building got deleted...\n                  courier.payload = {};\n                  courier.status = courierState.IDLE;\n                  courier.jobDescription = {};\n                  courier.progress = 0;\n                  courier.timeThreshold = 0;\n\n                  delete jobRefCopy[courier.jobDescription.id];\n                  break;\n                }\n                const outbox = Object.assign({}, pickupFrom.outbox);\n                pickupFrom.outbox = outbox;\n                outbox[product] -= amount;\n                payload[product] = amount;\n                delete jobRefCopy[courier.jobDescription.id];\n              }\n\n              courier.status = courierState.EN_ROUTE;\n              courier.timeThreshold = BASE_TRAVEL_TIME_SECONDS;\n              break;\n            }\n            case courierState.EN_ROUTE:\n              courier.status = courierState.DROPPING_OFF;\n              courier.timeThreshold = BASE_PICK_UP_DROP_OFF_TIME_SECONDS;\n              break;\n            case courierState.DROPPING_OFF: {\n              // drop off goods\n              const payload = Object.assign({}, courier.payload);\n\n              if (toId === 'warehouse') {\n                const resourceToDeliver = Object.assign({}, resources[product]);\n                resources[product] = resourceToDeliver;\n                resourceToDeliver.owned += payload[product];\n                resourceToDeliver.pending -= amount;\n              } else {\n                if (!deliverTo) { // building got deleted...\n                  // return to warehouse\n                  const resourceToDeliver = Object.assign({}, resources[product]);\n                  resources[product] = resourceToDeliver;\n                  resourceToDeliver.owned += payload[product];\n                } else {\n                  const inbox = Object.assign({}, deliverTo.inbox);\n                  deliverTo.inbox = inbox;\n                  inbox[product] += amount;\n                }\n                delete jobRefCopy[courier.jobDescription.id];\n              }\n\n              courier.payload = {};\n              courier.status = courierState.IDLE;\n              courier.jobDescription = {};\n              courier.progress = 0;\n              courier.timeThreshold = 0;\n              break;\n            }\n            default:\n              break;\n          }\n        }\n      });\n\n      // check for any idle couriers marked for death\n      const killedCouriers = courierListCopy.filter((courier) => courier.status !== courierState.IDLE || !courier.markedForDeath);\n\n      couriersCopy.couriers = killedCouriers;\n\n      stateCopy.couriers = couriersCopy;\n      return stateCopy;\n    }\n    default:\n      return state;\n  }\n}\n\nfunction addCouriers(courierArray, numToAdd) {\n  for (let i=0; i<numToAdd; i++) {\n    const newCourier = Object.assign({}, initCourier, {id: uuidv4()});\n    courierArray.push(newCourier);\n  }\n}\n\nconst SUPPLY_SUFFIX = '_SUPPLY';\nconst PICKUP_SUFFIX = '_PICKUP';\nfunction findJobs(courier, warehouse, buildings) {\n  const existingJobs = courier.jobQueueMap;\n  const warehouseMax = warehouse.totalCapacity;\n  const resources = warehouse.resources;\n\n  // check buildings that need input fed\n  const supplies = {\n    jobList: [],\n    jobRef: {}\n  }\n  for (let building of Object.values(buildings)) {\n    const buildingInfo = BuildingDefinitions[building.buildingId];\n    if (buildingInfo.category !== BUILDING_CATEGORY.PRODUCER) {\n      continue;\n    }\n    for (let [ingredient, amount] of Object.entries(building.inbox)) {\n      const supplyKey = building.id + '_' + ingredient + '_' + SUPPLY_SUFFIX;\n      if (amount < BASE_IN_OUT_BOX_CAPACITY && !existingJobs[supplyKey]) {\n        const resource = resources[ingredient];\n        const supplyRemaining = Math.floor(resource.owned - resource.reserved);\n        if (supplyRemaining > 0) {\n          const newJob = {\n            id: supplyKey,\n            from: 'warehouse',\n            to: building.id,\n            carrying: ingredient\n          };\n          supplies.jobList.push(newJob);\n          supplies.jobRef[supplyKey] = newJob;\n        }\n      }\n    }\n  }\n\n  // check buildings that need outbox picked up\n  const pickups = Object.values(buildings).reduce((accumulator, building) => {\n    const buildingInfo = BuildingDefinitions[building.buildingId];\n    if (buildingInfo.category !== BUILDING_CATEGORY.PRODUCER) {\n      return accumulator;\n    }\n    for (let [product, amount] of Object.entries(building.outbox)) {\n      const pickupKey = building.id + PICKUP_SUFFIX;\n      if (amount > 0 && !existingJobs[pickupKey]) {\n        const resource = resources[product];\n        const spaceRemaining = Math.floor(warehouseMax - resource.owned - resource.pending);\n        if (spaceRemaining > 0) {\n          const newJob = {\n            id: pickupKey,\n            from: building.id,\n            to: 'warehouse',\n            carrying: product\n          };\n          accumulator.jobList.push(newJob);\n          accumulator.jobRef[pickupKey] = newJob;\n        }\n      }\n    }\n    return accumulator;\n  }, {jobList: [], jobRef: {}});\n\n  const jobList = supplies.jobList.concat(pickups.jobList);\n  const jobRefs = Object.assign({}, supplies.jobRef, pickups.jobRef);\n  return {jobList: jobList, jobRef: jobRefs}; // TODO, this will need to be changed to include supply jobs\n}\n\n// The way a job is invalid is if one of the buildings has since been destroyed\nfunction getNextAvailableJob(jobArray, buildings) {\n  for (let jobIndex = 0; jobIndex < jobArray.length; jobIndex++) {\n    const nextJob = jobArray[jobIndex];\n\n    const pickupFromId = nextJob.from;\n    const deliverToId = nextJob.to;\n\n    if (pickupFromId !== 'warehouse' && !buildings.hasOwnProperty(pickupFromId)) {\n      continue;\n    }\n\n    if (deliverToId !== 'warehouse' && !buildings.hasOwnProperty(deliverToId)) {\n      continue;\n    }\n\n    return jobIndex;\n  }\n}\n","import { ACTIONS } from '../actions/housing';\nimport BuildingDefinitions from '../data/building-definitions';\n\nconst initHouseState = {\n  popProgress: 0,\n  currentPop: 1\n};\n\nconst ascensionFactors = {\n  peasanthouse: .8,\n  citizenhouse: .6,\n  patrician: .4,\n  noblehouse: 0\n}\n\n// precomputed list of current house and up because I'm lazy\nconst rightsLists = {\n  peasanthouse: ['peasanthouse', 'citizenhouse', 'patricianhouse', 'noblehouse'],\n  citizenhouse: ['citizenhouse', 'patricianhouse', 'noblehouse'],\n  patricianhouse: ['patricianhouse', 'noblehouse'],\n  noblehouse: ['noblehouse']\n}\n\nexport default function(housing = {}, action) {\n  const payload = action.payload;\n  switch (action.type) {\n    case ACTIONS.BUILD_HOUSE: {\n      const newState = Object.assign({}, housing);\n      const types = Object.assign({}, newState.types);\n      const abodes = newState.abodes.slice(0);\n      newState.types = types;\n      newState.abodes = abodes;\n\n      const toBuild = payload.toConstruct.id; // should really just be peasanthouse\n      const type = Object.assign({}, types[toBuild]);\n      types[toBuild] = type;\n      const houseData = BuildingDefinitions[toBuild];\n      const abode = {...initHouseState, houseId: toBuild, populationCap: houseData.populationCap};\n\n      type.owned += 1;\n      abodes.push(abode);\n\n      calculateAscensionRights(types, type, toBuild);\n\n      return newState;\n    }\n    case ACTIONS.ASCEND_HOUSE: {\n      const fromHouseId = payload.fromHouse;\n      const toHouseId = BuildingDefinitions[fromHouseId].ascendsTo;\n\n      const fromType = {...housing.types[fromHouseId]};\n      const toType = {...housing.types[toHouseId]};\n      const types = {...housing.types, [fromHouseId]: fromType, [toHouseId]: toType};\n      const abodes = [...housing.abodes];\n      const newState = {...housing, types: types, abodes: abodes};\n      const nextHouse = BuildingDefinitions[toHouseId];\n\n      // find the first house that's able to be ascended\n      const ascendIndex = abodes.findIndex((house) => house.houseId === fromHouseId);\n      abodes.splice(ascendIndex, 1);\n      abodes.push({...nextHouse, ...initHouseState, houseId: toHouseId});\n      fromType.owned -= 1;\n      toType.owned += 1;\n\n      calculateAscensionRights(types, fromType, fromHouseId);\n      calculateAscensionRights(types, toType, toHouseId);\n\n      return newState;\n    }\n    default:\n      return housing;\n  }\n};\n\nfunction calculateAscensionRights(allTypes, type, toCheck) {\n  const totalHouses = rightsLists[toCheck].reduce((sum, pop) => sum + allTypes[pop].owned, 0);\n  type.totalAscensionRights = Math.floor(ascensionFactors[toCheck] * totalHouses);\n  const ascendTo = BuildingDefinitions[toCheck].ascendsTo;\n  const alreadyAscended = rightsLists[ascendTo].reduce((sum, pop) => sum + allTypes[pop].owned, 0);\n  type.remainingAscensionRights = type.totalAscensionRights - alreadyAscended;\n}\n","import { ACTIONS as housingActions } from '../actions/housing';\nimport { ACTIONS as gameActions } from '../actions/game';\nimport BuildingDefinitions from '../data/building-definitions';\n\nconst POP_ASCENSION_HAPPINESS_THRESHOLD = 97;\n\nconst initValues = {\n  owned: 0,\n  maxPopulation: 0,\n  happiness: 0,\n  canAscend: false,\n  consumeInfo: ''\n}\n\nconst beggarValues = {\n  owned: 0,\n  maxPopulation: 0,\n  happiness: 0,\n  unhoused: 0,\n  beggarTimer: 0\n}\n\nexport default function(populationState = {}, action) {\n  const payload = action.payload;\n  switch (action.type) {\n    case gameActions.INIT: {\n      const newState = Object.assign({}, populationState);\n\n      for (let [popType, pop] of Object.entries(newState)) {\n        if (popType === 'beggar') {\n          newState[popType] = {...beggarValues, ...pop};\n        } else {\n          const newPop = Object.assign({}, pop, initValues);\n          newState[popType] = newPop;\n        }\n      }\n\n      return newState;\n    }\n    case housingActions.BUILD_HOUSE: {\n      const houseBuilt = BuildingDefinitions[payload.toConstruct.id];\n      const newState = Object.assign({}, populationState);\n\n      const modifiedPop = Object.assign({}, newState[houseBuilt.populationCategory]);\n      newState[modifiedPop.id] = modifiedPop;\n\n      modifiedPop.maxPopulation += houseBuilt.populationCap;\n\n      return newState;\n    }\n    case gameActions.TICK: {\n      const population = Object.assign({}, populationState);\n\n      for (let [popType, pop] of Object.entries(population)) {\n        if (pop.happiness > POP_ASCENSION_HAPPINESS_THRESHOLD && pop.owned === pop.maxPopulation) {\n          population[popType] = { ...pop, canAscend: true };\n        } else {\n          population[popType] = { ...pop, canAscend: false}\n        }\n      }\n\n      return population;\n    }\n    case housingActions.ASCEND_HOUSE: {\n      const currentHouse = BuildingDefinitions[payload.fromHouse];\n      const nextHouse = BuildingDefinitions[currentHouse.ascendsTo];\n\n      const oldPop = {...populationState[currentHouse.populationCategory]};\n      const nextPop = {...populationState[nextHouse.populationCategory]};\n\n      oldPop.owned -= currentHouse.populationCap;\n      nextPop.owned += currentHouse.populationCap;\n      oldPop.maxPopulation -= currentHouse.populationCap;\n      nextPop.maxPopulation += nextHouse.populationCap;\n\n      const newState = {...populationState, [currentHouse.populationCategory]: oldPop, [nextHouse.populationCategory]: nextPop};\n\n      // adjust max beggar population\n      const maxBeggars = calculateBeggarCount(newState);\n      newState['beggar'] = {...newState['beggar'], maxPopulation: maxBeggars};\n\n      return newState;\n    }\n    default:\n      return populationState;\n  }\n};\n\nfunction calculateBeggarCount(population) {\n  return Math.floor(population['citizen'].maxPopulation * 0.1 +\n                    population['patrician'].maxPopulation * 0.2 +\n                    population['noble'].maxPopulation * 0.3);\n}\n","// this could probably be done with thunk instead\nimport { ACTIONS } from '../actions/game';\nimport Buildings, { BUILDING_CATEGORY } from '../data/building-definitions';\n\nconst TIME_FACTOR = 1 / 60.0;\n\nexport default function(state = {}, action) {\n  const payload = action.payload;\n  switch (action.type) {\n    case ACTIONS.TICK:\n      const timeIntervalS = payload.tickIntervalSeconds;\n      const newState = Object.assign({}, state);\n      const buildings = state.buildings;\n\n      const amenities = {};\n      for (let building of Object.values(buildings.owned)) {\n        const buildingInfo = Buildings[building.buildingId];\n        if (buildingInfo.category !== BUILDING_CATEGORY.AMENITY) {\n          continue;\n        }\n\n        for (let [amenity, amount] of Object.entries(buildingInfo.produces)) {\n          if (!amenities[amenity]) {\n            amenities[amenity] = 0;\n          }\n\n          amenities[amenity] += amount * timeIntervalS * TIME_FACTOR;\n        }\n      }\n\n      newState.amenities = amenities;\n      return newState;\n    default:\n      return state;\n  }\n}\n","const PopulationDefinitions = {\n  beggar: {\n    name: 'Beggar',\n    taxRate: 0,\n    consumes: {\n      fish: {\n        quantity: .7,\n        weight: 0\n      },\n      cider: {\n        quantity: .3,\n        weight: 0\n      }\n    }\n  },\n  peasant: {\n    name: 'Peasant',\n    taxRate: 0.96,\n    consumes: {\n      community: {\n        quantity: 1,\n        weight: 25\n      },\n      fish: {\n        quantity: 1,\n        weight: 25\n      },\n      cider: {\n        quantity: 0.44,\n        weight: 25\n      },\n      faith: {\n        quantity: 1,\n        weight: 25\n      }\n    }\n  },\n  citizen: {\n    name: 'Citizen',\n    taxRate: 1.14,\n    consumes: {\n      fish: {\n        quantity: .4,\n        weight: 8\n      },\n      spice: {\n        quantity: .4,\n        weight: 12\n      },\n      cider: {\n        quantity: .44,\n        weight: 16\n      },\n      linen: {\n        quantity: 0.42,\n        weight: 16\n      },\n      community: {\n        quantity: 1,\n        weight: 16\n      },\n      faith: {\n        quantity: 1,\n        weight: 16\n      },\n      entertainment: {\n        quantity: 1,\n        weight: 16\n      }\n    }\n  },\n  patrician: {\n    name: 'Patrician',\n    taxRate: 1.26,\n    consumes: {\n      fish: {\n        quantity: .22,\n        weight: 2.8\n      },\n      spice: {\n        quantity: .22,\n        weight: 4.9\n      },\n      bread: {\n        quantity: .55,\n        weight: 6.3\n      },\n      cider: {\n        quantity: .23,\n        weight: 4\n      },\n      ale: {\n        quantity: .24,\n        weight: 9\n      },\n      linen: {\n        quantity: .19,\n        weight: 4.5\n      },\n      leather: {\n        quantity: .28,\n        weight: 8.5\n      },\n      community: {\n        quantity: 1,\n        weight: 12\n      },\n      faith: {\n        quantity: 1,\n        weight: 12\n      },\n      entertainment: {\n        quantity: 1,\n        weight: 12\n      },\n      book: {\n        quantity: .16,\n        weight: 12\n      },\n      security: {\n        quantity: 1,\n        weight: 12\n      }\n    }\n  },\n  noble: {\n    name: 'Noble',\n    taxRate: 1.38,\n    consumes: {}\n  }\n};\n\nexport default PopulationDefinitions;\n","import { ACTIONS } from '../actions/game';\nimport PopulationDefinitions from '../data/population-definitions';\n\nconst TIME_FACTOR = 1 / 60.0;\nconst CONSUME_FACTOR = 1 / 100.0;\nconst MIN_HAPPINESS_DELTA = 0.001;\n\nexport default function(state = {}, action) {\n  const payload = action.payload;\n  switch (action.type) {\n    case ACTIONS.TICK:\n      const timeIntervalS = payload.tickIntervalSeconds;\n      const newState = Object.assign({}, state);\n      const warehouse = Object.assign({}, newState.warehouse);\n      const resources = Object.assign({}, warehouse.resources);\n      warehouse.resources = resources;\n      const amenities = newState.amenities;\n      const population = Object.assign({}, newState.population);\n      newState.warehouse = warehouse;\n      newState.population = population;\n\n      for (const [popType, popOriginal] of Object.entries(state.population)) {\n        const pop = Object.assign({}, popOriginal);\n        pop.consumeInfo = null;\n        let currentHappiness = 0;\n        if (popOriginal.owned !== 0) {\n          for (const [product, consumeInfo] of Object.entries(PopulationDefinitions[popType].consumes)) {\n            const consumed = consumeInfo.quantity * pop.owned * timeIntervalS * TIME_FACTOR * CONSUME_FACTOR;\n            let pctSatisfied = 1;\n\n            if (amenities[product]) {\n              if (amenities[product] < consumed) {\n                pctSatisfied = amenities[product] / consumed;\n                if (!pop.consumeInfo) {\n                  pop.consumeInfo = 'Need ' + product;\n                }\n              }\n              amenities[product] -= consumed;\n              if (amenities[product] < 0) {\n                amenities[product] = 0;\n              }\n            } else if (resources[product]) {\n              const resource = Object.assign({}, resources[product]);\n              resources[product] = resource;\n\n              if (resource.owned < consumed) {\n                pctSatisfied = resource.owned / consumed\n                if (!pop.consumeInfo) {\n                  pop.consumeInfo = 'Need ' + product;\n                }\n              }\n              resource.owned -= consumed;\n              if (resource.owned < 0) {\n                resource.owned = 0;\n              }\n            } else {\n              pctSatisfied = 0;\n              if (!pop.consumeInfo) {\n                pop.consumeInfo = 'Need ' + product;\n              }\n            }\n\n            currentHappiness += consumeInfo.weight * pctSatisfied;\n          }\n        }\n\n        let happinessDiff = (currentHappiness - pop.happiness) / 100.0;\n        if (Math.abs(happinessDiff) < MIN_HAPPINESS_DELTA) {\n          happinessDiff = MIN_HAPPINESS_DELTA;\n        }\n        pop.happiness += happinessDiff;\n        population[popType] = pop;\n      }\n\n      return newState;\n    default:\n      return state;\n  }\n}\n","import rn from 'random-number';\n\nimport { ACTIONS } from '../actions/game';\nimport Buildings from '../data/building-definitions';\n\nconst POP_GROWTH_TIME_SECONDS = 10;\nconst POP_GROWTH_THRESHOLD = 40;\nconst POP_DECLINE_THRESHOLD = 20;\nconst BEGGAR_ARRIVAL_TIMER = 1200; // 20 minutes\nconst BEGGAR_ARRIVAL_MIN = 20;\nconst BEGGAR_ARRIVAL_MAX = 200;\n\nexport default function(state = {}, action) {\n  let payload = action.payload;\n  switch(action.type) {\n    case ACTIONS.TICK:\n      const timeIntervalS = payload.tickIntervalSeconds;\n      const newState = Object.assign({}, state);\n      const houses = Object.assign({}, newState.housing);\n      const population = Object.assign({}, newState.population);\n      newState.housing = houses;\n      newState.population = population;\n\n      const populationCounts = {};\n      // go house by house, increment growth timer\n      const newAbodes = houses.abodes.map((abodeOriginal) => {\n        const abode = Object.assign({}, abodeOriginal);\n        const curHappiness = population[Buildings[abode.houseId].populationCategory].happiness;\n        let growthFactor = 0;\n\n        if (curHappiness >= POP_GROWTH_THRESHOLD && abode.currentPop < abode.populationCap) {\n          growthFactor = 1;\n        }\n        if (curHappiness <= POP_DECLINE_THRESHOLD && abode.currentPop > 0) {\n          growthFactor = -1;\n        }\n\n        abode.popProgress += timeIntervalS * growthFactor;\n        if (abode.popProgress > POP_GROWTH_TIME_SECONDS || abode.popProgress < -POP_GROWTH_TIME_SECONDS) {\n          abode.popProgress -= POP_GROWTH_TIME_SECONDS * growthFactor;\n          abode.currentPop += growthFactor;\n        }\n\n        if (abode.currentPop < 1) {\n          abode.currentPop = 1;\n        }\n\n        const popCategory = Buildings[abode.houseId].populationCategory;\n        if (!populationCounts[popCategory]) {\n          populationCounts[popCategory] = 0;\n        }\n\n        populationCounts[popCategory] += abode.currentPop;\n\n        return abode;\n      });\n      houses.abodes = newAbodes;\n\n      for (let [popType, popCount] of Object.entries(populationCounts)) {\n        const newPop = Object.assign({}, population[popType]);\n        newPop.owned = popCount;\n        population[popType] = newPop;\n      }\n\n      // Increment beggar timer\n      const beggar = {...population['beggar']};\n      if (beggar.owned < beggar.maxPopulation) {\n        beggar.beggarTimer += timeIntervalS;\n        if (beggar.beggarTimer > BEGGAR_ARRIVAL_TIMER) {\n          beggar.beggarTimer -= BEGGAR_ARRIVAL_TIMER;\n          const incomingBeggars = getIncomingBeggars(beggar.maxPopulation - beggar.owned);\n          beggar.owned += incomingBeggars;\n        }\n      }\n      population['beggar'] = beggar;\n\n      return newState;\n    default:\n      return state;\n  }\n}\n\nfunction getIncomingBeggars(beggarDeficit) {\n  const lowerBound = Math.max(beggarDeficit, BEGGAR_ARRIVAL_MIN);\n  const upperBound = Math.min(lowerBound, BEGGAR_ARRIVAL_MAX);\n\n  return rn({min: lowerBound, max: upperBound, integer: true});\n}\n","import { ACTIONS } from '../actions/game';\nimport BuildingDefinitions from '../data/building-definitions';\nimport PopulationDefinitions from '../data/population-definitions';\n\nconst TIME_FACTOR = 1/60.0;\nconst TAX_HAPPINESS_FACTOR = 1 / 100.0;\nconst TAX_HAPPINESS_MINIMUM = 0.01;\n\nexport default function(state = {}, action) {\n  const payload = action.payload;\n  switch (action.type) {\n    case ACTIONS.TICK:\n      const timeIntervalS = payload.tickIntervalSeconds;\n      const newState = Object.assign({}, state);\n      const warehouse = Object.assign({}, newState.warehouse);\n      const resources = Object.assign({}, warehouse.resources);\n      const gold = Object.assign({}, resources.gold);\n      newState.warehouse = warehouse;\n      warehouse.resources = resources;\n      resources.gold = gold;\n\n      const financeInfo = {\n        maintenanceCost: 0,\n        taxRevenue: 0\n      }\n\n      // start with Warehouse maintenance\n      const warehouseMaintenance = BuildingDefinitions[warehouse.type].upkeep * timeIntervalS * TIME_FACTOR;\n      const totalMaintenance = Object.values(state.buildings.owned).reduce((sum, building) => {\n        let upkeep = building.enabled ?\n          BuildingDefinitions[building.buildingId].upkeep :\n          BuildingDefinitions[building.buildingId].disabledUpkeep;\n        return sum + (upkeep * timeIntervalS * TIME_FACTOR);\n      }, warehouseMaintenance);\n\n      const totalTaxes = Object.values(state.population).reduce((sum, population) => {\n        let happinessFactor = population.happiness * TAX_HAPPINESS_FACTOR;\n        if (happinessFactor < TAX_HAPPINESS_MINIMUM) {\n          happinessFactor = TAX_HAPPINESS_MINIMUM;\n        }\n        return sum + (PopulationDefinitions[population.id].taxRate * population.owned * timeIntervalS * TIME_FACTOR * happinessFactor);\n      }, 0);\n\n      financeInfo.maintenanceCost = totalMaintenance;\n      financeInfo.taxRevenue = totalTaxes;\n      newState.financeInfo = financeInfo;\n\n      gold.owned = gold.owned + totalTaxes - totalMaintenance;\n\n      return newState;\n    default:\n      return state;\n  }\n}\n","export const unlockThresholds = [\n  ['peasant', 60],\n  ['peasant', 90],\n  ['citizen', 1],\n  ['citizen', 240],\n  ['citizen', 355],\n  ['patrician', 1],\n  ['patrician', 510],\n  ['patrician', 690],\n  ['patrician', 940],\n  ['patrician', 1190],\n  ['noble', 950],\n  ['noble', 2200],\n  ['noble', 3500],\n  ['noble', 7500]\n];\n\nexport const unlocks = [\n  // initial state\n  {\n    title: 'Small Settlement',\n    buildings: ['marketplace', 'fishinghut', 'lumberjackhut'],\n    population: 'peasant',\n    resources: ['gold', 'wood', 'tool', 'fish']\n  },\n  // 60 peasants\n  {\n    buildings: ['orchard', 'ciderfarm'],\n    resources: ['apple', 'cider']\n  },\n  // 90 peasants\n  {\n    title: 'Settlement',\n    buildings: ['chapel']\n  },\n  // 1 citizen\n  {\n    population: 'citizen',\n    resources: ['hemp', 'linen', 'stone', 'spice'],\n    buildings: ['hempfarm', 'weavers', 'stonemason'],\n    housing: ['citizenhouse']\n  },\n  // 240 citizen\n  {\n    resources: ['ore', 'charcoal', 'iron', 'rope'],\n    buildings: ['oremine', 'charcoalhut', 'smelter', 'toolmaker', 'ropeyard', 'smallshipyard']\n  },\n  // 355 citizen\n  {\n    title: 'Village',\n    buildings: ['smallstorehouse', 'repaircrane', 'tavern', 'alms']\n  },\n  // 1 patrician\n  {\n    population: 'patrician',\n    resources: ['wheat', 'flour', 'bread', 'weapon'],\n    buildings: ['wheatfield', 'mill', 'bakery', 'weaponsmith', 'largeshipyard'],\n    housing: ['patricianhouse']\n  },\n  // 510 patrician\n  {\n    title: 'Small Town',\n    resources: ['hop', 'ale', 'potash', 'quartz', 'glass'],\n    buildings: ['hopsfield', 'brewery', 'potashpit', 'glasssmelter', 'church']\n  },\n  // 690 patrician\n  {\n    resources: ['brine', 'salt', 'hide', 'leather'],\n    buildings: ['saltmine', 'saltworks', 'pigfarm', 'tannery']\n  },\n  // 940 patrician\n  {\n    resources: ['paper', 'book', 'ink'],\n    buildings: ['papermill', 'printingpress']\n  },\n  // 1190 patrician\n  {\n    title: 'City',\n    buildings: ['prison']\n  },\n  // 950 noble\n  {\n    title: 'Major City'\n  },\n  // 2200 noble\n  {\n    title: 'Commercial Center'\n  },\n  // 3500 noble\n  {\n    title: 'Metropolis'\n  },\n  // 7500 noble\n  {\n    title: 'Cosmopolitan City'\n  }\n];\n","import { ACTIONS } from '../actions/game';\nimport { unlockThresholds, unlocks } from '../data/level-up-definitions'\n\nexport default function(state = {}, action) {\n  switch (action.type) {\n    case ACTIONS.TICK: {\n      const [unlockPopType, popRequired] = unlockThresholds[state.island.level - 1];\n      const currentPop = state.population[unlockPopType].owned;\n      if (currentPop >= popRequired) {\n        const newState = Object.assign({}, state);\n        const island = Object.assign({}, newState.island);\n        newState.island = island;\n        island.level++;\n\n        const unlocked = unlocks[island.level - 1];\n        if (unlocked.title) {\n          island.title = unlocked.title;\n        }\n        if (unlocked.buildings) {\n          const constructions = Object.assign({}, newState.construction);\n          newState.construction = constructions;\n          unlocked.buildings.forEach(conId => {\n            const construction = Object.assign({}, constructions[conId]);\n            construction.unlocked = true;\n            constructions[conId] = construction;\n          });\n        }\n        if (unlocked.resources) {\n          const warehouse = Object.assign({}, newState.warehouse);\n          const resources = Object.assign({}, warehouse.resources);\n          newState.warehouse = warehouse;\n          warehouse.resources = resources;\n          unlocked.resources.forEach(resId => {\n            const resource = Object.assign({}, resources[resId]);\n            resources[resId] = resource;\n            resource.unlocked = true;\n          });\n        }\n        if (unlocked.population) {\n          const population = Object.assign({}, newState.population);\n          newState.population = population;\n          const popUnlocked = Object.assign({}, population[unlocked.population]);\n          popUnlocked.unlocked = true;\n          population[unlocked.population] = popUnlocked;\n        }\n        if (unlocked.housing) {\n          const types = {...newState.housing.types}\n          const housing = {...newState.housing, types: types};\n          newState.housing = housing;\n          unlocked.housing.forEach(houseId => {\n            const unlockedHouse = {...types[houseId], unlocked: true};\n            types[houseId] = unlockedHouse;\n          });\n        }\n\n        return newState;\n      }\n      return state;\n    }\n    default:\n      return state;\n  }\n}\n","export const ACTIONS = {\n  SET_TIME_FACTOR: 'SET_TIME_FACTOR'\n}\n\nexport function setTimeFactor(timeFactor) {\n  return { type: ACTIONS.SET_TIME_FACTOR, payload: { timeFactor: timeFactor }};\n}\n","import { ACTIONS } from '../actions/cheats';\n\nexport default function(state = {}, action) {\n  const payload = action.payload;\n  switch (action.type) {\n    case ACTIONS.SET_TIME_FACTOR:\n      return {\n        ...state,\n        cheat: {\n          timeFactor: payload.timeFactor\n        }\n      }\n    default:\n      return state;\n  }\n}\n","const Traders = {\n  lord: {\n    name: 'Lord Farquaad',\n    rates: {\n      wood: {\n        buy: .5,\n        sell: 1.2\n      },\n      tool: {\n        buy: .5,\n        sell: 1.2\n      },\n      stone: {\n        buy: .5,\n        sell: 1.2\n      },\n      spice: {\n        buy: 1,\n        sell: 0\n      }\n    },\n    baseCapacity: 30\n  },\n  prince: {\n    name: 'Prince Ali',\n    rates: {\n      wood: {\n        buy: 1,\n        sell: 1\n      },\n      tool: {\n        buy: 1,\n        sell: 1.2\n      },\n      spice: {\n        buy: 0,\n        sell: 1.25\n      }\n    },\n    baseCapacity: 40\n  }\n};\n\nexport default Traders;\n","import { ACTIONS as gameActions } from '../actions/game';\nimport { ACTIONS } from '../actions/trade';\nimport Traders from '../data/trader-info';\nimport ResourceDefinitions from '../data/resource-definitions';\n\nconst BASE_TRADER_STAY_TIME_SECONDS = 360;\nconst BASE_TRADER_VACANCY_TIME_SECONDS = 180;\nconst BASE_DISMISS_COST = 100;\n\nconst INIT_STATE = {\n  traderId: 0,\n  timer: 0,\n  timeToLeave: BASE_TRADER_STAY_TIME_SECONDS,\n  wares: {},\n  newGame: true,\n  dismissCost: BASE_DISMISS_COST\n};\n\nexport default function(trader=INIT_STATE, action) {\n  const payload = action.payload;\n  switch (action.type) {\n    case ACTIONS.BUY_GOODS: {\n      const toBuy = payload.product;\n      const amount = payload.amount;\n      const wares = {...trader.wares};\n      const newState = {...trader, wares: wares};\n\n      wares[toBuy].held -= amount;\n\n      return newState;\n    }\n    case ACTIONS.SELL_GOODS: {\n      const toBuy = payload.product;\n      const amount = payload.amount;\n      const wares = {...trader.wares};\n      const newState = {...trader, wares: wares};\n\n      wares[toBuy].held += amount;\n\n      return newState;\n    }\n    case gameActions.TICK:\n      const timeIntervalS = payload.tickIntervalSeconds;\n      const newState = {...trader};\n      newState.timer += timeIntervalS;\n      if (newState.timer > newState.timeToLeave) {\n        newState.timer -= newState.timeToLeave;\n        return newTrader(newState);\n      }\n      return newState;\n    case ACTIONS.DISMISS_TRADER: {\n      const newState = newTrader(trader);\n      return newState;\n    }\n    default:\n      return trader;\n  }\n};\n\nfunction newTrader(currentState) {\n  if (currentState.traderId !== 0) {\n    const newState = {...currentState};\n    newState.traderId = 0;\n    newState.wares = {};\n    newState.time = 0;\n    newState.timeToLeave = BASE_TRADER_VACANCY_TIME_SECONDS;\n\n    return newState;\n  }\n\n  const traders = Object.keys(Traders);\n  let selectedTrader = traders[Math.floor(Math.random() * traders.length)];\n  if (currentState.newGame) {\n    currentState.newGame = false;\n    selectedTrader = 'lord';\n  }\n  const traderInfo = Traders[selectedTrader];\n  const wares = {};\n  const maxCapacity = traderInfo.baseCapacity;\n  const timeToLeave = BASE_TRADER_STAY_TIME_SECONDS;\n  const newState = {\n    ...currentState,\n    traderId: selectedTrader,\n    wares: wares,\n    maxCapacity: maxCapacity,\n    timeToLeave: timeToLeave\n  };\n\n  for (let [good, rates] of Object.entries(traderInfo.rates)) {\n    const goodBasePrice = ResourceDefinitions[good].baseTradePrice;\n    const buyPrice = rates.buy * goodBasePrice;\n    const sellPrice = rates.sell * goodBasePrice;\n\n    wares[good] = {\n      buyPrice: buyPrice,\n      sellPrice: sellPrice,\n      held: 0\n    }\n    if (sellPrice > 0) {\n      wares[good].held = Math.floor(maxCapacity * 0.75);\n    }\n  }\n\n  return newState;\n}\n","const ships = {\n  flagship: {\n    typeName: 'Flagship',\n    cargoSlots: 4,\n    speed: 1,\n    loadFactor: 0.2,\n    hp: 600,\n    attack: 6,\n    maintenance: 0,\n    cost: {\n      gold: 3500\n    }\n  },\n  smalltrader: {\n    typeName: 'Small Trading Ship',\n    cargoSlots: 3,\n    speed: 0.86,\n    loadFactor: 0.15,\n    hp: 400,\n    attack: 0,\n    maintenance: 15,\n    points: 1,\n    cost: {\n      gold: 1500,\n      wood: 15,\n      rope: 20\n    }\n  },\n  smallwarship: {\n    typeName: 'Small Warship',\n    cargoSlots: 1,\n    speed: 1.07,\n    loadFactor: 0.30,\n    hp: 500,\n    attack: 6,\n    maintenance: 30,\n    points: 1,\n    cost: {\n      gold: 2000,\n      wood: 30,\n      rope: 30,\n      weapon: 20\n    }\n  },\n  largetrader: {\n    typeName: 'Large Trading Vessel',\n    cargoSlots: 6,\n    speed: 0.97,\n    loadFactor: 0.1,\n    hp: 1000,\n    attack: 0,\n    maintenance: 50,\n    points: 2,\n    cost: {\n      gold: 4000,\n      wood: 60,\n      rope: 60\n    }\n  },\n  largewarship: {\n    typeName: 'Large Warship',\n    cargoSlots: 2,\n    speed: 0.97,\n    loadFactor: 0.25,\n    hp: 1200,\n    attack: 14,\n    maintenance: 60,\n    points: 2,\n    cost: {\n      gold: 4500,\n      wood: 70,\n      rope: 70,\n      cannon: 20\n    }\n  },\n\n  // bad guys\n  corsair: {\n    typeName: 'Pirate Corsair',\n    speed: 0.86,\n    hp: 500,\n    attack: 7,\n    points: 1\n  },\n  smallpiratewarship: {\n    typeName: 'Small Pirate Warship',\n    speed: 0.97,\n    hp: 800,\n    attack: 8,\n    points: 2\n  },\n  largepiratewarship: {\n    typeName: 'Large Pirate Warship',\n    speed: 1.07,\n    hp: 1000,\n    attack: 10,\n    points: 3\n  }\n}\n\nexport default ships;\n","import uuidv4 from 'uuid/v4';\nimport { ACTIONS as gameActions } from '../actions/game';\nimport { ACTIONS as actions } from '../actions/navy';\nimport Boats from '../data/ship-definitions';\n\nconst boatTemplate = {\n  cargo: {}\n}\n\nconst fleetTemplate = {\n  currentLocation: 'home',\n  currentDestination: null,\n  ships: []\n}\n\nexport default function(navy = {}, action) {\n  const payload = action.payload;\n  switch (action.type) {\n    case gameActions.INIT: {\n      const flagship = {\n        ...boatTemplate,\n        id: uuidv4(),\n        typeName: 'flagship',\n        currentHp: Boats['flagship'].hp,\n        name: 'Flagship'\n      }\n      const ships = {\n        [flagship.id]: flagship\n      };\n      const fleets = {\n        [uuidv4()]: {\n          ...fleetTemplate,\n          name: 'Fleet 1',\n          ships: [flagship.id]\n        }\n      };\n      const dockBuildings = {};\n      return {\n        ships: ships,\n        fleets: fleets,\n        dockBuildings: dockBuildings\n      };\n    }\n  }\n  return navy;\n}\n","const INITIAL_STATE = {\n  island: {\n    level: 1,\n    title: 'Small Settlement',\n    name: 'Townsville'\n  },\n  construction: {\n    peasanthouse: {\n      id: 'peasanthouse',\n      owned: 0,\n      cost: {\n        wood: 2\n      },\n      unlocked: true\n    },\n    marketplace: {\n      id: 'marketplace',\n      owned: 0,\n      cost: {\n        gold: 400,\n        wood: 5,\n        tool: 3\n      },\n      unlocked: true\n    },\n    fishinghut: {\n      id: 'fishinghut',\n      owned: 0,\n      cost: {\n        gold: 100,\n        wood: 3,\n        tool: 2\n      },\n      unlocked: true\n    },\n    lumberjackhut: {\n      id: 'lumberjackhut',\n      owned: 0,\n      cost: {\n        gold: 50,\n        tool: 2\n      },\n      unlocked: true\n    },\n    smallstockpile: {\n      id: 'smallstockpile',\n      owned: 0,\n      cost: {\n        gold: 200,\n        wood: 2,\n        tool: 3\n      },\n      unlocked: true\n    },\n    orchard: {\n      id: 'orchard',\n      owned: 0,\n      cost: {\n        gold: 25\n      },\n      unlocked: false\n    },\n    ciderfarm: {\n      id: 'ciderfarm',\n      owned: 0,\n      cost: {\n        gold: 100,\n        wood: 5,\n        tool: 1\n      },\n      unlocked: false\n    },\n    chapel: {\n      id: 'chapel',\n      owned: 0,\n      cost: {\n        gold: 800,\n        wood: 12,\n        tool: 5\n      },\n      unlocked: false\n    },\n    hempfarm: {\n      id: 'hempfarm',\n      owned: 0,\n      cost: {\n        gold: 400,\n        wood: 5,\n        tool: 2\n      },\n      unlocked: false\n    },\n    weavers: {\n      id: 'weavers',\n      owned: 0,\n      cost: {\n        gold: 400,\n        wood: 5,\n        tool: 3\n      }\n    },\n    stonemason: {\n      id: 'stonemason',\n      owned: 0,\n      cost: {\n        gold: 400,\n        wood: 2,\n        tool: 2\n      }\n    },\n    oremine: {\n      id: 'oremine',\n      owned: 0,\n      cost: {\n        gold: 900,\n        wood: 12,\n        tool: 2,\n        stone: 2\n      }\n    },\n    charcoalhut: {\n      id: 'charcoalhut',\n      owned: 0,\n      cost: {\n        gold: 250,\n        wood: 3,\n        tool: 2,\n        stone: 2\n      }\n    },\n    smelter: {\n      id: 'smelter',\n      owned: 0,\n      cost: {\n        gold: 600,\n        wood: 10,\n        tool: 5,\n        stone: 2\n      }\n    },\n    toolmaker: {\n      id: 'toolmaker',\n      owned: 0,\n      cost: {\n        gold: 500,\n        wood: 8,\n        tool: 5,\n        stone: 2\n      }\n    },\n    ropeyard: {\n      id: 'ropeyard',\n      owned: 0,\n      cost: {\n        gold: 700,\n        wood: 12,\n        tool: 5\n      }\n    },\n    smallshipyard: {\n      id: 'smallshipyard',\n      owned: 0,\n      cost: {\n        gold: 680,\n        wood: 10,\n        tool: 5,\n        stone: 4\n      }\n    },\n    smallstorehouse: {\n      id: 'smallstorehouse',\n      owned: 0,\n      cost: {\n        gold: 1020,\n        wood: 4,\n        tool: 4,\n        stone: 1\n      }\n    },\n    repaircrane: {\n      id: 'repaircrane',\n      owned: 0,\n      cost: {\n        gold: 1020,\n        wood: 5,\n        tool: 5,\n        stone: 9\n      }\n    },\n    // defensetower: {\n    //   id: 'defensetower',\n    //   owned: 0,\n    //   cost: {\n    //     gold: 1520,\n    //     wood: 2,\n    //     tool: 8,\n    //     stone: 12\n    //   }\n    // },\n    // carpenter: {\n    //   id: 'carpenter',\n    //   owned: 0,\n    //   cost: {\n    //     gold: 200,\n    //     wood: 5,\n    //     tool: 5\n    //   }\n    // },\n    // firestation: {\n    //   id: 'firestation',\n    //   owned: 0,\n    //   cost: {\n    //     gold: 1000,\n    //     wood: 5,\n    //     tool: 5,\n    //     stone: 10\n    //   }\n    // },\n    tavern: {\n      id: 'tavern',\n      owned: 0,\n      cost: {\n        gold: 1000,\n        tool: 5,\n        stone: 10\n      }\n    },\n    alms: {\n      id: 'alms',\n      owned: 0,\n      cost: {\n        gold: 200,\n        wood: 5,\n        tool: 5\n      }\n    },\n    wheatfield: {\n      id: 'wheatfield',\n      owned: 0,\n      cost: {\n        gold: 200,\n        wood: 3,\n        tool: 2\n      }\n    },\n    mill: {\n      id: 'mill',\n      owned: 0,\n      cost: {\n        gold: 800,\n        wood: 8,\n        tool: 4,\n        stone: 4\n      }\n    },\n    bakery: {\n      id: 'bakery',\n      owned: 0,\n      cost: {\n        gold: 700,\n        wood: 5,\n        tool: 5,\n        stone: 5\n      }\n    },\n    weaponsmith: {\n      id: 'weaponsmith',\n      owned: 0,\n      cost: {\n        gold: 1500,\n        wood: 3,\n        tool: 5,\n        stone: 10\n      }\n    },\n    largeshipyard: {\n      id: 'largeshipyard',\n      owned: 0,\n      cost: {\n        gold: 2120,\n        wood: 20,\n        tool: 25,\n        stone: 46\n      }\n    },\n    hopsfield: {\n      id: 'hopsfield',\n      owned: 0,\n      cost: {\n        gold: 200,\n        wood: 5,\n        tool: 2,\n        stone: 4\n      }\n    },\n    brewery: {\n      id: 'brewery',\n      owned: 0,\n      cost: {\n        gold: 600,\n        wood: 5,\n        tool: 4,\n        stone: 6\n      }\n    },\n    potashpit: {\n      id: 'potashpit',\n      owned: 0,\n      cost: {\n        gold: 500,\n        wood: 6,\n        tool: 4,\n        stone: 8\n      }\n    },\n    glasssmelter: {\n      id: 'glasssmelter',\n      owned: 0,\n      cost: {\n        gold: 1200,\n        wood: 10,\n        tool: 5,\n        stone: 12\n      }\n    },\n    church: {\n      id: 'church',\n      owned: 0,\n      cost: {\n        gold: 5000,\n        wood: 30,\n        tool: 10,\n        stone: 40,\n        glass: 25\n      }\n    },\n    saltmine: {\n      id: 'saltmine',\n      owned: 0,\n      cost: {\n        gold: 800,\n        wood: 11,\n        tool: 4,\n        stone: 5\n      }\n    },\n    saltworks: {\n      id: 'saltworks',\n      owned: 0,\n      cost: {\n        gold: 900,\n        wood: 3,\n        tool: 5,\n        stone: 6\n      }\n    },\n    pigfarm: {\n      id: 'pigfarm',\n      owned: 0,\n      cost: {\n        gold: 400,\n        wood: 4,\n        tool: 4,\n        stone: 3\n      }\n    },\n    tannery: {\n      id: 'tannery',\n      owned: 0,\n      cost: {\n        gold: 700,\n        wood: 7,\n        tool: 3,\n        stone: 8\n      }\n    },\n    papermill: {\n      id: 'papermill',\n      owned: 0,\n      cost: {\n        gold: 1500,\n        wood: 5,\n        tool: 5,\n        stone: 12\n      }\n    },\n    printingpress: {\n      id: 'printingpress',\n      owned: 0,\n      cost: {\n        gold: 1800,\n        wood: 5,\n        tool: 5,\n        stone: 12,\n        glass: 10\n      }\n    },\n    prison: {\n      id: 'prison',\n      owned: 0,\n      cost: {\n        gold: 7000,\n        wood: 20,\n        tool: 30,\n        stone: 60,\n        glass: 24\n      }\n    }\n\n  },\n  buildings: {\n    owned: {}\n  },\n  warehouse: {\n    type: 'smallwarehouse',\n    totalCapacity: 40,\n    resources: {\n      gold: {\n        id: 'gold',\n        owned: 5000,\n        unlocked: true\n      },\n      tool: {\n        id: 'tool',\n        owned: 40,\n        unlocked: true\n      },\n      fish: {\n        id: 'fish',\n        owned: 2,\n        unlocked: true\n      },\n      wood: {\n        id: 'wood',\n        owned: 40,\n        unlocked: true\n      }\n    },\n  },\n  couriers: {\n    couriers:[],\n    jobQueue: [],\n    jobQueueMap: {}\n  },\n  housing: {\n    types: {\n      peasanthouse: {\n        owned: 0,\n        totalAscensionRights: 0,\n        remainingAscensionRights: 0,\n        unlocked: true,\n      },\n      citizenhouse: {\n        owned: 0,\n        totalAscensionRights: 0,\n        remainingAscensionRights: 0,\n        unlocked: false,\n      },\n      patricianhouse: {\n        owned: 0,\n        totalAscensionRights: 0,\n        remainingAscensionRights: 0,\n        unlocked: false,\n      },\n      noblehouse: {\n        owned: 0,\n        totalAscensionRights: 0,\n        remainingAscensionRights: 0,\n        unlocked: false,\n      }\n    },\n    abodes: []\n  },\n  population: {\n    beggar: {\n      id: 'beggar',\n      unlocked: true\n    },\n    peasant: {\n      id: 'peasant',\n      unlocked: true\n    },\n    citizen: {\n      id: 'citizen',\n      unlocked: false\n    },\n    patrician: {\n      id: 'patrician',\n      unlocked: false\n    },\n    noble: {\n      id: 'noble',\n      unlocked: false\n    }\n  }\n};\n\nexport default INITIAL_STATE;\n","import { ACTIONS } from '../actions/game';\nimport { combineReducers } from 'redux';\nimport island from './island';\nimport warehouse from './warehouse';\nimport construction from './construction';\nimport buildings from './building';\nimport couriers from './couriers';\nimport housing from './housing';\nimport population from './population';\nimport amenity from './amenities';\nimport consume from './consume';\nimport growth from './growth';\nimport finance from './finance';\nimport levelUp from './level-up';\nimport cheat from './cheat';\nimport trader from './trader';\nimport navy from './navy';\nimport INITIAL_STATE from '../store/initial-state';\n\nconst combinedReducer = combineReducers({\n  cheat: (state = {}) => { return state },\n  island: island,\n  warehouse: warehouse,\n  construction: construction,\n  buildings: buildings,\n  couriers: (state = {}) => { return state }, // no op\n  housing: housing,\n  population: population,\n  trader: trader,\n  navy: navy\n});\n\nfunction rootReducer(state, action) {\n  if (action.type === ACTIONS.SAVE_GAME) {\n    localStorage.setItem('save', btoa(JSON.stringify(state)));\n    return state;\n  }\n  if (action.type === ACTIONS.RESET_SAVE) {\n    let initState = INITIAL_STATE;\n    initState = rootReducer(initState, { type: ACTIONS.INIT }); // probably smelly\n    return initState;\n  }\n\n  if (action.type === ACTIONS.LOAD_GAME) {\n    return action.payload.saveState;\n  }\n  if (action.type === ACTIONS.TICK) {\n    let timeFactor = state.cheat.timeFactor;\n    if (!timeFactor) {\n      timeFactor = 1;\n    }\n    action.payload.tickIntervalSeconds *= timeFactor;\n  }\n  const cheatState = cheat(state, action);\n  const intermediateState = combinedReducer(cheatState, action);\n  const courierState = couriers(intermediateState, action);\n  const amenityState = amenity(courierState, action);\n  const consumptionState = consume(amenityState, action);\n  const growthState = growth(consumptionState, action);\n  const financeState = finance(growthState, action);\n  const levelUpState = levelUp(financeState, action);\n  return levelUpState;\n}\n\nexport default rootReducer;\n","export default class Scheduler {\n  constructor(functionToRun, targetInterval) {\n    this.targetFunction = functionToRun;\n    this.targetInterval = targetInterval;\n    this.running = false;\n  }\n\n  start() {\n    if (this.running) {\n      return;\n    }\n    let lastTick = Date.now();\n    this.running = true;\n    let repeater = () => {\n      if (!this.running) {\n          return;\n      }\n      let currentTime = Date.now();\n      let elapsedTime = currentTime - lastTick;\n      this.targetFunction(elapsedTime);\n      lastTick = currentTime;\n      setTimeout(repeater.bind(this), this.targetInterval);\n    }\n    setTimeout(repeater.bind(this), this.targetInterval);\n  }\n\n  stop() {\n    this.running = false;\n  }\n}\n","import React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { changeName } from '../actions/game';\n\nconst IslandNameView = () => {\n  const name = useSelector(state => state.island.name);\n  const title = useSelector(state => state.island.title);\n  const dispatch = useDispatch();\n\n  const changeFn = () => {\n    const toName = prompt('Enter name');\n    if (toName) {\n      dispatch(changeName(toName.substring(0, 100)));\n    }\n  }\n\n  return (\n    <div className='title'>\n      <h4>The {title} of {name}</h4>\n      <button onClick={changeFn}>Change Name</button>\n    </div>\n  )\n};\n\nexport default IslandNameView;\n","import React, { useState } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { setTimeFactor } from '../../actions/cheats';\n\nconst TimeFactor = () => {\n  const dispatch = useDispatch();\n  const [timeFactor, setTf] = useState(1);\n\n  const handleSubmit = (event) => {\n    dispatch(setTimeFactor(timeFactor));\n    event.preventDefault();\n  }\n\n  return (\n    <div className='time-factor'>\n      <form onSubmit={handleSubmit}>\n        <input type='number' name='timeFactor' onChange={e => setTf(e.target.value)} required></input>\n        <input type='submit' value='Set time factor' />\n      </form>\n    </div>\n  )\n};\n\nexport default TimeFactor;\n","export const filterUnlocked = (collectionObject) => {\n  return Object.entries(collectionObject).reduce((accumulator, [key, value]) => {\n    if (value.unlocked) {\n      accumulator[key] = value;\n    }\n    return accumulator;\n  }, {});\n};\n\nexport const setAffordable = (buyable, resources, costProperty = 'cost') => {\n  for (let [resource, amount] of Object.entries(buyable[costProperty])) {\n    if (!resources[resource]) {\n      // thing costs a resource the player hasn't unlocked\n      return {...buyable, canAfford: false};\n    } else if (resources[resource].owned < amount) {\n      return Object.assign({}, buyable, {canAfford: false});\n    }\n  }\n  return Object.assign({}, buyable, {canAfford: true});\n};\n\nexport const setAllAffordable = (buyableCollection, resources) => {\n  return Object.entries(buyableCollection).reduce((accumulator, [buyableId, buyable]) => {\n    accumulator[buyableId] = setAffordable(buyable, resources);\n    return accumulator;\n  }, {});\n};\n","import React from 'react';\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\nimport Popover from 'react-bootstrap/Popover';\n\nimport ResourceDefinitions from '../data/resource-definitions';\n\nconst PriceTooltip = (props) => {\n  const cost = props.cost;\n\n  const ingredientsList = Object.entries(cost).map(([ingredient, quantity]) => (\n    <div className='construction-ingredient' key={ingredient}>{ResourceDefinitions[ingredient].name}: {quantity}</div>\n  ));\n\n  const headerText = props.header ? props.header : 'Cost';\n  const popover =\n  <Popover id='Price'>\n    <Popover.Title as='h3'>{headerText}</Popover.Title>\n    <Popover.Content>{ingredientsList}</Popover.Content>\n  </Popover>;\n\n  return (\n    <OverlayTrigger\n      placement='top'\n      delay={{ show: 500, hide: 250 }}\n      overlay={popover}\n      >\n      {props.children}\n    </OverlayTrigger>\n  )\n}\n\nexport default PriceTooltip;\n","import React from 'react';\nimport { useSelector, useDispatch, shallowEqual } from 'react-redux';\nimport { upgradeWarehouse } from '../actions/warehouse';\nimport { filterUnlocked, setAffordable } from '../selectors';\nimport Buildings from '../data/building-definitions';\nimport ResourceDefinitions from '../data/resource-definitions';\nimport Button from 'react-bootstrap/Button';\nimport PriceTooltip from './PriceTooltip';\n\nimport '../../style/resource.css';\n\nconst ResourcePanel = () => {\n  const warehouseType = useSelector(state => state.warehouse.type);\n  const resources = useSelector(state => filterUnlocked(state.warehouse.resources), shallowEqual);\n  const max = useSelector(state => state.warehouse.totalCapacity);\n  const warehouseInfo = Buildings[warehouseType];\n  const dispatch = useDispatch();\n\n  const upgradeWarehouseFn = () => {\n    dispatch(upgradeWarehouse(warehouseType));\n  }\n\n  let upgradeButton = null;\n  if (warehouseInfo.upgradesTo) {\n    const canAfford = setAffordable({cost: warehouseInfo.upgradeCost}, resources).canAfford;\n    upgradeButton = (\n      <PriceTooltip cost={warehouseInfo.upgradeCost} header='Upgrade for'>\n        <div>\n          <Button variant='primary' size='sm' onClick={upgradeWarehouseFn} disabled={!canAfford}>Upgrade</Button>\n        </div>\n      </PriceTooltip>\n    );\n  }\n\n  return (\n    <div className='resource-panel'>\n      <h4>{warehouseInfo.name}</h4>\n      {upgradeButton}\n      <div className='resource-list'>\n        {Object.keys(resources).map((item, key) => {\n            const resourceName = ResourceDefinitions[item].name;\n            if (item !== 'gold') {\n              return <div key={item}>{resourceName}: {resources[item].owned.toFixed(1)} / {max}</div>;\n            } else {\n              return <div key={item}>{resourceName}: {resources[item].owned.toFixed(1)}</div>;\n            }\n        })}\n      </div>\n    </div>\n  );\n};\n\nexport default ResourcePanel;\n","import React from 'react';\nimport { useSelector, shallowEqual } from 'react-redux';\nimport ResourceDefinitions from '../data/resource-definitions';\n\nimport '../../style/courier.css';\n\nconst CourierMonitor = () => {\n  const couriers = useSelector(state => state.couriers, shallowEqual);\n  const buildings = useSelector(state => state.buildings, shallowEqual);\n\n  function jobDescriptionToString(jobDescription) {\n    if (!jobDescription.id) {\n      return 'Sitting idly';\n    }\n    const what = ResourceDefinitions[jobDescription.carrying].name;\n    const howMuch = jobDescription.amount;\n    const fromWhereId = jobDescription.from;\n    let fromWhere = 'nowhere?!';\n    if (fromWhereId === 'warehouse') {\n      fromWhere = 'the warehouse';\n    } else {\n      const building = buildings.owned[fromWhereId];\n      if (!building) {\n        fromWhere = '???';\n      } else {\n        fromWhere = building.name;\n      }\n    }\n    const toWhereId = jobDescription.to;\n    let toWhere = 'nowhere?!';\n    if (toWhereId === 'warehouse') {\n      toWhere = 'the warehouse';\n    } else {\n      const building = buildings.owned[toWhereId];\n      if (!building) {\n        toWhere = '???';\n      } else {\n        toWhere = building.name;\n      }\n    }\n    return `Delivering ${howMuch} ton of ${what} from ${fromWhere} to ${toWhere}`;\n  }\n\n  const courierList = couriers.couriers.map((courier) => {\n    return (\n      <div className='courier' key={courier.id}>\n        <div>{courier.status}</div>\n        <div>{courier.progress.toFixed(1)}</div>\n        {/**<div>{jobDescriptionToString(courier.jobDescription)}</div>**/}\n        <div>{JSON.stringify(courier.payload)}</div>\n      </div>\n    );\n  });\n\n  return (\n    <div className='courier-monitor'>\n      {courierList}\n    </div>\n  );\n};\n\nexport default CourierMonitor;\n","import React from 'react';\nimport Button from 'react-bootstrap/Button';\nimport Container from 'react-bootstrap/Container';\nimport { useSelector, useDispatch, shallowEqual } from 'react-redux';\nimport { filterUnlocked, setAllAffordable } from '../selectors';\nimport BuildingDefinitions, { BUILDING_CATEGORY } from '../data/building-definitions';\nimport { constructBuilding } from '../actions/construction';\nimport { buildHouse } from '../actions/housing';\nimport { buildWarehouse } from '../actions/warehouse';\nimport PriceTooltip from './PriceTooltip';\n\nimport '../../style/construction.css';\n\nconst ConstructionPanel = () => {\n  const resources = useSelector(state => state.warehouse.resources);\n  const construction = useSelector(state => setAllAffordable(filterUnlocked(state.construction), resources), shallowEqual);\n  const dispatch = useDispatch();\n\n  const constructionList = Object.entries(construction).map(([buildingId, construction]) => {\n    const buildingInfo = BuildingDefinitions[buildingId];\n\n    let buyFunction = null;\n    if (buildingInfo.category === BUILDING_CATEGORY.HOUSE) {\n      buyFunction = () => dispatch(buildHouse(construction));\n    } else if (buildingInfo.category === BUILDING_CATEGORY.WAREHOUSE) {\n      buyFunction = () => dispatch(buildWarehouse(construction));\n    } else {\n      buyFunction = () => dispatch(constructBuilding(construction));\n    }\n\n    return (\n      <div className='construction' key={buildingId}>\n        <div className='construction-header'><p>{buildingInfo.name} {buildingInfo.abbreviation && '(' + buildingInfo.abbreviation + ')'}</p></div>\n        <div>Built: {construction.owned}</div>\n        <PriceTooltip cost={construction.cost} header={buildingInfo.description}>\n          <div>\n            <Button variant='primary' size='sm' className='purchase' onClick={buyFunction} disabled={!construction.canAfford}>Buy</Button>\n          </div>\n        </PriceTooltip>\n      </div>\n    )\n  });\n  return (\n    <Container className='construction-panel'>\n      {constructionList}\n    </Container>\n  )\n};\n\nexport default ConstructionPanel;\n","import React from 'react';\nimport Button from 'react-bootstrap/Button';\nimport Modal from 'react-bootstrap/Modal';\nimport PriceTooltip from './PriceTooltip';\nimport Buildings, {BUILDING_CATEGORY} from '../data/building-definitions';\n\nimport { useSelector, useDispatch, shallowEqual } from 'react-redux';\nimport { destroyBuilding } from '../actions/construction';\nimport { disableBuilding, enableBuilding } from '../actions/building';\nimport { upgradeStorehouse } from '../actions/warehouse';\nimport { setAffordable } from '../selectors';\n\nconst BuildingDetails = (props) => {\n  const resources = useSelector(state => state.warehouse.resources, shallowEqual)\n  const dispatch = useDispatch();\n  const building = props.building;\n  let buildingInfo = Buildings[building.buildingId];\n\n  if (buildingInfo.upgradesTo) {\n    buildingInfo = setAffordable(buildingInfo, resources, 'upgradeCost');\n  }\n\n  const destroyBuildingFn = (toDestroy) => {\n    dispatch(destroyBuilding(toDestroy));\n  }\n\n  const toggleEnableFn = (building) => {\n    if (building.enabled) {\n      dispatch(disableBuilding(building.id));\n    } else {\n      dispatch(enableBuilding(building.id));\n    }\n  }\n\n  const upgradeWarehouseFn = (building) => {\n    dispatch(upgradeStorehouse(building));\n  }\n\n  return (\n    <Modal show={props.show} onHide={props.onClose}>\n      <Modal.Header closeButton>\n        <Modal.Title>{buildingInfo.name}</Modal.Title>\n      </Modal.Header>\n      <Modal.Body>\n        <p>{buildingInfo.description}</p>\n        {\n          buildingInfo.category === BUILDING_CATEGORY.PRODUCER &&\n            <>\n              <div>{building.status}</div>\n              <div>Efficiency: {building.efficiency}</div>\n              <div className='inbox'>Inbox: {JSON.stringify(building.inbox)}</div>\n              <div className='outbox'>Outbox: {JSON.stringify(building.outbox)}</div>\n            </>\n        }\n      </Modal.Body>\n      <Modal.Footer>\n        {\n          buildingInfo.category === BUILDING_CATEGORY.PRODUCER &&\n          <Button variant='warning' size='sm' onClick={() => toggleEnableFn(building)}>{ building.enabled ? 'Disable' : 'Enable'}</Button>\n        }\n        {\n          buildingInfo.upgradesTo &&\n          <PriceTooltip cost={buildingInfo.upgradeCost}>\n            <div>\n              <Button variant='primary' size='sm' disabled={!buildingInfo.canAfford} onClick={() => upgradeWarehouseFn(building)}>Upgrade</Button>\n            </div>\n          </PriceTooltip>\n        }\n        <Button variant='danger' size='sm' onClick={() => destroyBuildingFn(building)}>Destroy</Button>\n      </Modal.Footer>\n    </Modal>\n  );\n};\n\nexport default BuildingDetails;\n","import React, { useState } from 'react';\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\nimport Tooltip from 'react-bootstrap/Tooltip';\nimport BuildingDetails from './BuildingDetails';\n\nimport Buildings, { BUILDING_CATEGORY, buildingStatus } from '../data/building-definitions';\n\nconst BuildingIcon = (props) => {\n  const [showDetails, setShowDetails] = useState(false);\n\n  const handleClose = () => setShowDetails(false);\n  const handleShow = () => setShowDetails(true);\n\n  const building = props.building;\n\n  let toolTipContent = Buildings[building.buildingId].name;\n  let statusColor = null;\n  if (Buildings[building.buildingId].category !== BUILDING_CATEGORY.PRODUCER) {\n    statusColor = 'working';\n  } else {\n    switch (building.status) {\n      case buildingStatus.DISABLED:\n        statusColor = 'disabled';\n        toolTipContent += ' (Disabled)'\n        break;\n      case buildingStatus.AWAITING_RESOURCES:\n        statusColor = 'awaiting';\n        toolTipContent += ' - Awaiting resources!'\n        break;\n      case buildingStatus.OUTBOX_FULL:\n        statusColor = 'outbox-full';\n        toolTipContent += ' - Outbox full!'\n        break;\n      case buildingStatus.WORKING:\n        statusColor = 'working';\n        break;\n      default:\n        break;\n    }\n  }\n\n\n  return (\n    <>\n      <BuildingDetails show={showDetails} onClose={handleClose} building={building}></BuildingDetails>\n      <OverlayTrigger\n        placement='top'\n        delay={{ show: 250, hide: 250 }}\n        overlay={(props) => <Tooltip {...props} id={toolTipContent}>{toolTipContent}</Tooltip>}\n        >\n        <div className={'building-icon ' + statusColor} onClick={handleShow}>\n          {Buildings[building.buildingId].abbreviation}\n        </div>\n      </OverlayTrigger>\n    </>\n  )\n}\n\nexport default BuildingIcon;\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport BuildingIcon from './BuildingIcon';\n\nimport { useSelector, shallowEqual } from 'react-redux';\n\nimport '../../style/building.css';\n\nconst BuildingPanel = () => {\n  const buildings = useSelector(state => state.buildings.owned, shallowEqual);\n\n  const buildingIcons = Object.values(buildings).map((building) =>\n    <BuildingIcon building={building} key={building.id}></BuildingIcon>\n  );\n\n  return (\n    <Container>\n      <div className='building-panel'>\n        {buildingIcons}\n      </div>\n    </Container>\n  );\n};\n\nexport default BuildingPanel;\n","import React from 'react';\nimport PopulationDefinitions from '../data/population-definitions';\nimport { useSelector, shallowEqual } from 'react-redux';\nimport { filterUnlocked } from '../selectors';\n\nimport '../../style/population.css';\n\nconst PopulationPanel = () => {\n  const populationState = useSelector(state => filterUnlocked(state.population), shallowEqual);\n\n  const populationList = Object.values(populationState).map((pop) => {\n      const popName = PopulationDefinitions[pop.id].name;\n      const happiness = pop.happiness ? pop.happiness.toFixed() : 0;\n      let beggarTimer = null;\n      if (pop.id === 'beggar') {\n        beggarTimer = 1200 - pop.beggarTimer;\n      }\n      return <div className='population' key={pop.id}>\n        {popName}: {pop.owned} / {pop.maxPopulation} Happiness: {happiness} {pop.consumeInfo} --- {beggarTimer}\n      </div>\n  });\n\n  return (\n    <div className='population-panel'>\n      {populationList}\n    </div>\n  )\n}\n\nexport default PopulationPanel;\n","import React from 'react';\nimport BuildingDefinitions from '../data/building-definitions';\nimport { useSelector, useDispatch, shallowEqual } from 'react-redux';\nimport { filterUnlocked, setAffordable } from '../selectors';\nimport PriceTooltip from './PriceTooltip';\nimport Button from 'react-bootstrap/Button';\n\nimport { ascendHouse } from '../actions/housing';\n\nimport '../../style/housing.css';\n\nconst HousingPanel = () => {\n  const resources = useSelector(state => state.warehouse.resources, shallowEqual);\n  const dispatch = useDispatch();\n\n  const houses = useSelector((state) => filterUnlocked(state.housing.types), shallowEqual);\n  const population = useSelector((state) => state.population, shallowEqual);\n  let housingList = Object.keys(houses).map((houseId) => {\n    const houseInfo = BuildingDefinitions[houseId];\n    let nextHouseInfo = BuildingDefinitions[houseInfo.ascendsTo];\n    if (nextHouseInfo) {\n      nextHouseInfo = setAffordable(nextHouseInfo, resources);\n    }\n    const housedPopulation = population[houseInfo.populationCategory];\n    const canAscend = (houses[houseId].remainingAscensionRights > 0) && housedPopulation.canAscend && nextHouseInfo.canAfford;\n    const availableAscensions = canAscend ? houses[houseId].remainingAscensionRights : 0;\n    return <div className='housing' key={houseId}>\n      <div className='housing-data'>{houseInfo.name}: {houses[houseId].owned}</div>\n      {\n        nextHouseInfo &&\n        <PriceTooltip cost={nextHouseInfo.cost} header={availableAscensions + ' ascensions available'}>\n          <div>\n            <Button variant='primary' size='sm' onClick={() => {dispatch(ascendHouse(houseId, houseInfo.ascendsTo))}} disabled={!canAscend}>Ascend</Button>\n          </div>\n        </PriceTooltip>\n      }\n    </div>\n  });\n\n  return (\n    <div className='housing-panel'>\n      {housingList}\n    </div>\n  )\n};\n\nexport default HousingPanel;\n","import React from 'react';\nimport { useDispatch } from 'react-redux';\n\nimport { saveGame, loadGame, resetSave } from '../actions/game';\n\nconst SaveLoad = () => {\n  const dispatch = useDispatch();\n\n  const copyState = () => {\n    dispatch(saveGame());\n    const saveState = localStorage.getItem('save');\n    navigator.clipboard.writeText(saveState).then(() => {\n      alert('Saved to clipboard');\n    });\n  }\n\n  const loadState = () => {\n    const loadState = JSON.parse(atob(prompt('Enter load data')));\n    if (!loadState) {\n      alert('Invalid save state');\n    } else {\n      dispatch(loadGame(loadState));\n    }\n  }\n\n  const resetSaveFn = () => {\n    const response = window.confirm('Are you sure you want to clear your save?');\n    if (response) {\n      dispatch(resetSave());\n    }\n  }\n\n  return (\n    <div className='save-load'>\n      <button onClick={copyState}>Save</button>\n      <button onClick={loadState}>Load</button>\n      <button onClick={resetSaveFn}>RESET</button>\n    </div>\n  )\n}\n\nexport default SaveLoad;\n","import React from 'react';\nimport { useSelector, useDispatch, shallowEqual } from 'react-redux';\nimport Resources from '../data/resource-definitions';\nimport Traders from '../data/trader-info';\nimport { buyGood, sellGood, dismissTrader } from '../actions/trade';\nimport { filterUnlocked } from '../selectors';\n\nimport '../../style/trade.css';\n\nconst TradePanel = () => {\n  const traderState = useSelector(state => state.trader, shallowEqual);\n  const warehouse = useSelector(state => state.warehouse, shallowEqual);\n  const dispatch = useDispatch();\n\n  if (traderState.traderId === 0) {\n    return (\n      <div className='trade-panel'>\n        <h4>Your port is empty</h4>\n        Timer: {(traderState.timeToLeave - traderState.timer).toFixed()}\n      </div>\n    );\n  }\n\n  const resources = filterUnlocked(warehouse.resources);\n  const goldOnHand = resources.gold.owned;\n\n  const goodsToTrade = Object.entries(traderState.wares).map(([good, tradeData]) => {\n    const goodInWarehouse = resources[good];\n    if (!goodInWarehouse) {\n      // not unlocked, can't sell\n      return null;\n    }\n    const canBuy = (goldOnHand >= tradeData.sellPrice) && (tradeData.held > 0) && (goodInWarehouse.owned + goodInWarehouse.pending - goodInWarehouse.reserved < warehouse.totalCapacity);\n    const canSell = (tradeData.held < traderState.maxCapacity) && (goodInWarehouse.owned > 0);\n    return <div className='trade-good' key={good}>\n      {Resources[good].name} available: {tradeData.held}\n      <button onClick={() => dispatch(buyGood(good, 1, tradeData.sellPrice))} disabled={!canBuy}>Buy for {tradeData.sellPrice} Gold</button>\n      <button onClick={() => dispatch(sellGood(good, 1, tradeData.buyPrice))} disabled={!canSell}>Sell for {tradeData.buyPrice} Gold</button>\n    </div>\n  });\n\n  const dismissFn = () => {\n    dispatch(dismissTrader(traderState.dismissCost));\n  }\n\n  return (\n    <div className='trade-panel'>\n      <h4>{Traders[traderState.traderId].name} has visited your island!</h4>\n      Timer: {(traderState.timeToLeave - traderState.timer).toFixed()}\n      <button onClick={dismissFn}>Dismiss for {traderState.dismissCost} Gold</button>\n      {goodsToTrade}\n    </div>\n  );\n};\n\nexport default TradePanel;\n","import React from 'react';\nimport { useSelector } from 'react-redux';\nimport Population from '../data/population-definitions';\nimport { unlockThresholds } from '../data/level-up-definitions';\n\nconst MilestonePane = () => {\n  const islandLevel = useSelector(state => state.island.level);\n\n  const unlockReqs = unlockThresholds[islandLevel-1];\n  if (!unlockReqs) {\n    return <div></div>\n  }\n  \n  const popName = Population[unlockReqs[0]].name;\n  const amount = unlockReqs[1];\n\n  return (\n    <div className='milestone'>\n      <p>New unlocks at {amount} {popName}s</p>\n    </div>\n  )\n};\n\nexport default MilestonePane;\n","import React from 'react';\nimport { useSelector, shallowEqual } from 'react-redux';\nimport Ships from '../data/ship-definitions';\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\n\nconst FleetDetails = (props) => {\n  const fleet = useSelector(state => state.navy.fleets[props.fleetId], shallowEqual);\n  const ships = useSelector(state => state.navy.ships, shallowEqual);\n\n  if (!fleet) {\n    return (<></>)\n  }\n\n  return (\n    <Container fluid>\n      <Row>\n        <Col>\n          <h4>{fleet.name}</h4>\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          Ships in this fleet:\n        </Col>\n      </Row>\n    </Container>\n  )\n};\n\nexport default FleetDetails;\n","import React, { useState } from 'react';\nimport { useSelector, shallowEqual } from 'react-redux';\nimport Container from 'react-bootstrap/Container';\nimport Tab from 'react-bootstrap/Tab';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Nav from 'react-bootstrap/Nav';\nimport FleetDetails from './FleetDetails';\n\nconst FleetView = () => {\n  const fleets = useSelector(state => state.navy.fleets, shallowEqual);\n  const [key, setKey] = useState(null);\n\n  const fleetLinks = Object.entries(fleets).map(([id, fleet]) => {\n    const fleetSize = fleet.ships.length;\n    return (\n      <Nav.Item key={id}>\n        <Nav.Link eventKey={id}>\n          <h5>{fleet.name}</h5>\n          {fleetSize} Ships\n        </Nav.Link>\n      </Nav.Item>\n    )\n  });\n\n  return (\n    <Container id='fleet-view' fluid>\n      <Tab.Container id='fleet-selector' activeKey={key} onSelect={key => setKey(key)}>\n        <Row>\n          <Col sm={2}>\n            <Nav variant='pills' className='flex-column'>\n              {fleetLinks}\n            </Nav>\n          </Col>\n          <Col sm={10}>\n            <Tab.Content>\n              <Tab.Pane eventKey={key}>\n                <FleetDetails fleetId={key}></FleetDetails>\n              </Tab.Pane>\n            </Tab.Content>\n          </Col>\n        </Row>\n      </Tab.Container>\n    </Container>\n  )\n}\n\nexport default FleetView;\n","import React, { useState, useEffect } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { tick as dispatchTick, saveGame } from './actions/game';\nimport Scheduler from './scheduler';\nimport Tabs from 'react-bootstrap/Tabs';\nimport Tab from 'react-bootstrap/Tab';\n\nimport IslandNameView from './components/IslandNameView';\nimport TimeFactor from './components/cheats/TimeFactor';\nimport ResourcePanel from './components/ResourcePanel';\nimport CourierMonitor from './components/CourierMonitor';\nimport ConstructionPanel from './components/ConstructionPanel';\nimport BuildingPanel from './components/BuildingPanel';\nimport PopulationPanel from './components/PopulationPanel';\nimport HousingPanel from './components/HousingPanel';\nimport SaveLoad from './components/SaveLoad';\nimport TradePanel from './components/TradePanel';\nimport MilestonePane from './components/MilestonePane';\nimport FleetView from './components/FleetView';\n\nconst MS_TO_S = 1/1000.0;\n\nfunction Game() {\n  const [scheduler] = useState(new Scheduler(tick, 100));\n  const [autoSaveScheduler] = useState(new Scheduler(autoSave, 30000));\n  const dispatch = useDispatch();\n\n  function tick(timeIntervalMs) {\n    dispatch(dispatchTick(timeIntervalMs * MS_TO_S));\n  }\n\n  function autoSave() {\n    dispatch(saveGame());\n    console.log('Saved');\n  }\n\n  useEffect(() => {\n    scheduler.start();\n    autoSaveScheduler.start();\n  }, []);\n\n  return (\n    <div className=\"game\">\n      <IslandNameView></IslandNameView>\n      <MilestonePane></MilestonePane>\n      <Tabs defaultActiveKey='buildings'>\n        <Tab eventKey='buildings' title='Buildings'>\n          <ConstructionPanel></ConstructionPanel>\n          <BuildingPanel></BuildingPanel>\n        </Tab>\n        <Tab eventKey='resources' title='Resources'>\n          <ResourcePanel></ResourcePanel>\n          <CourierMonitor></CourierMonitor>\n        </Tab>\n        <Tab eventKey='population' title='Houses'>\n          <PopulationPanel></PopulationPanel>\n          <HousingPanel></HousingPanel>\n        </Tab>\n        <Tab eventKey='port' title='Port'>\n          <TradePanel></TradePanel>\n          <FleetView></FleetView>\n        </Tab>\n        <Tab eventKey='settings' title='Settings'>\n          <SaveLoad></SaveLoad>\n          <TimeFactor></TimeFactor>\n        </Tab>\n      </Tabs>\n    </div>\n  );\n}\n\nexport default Game;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport configureStore from './js/store/store';\n\nimport './style/index.css';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport Game from './js/Game';\nimport * as serviceWorker from './js/serviceWorker';\n\nReactDOM.render(\n<Provider store={configureStore()}>\n  <Game></Game>\n</Provider>, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import { createStore, applyMiddleware } from 'redux';\nimport thunk from 'redux-thunk';\nimport rootReducer from '../reducers/root-reducer';\nimport INITIAL_STATE from './initial-state';\n\nexport default function configureStore(initialState=INITIAL_STATE) {\n  const saveState = localStorage.getItem('save');\n  let loaded = false;\n  if (saveState) {\n    initialState = JSON.parse(atob(saveState));\n    loaded = true;\n  }\n  if (!loaded) {\n    initialState = rootReducer(null, {type: 'RESET_SAVE'});\n  }\n  return createStore(\n   rootReducer,\n   initialState,\n   applyMiddleware(thunk) && window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()\n  );\n}\n"],"sourceRoot":""}