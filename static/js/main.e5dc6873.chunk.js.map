{"version":3,"sources":["js/actions/game.js","js/reducers/island.js","js/actions/warehouse.js","js/actions/construction.js","js/reducers/building-definitions.js","js/actions/housing.js","js/actions/trade.js","js/reducers/warehouse.js","js/reducers/construction.js","js/reducers/building.js","js/reducers/couriers.js","js/reducers/housing.js","js/reducers/population.js","js/reducers/amenities.js","js/reducers/population-definitions.js","js/reducers/consume.js","js/reducers/growth.js","js/reducers/finance.js","js/reducers/level-up-definitions.js","js/reducers/level-up.js","js/actions/cheats.js","js/reducers/cheat.js","js/data/trader-info.js","js/reducers/resource-definitions.js","js/reducers/trader.js","js/reducers/root-reducer.js","js/store/initial-state.js","js/scheduler.js","js/components/cheats/TimeFactor.js","js/selectors.js","js/components/ResourcePanel.js","js/components/CourierMonitor.js","js/components/ConstructionPanel.js","js/components/BuildingPanel.js","js/components/PopulationPanel.js","js/components/HousingPanel.js","js/components/SaveLoad.js","js/components/TradePanel.js","js/Game.js","js/serviceWorker.js","index.js","js/store/store.js"],"names":["ACTIONS","INIT","TICK","LOAD_GAME","BUILD_WAREHOUSE","CONSTRUCT_BUILDING","DESTROY_BUILDING","BUILDING_CATEGORY","AMENITY","PRODUCER","HOUSE","WAREHOUSE","BuildingDefinitions","marketplace","name","description","category","produces","community","upkeep","chapel","faith","fishinghut","consumes","fish","produceTime","lumberjackhut","wood","orchard","apple","ciderfarm","cider","hempfarm","hemp","weavers","linen","quarry","stone","stonemason","stonebrick","peasanthouse","populationCategory","populationCap","ascendsTo","citizenhouse","cost","tool","smallwarehouse","couriers","capacity","smallstockpile","BUILD_HOUSE","ASCEND_HOUSE","BUY_GOODS","SELL_GOODS","resourceDecorations","reserved","pending","deductCost","resources","resourceCopy","Object","assign","entries","ingredient","amount","ingredientCopy","owned","buildingStatus","AWAITING_RESOURCES","WORKING","OUTBOX_FULL","DISABLED","initialProducerState","status","progress","efficiency","inbox","outbox","BASE_IN_OUT_BOX_CAPACITY","initializeInOutBox","building","keys","good","doProductionTick","timeIntervalS","buildingCopy","consumed","canAfford","produced","outboxHasRoom","inboxCopy","outboxCopy","courierState","initCourier","timeThreshold","jobDescription","payload","markedForDeath","state","action","type","gameActions","startingWarehouse","warehouse","courierArrayCopy","slice","addCouriers","courierObjCopy","warehouseActions","builtWarehouse","toConstruct","id","addedCouriers","newState","newCouriers","newArray","constructionActions","toDestroy","courierList","courierIndex","length","courier","markmarkedForDeath","splice","stateCopy","couriersCopy","warehouseMax","totalCapacity","buildings","buildingRefCopy","newJobs","findJobs","jobArrayCopy","jobQueue","concat","jobList","jobRefCopy","jobQueueMap","jobRef","courierListCopy","map","newCourier","nextJobIndex","getNextAvailableJob","nextJob","pickupFromId","from","deliverToId","to","carrying","pickupFrom","deliverTo","inboxRoom","currentSupply","Math","floor","min","currentOutbox","warehouseRoom","tickIntervalSeconds","fromId","toId","product","hasOwnProperty","resourceToTake","resourceToDeliver","killedCouriers","filter","courierArray","numToAdd","i","uuidv4","push","SUPPLY_SUFFIX","PICKUP_SUFFIX","existingJobs","supplies","values","supplyKey","resource","newJob","pickups","reduce","accumulator","pickupKey","jobArray","jobIndex","initHouseState","popProgress","currentPop","ascensionFactors","rightsLists","patricianhouse","calculateAscensionRights","allTypes","toCheck","totalHouses","sum","pop","totalAscensionRights","ascendTo","alreadyAscended","remainingAscensionRights","initValues","maxPopulation","happiness","canAscend","consumeInfo","amenities","amenity","PopulationDefinitions","peasant","taxRate","quantity","weight","citizen","spice","population","popType","popOriginal","currentHappiness","pctSatisfied","happinessDiff","abs","houses","housing","populationCounts","newAbodes","abodes","abodeOriginal","abode","curHappiness","growthFactor","popCount","newPop","gold","financeInfo","maintenanceCost","taxRevenue","warehouseMaintenance","totalMaintenance","construction","totalTaxes","happinessFactor","unlockThresholds","unlocks","title","island","level","unlockPopType","popRequired","unlocked","constructions","forEach","conId","resId","popUnlocked","types","houseId","unlockedHouse","SET_TIME_FACTOR","cheat","timeFactor","Traders","lord","rates","buy","sell","baseCapacity","ResourceDefinitions","baseTradePrice","BASE_TRADER_STAY_TIME_SECONDS","INIT_STATE","traderId","timer","timeToLeave","wares","newTrader","currentState","traders","selectedTrader","random","traderInfo","maxCapacity","goodBasePrice","buyPrice","sellPrice","held","combinedReducer","combineReducers","warehouseCopy","newResources","resourceId","newResource","housingActions","warehouseToBuild","tradeActions","atPrice","goodBought","toConstructId","newOwned","toDestroyId","buildingId","GAME_ACTIONS","updatedBuilding","CONSTRUCTION_ACTIONS","buildingToBuild","newBuilding","newBuildings","buildingToDestroy","toBuild","fromHouseId","fromHouse","toHouseId","fromType","toType","nextHouse","ascendIndex","findIndex","house","populationState","houseBuilt","modifiedPop","currentHouse","oldPop","nextPop","trader","toBuy","rootReducer","saveState","cheatState","intermediateState","amenityState","consumptionState","consume","growthState","growth","financeState","finance","levelUp","INITIAL_STATE","noblehouse","Scheduler","functionToRun","targetInterval","this","targetFunction","running","lastTick","Date","now","setTimeout","repeater","currentTime","elapsedTime","bind","TimeFactor","dispatch","useDispatch","useState","setTf","className","onSubmit","event","setTimeFactor","preventDefault","onChange","e","target","value","required","filterUnlocked","collectionObject","key","setAllAffordable","buyableCollection","buyableId","buyable","setAffordable","connect","max","item","resourceName","toFixed","CourierMonitor","useSelector","shallowEqual","JSON","stringify","ConstructionPanel","constructionList","buildingInfo","ingredientPanel","buyFunction","onClick","disabled","Building","props","destroyFunc","BuildingPanel","buildingState","destroyBuildingFn","destroyBuilding","buildingList","PopulationPanel","populationList","popName","HousingPanel","housingList","housedPopulation","availableAscensions","toHouse","toBuilding","ascendHouse","SaveLoad","btoa","navigator","clipboard","writeText","then","alert","loadState","parse","atob","prompt","TradePanel","traderState","goldOnHand","goodsToTrade","tradeData","goodInWarehouse","canBuy","canSell","Resources","goodToBuy","goodToSell","MS_TO_S","Game","timeIntervalMs","scheduler","useEffect","start","Boolean","window","location","hostname","match","ReactDOM","render","store","initialState","localStorage","getItem","createStore","applyMiddleware","thunk","__REDUX_DEVTOOLS_EXTENSION__","configureStore","document","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.e5dc6873.chunk.js","sourcesContent":["export const ACTIONS = {\n  INIT: 'INIT',\n  TICK: 'TICK',\n  LOAD_GAME: 'LOAD_GAME'\n};\n\nexport function init() {\n  return { type: ACTIONS.INIT };\n}\n\nexport function tick(tickIntervalSeconds) {\n  return { type: ACTIONS.TICK, payload: { tickIntervalSeconds: tickIntervalSeconds }};\n}\n\nexport function loadGame(saveState) {\n  return { type: ACTIONS.LOAD_GAME, payload: { saveState: saveState }};\n}\n","export default function(island={}, action) {\n  return island;\n}\n","export const ACTIONS = {\n  BUILD_WAREHOUSE: 'BUILD_WAREHOUSE'\n};\n\nexport function buildWarehouse(warehouse) {\n  return { type: ACTIONS.BUILD_WAREHOUSE, payload: { toConstruct: warehouse }};\n}\n","export const ACTIONS = {\n  CONSTRUCT_BUILDING: 'CONSTRUCT_BUILDING',\n  DESTROY_BUILDING: 'DESTROY_BUILDING'\n};\n\nexport function constructBuilding(toConstruct) {\n  return { type: ACTIONS.CONSTRUCT_BUILDING, payload: { toConstruct: toConstruct } };\n};\n\nexport function destroyBuilding(toDestroy) {\n  return { type: ACTIONS.DESTROY_BUILDING, payload: { toDestroy: toDestroy }};\n};\n","export const BUILDING_CATEGORY = {\n  AMENITY: 'AMENITY',\n  PRODUCER: 'PRODUCER',\n  HOUSE: 'HOUSE',\n  WAREHOUSE: 'WAREHOUSE'\n}\n\nconst BuildingDefinitions = {\n  // Amenities\n  marketplace: {\n    name: 'Marketplace',\n    description: 'Provides a place for villagers to meet',\n    category: BUILDING_CATEGORY.AMENITY,\n    produces: {\n      community: 2.5\n    },\n    upkeep: 10\n  },\n  chapel: {\n    name: 'Chapel',\n    description: 'A basic building for villagers to worship',\n    category: BUILDING_CATEGORY.AMENITY,\n    produces: {\n      faith: 2\n    },\n    upkeep: 15\n  },\n\n  // Producers\n  fishinghut: {\n    name: 'Fisherman\\'s Hut',\n    description: 'Gathers fish',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {},\n    produces: {\n      fish: 1\n    },\n    produceTime: 30,\n    upkeep: 15\n  },\n  lumberjackhut: {\n    name: 'Lumberjack\\'s Hut',\n    description: 'Gathers wood',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {},\n    produces: {\n      wood: 1\n    },\n    produceTime: 40,\n    upkeep: 5\n  },\n  orchard: {\n    name: 'Orchard',\n    description: 'Grows apples to be turned into cider',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {},\n    produces: {\n      apple: 1\n    },\n    produceTime: 80,\n    upkeep: 0\n  },\n  ciderfarm: {\n    name: 'Cider Farm',\n    description: 'Processes apples into cider',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {\n      apple: 1\n    },\n    produces: {\n      cider: 1\n    },\n    produceTime: 40,\n    upkeep: 15\n  },\n  hempfarm: {\n    name: 'Hemp Plantation',\n    description: 'Grows hemp',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {},\n    produces: {\n      hemp: 1\n    },\n    produceTime: 60,\n    upkeep: 20\n  },\n  weavers: {\n    name: 'Weaver\\'s Hut',\n    description: 'Uses hemp to create clothing',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {\n      hemp: 1\n    },\n    produces: {\n      linen: 1\n    },\n    produceTime: 30,\n    upkeep: 25\n  },\n  quarry: {\n    name: 'Stone Quarry',\n    description: 'Gathers raw stone',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {},\n    produces: {\n      stone: 1\n    },\n    produceTime: 30,\n    upkeep: 20\n  },\n  stonemason: {\n    name: 'Stonemason',\n    description: 'Turns raw stone into useable bricks',\n    category: BUILDING_CATEGORY.PRODUCER,\n    consumes: {\n      stone: 1\n    },\n    produces: {\n      stonebrick: 1\n    },\n    produceTime: 30,\n    upkeep: 20\n  },\n\n  // Houses\n  peasanthouse: {\n    name: 'Peasant Shack',\n    description: 'Basic home for villagers. Houses 8',\n    category: BUILDING_CATEGORY.HOUSE,\n    upkeep: 0,\n    populationCategory: 'peasant',\n    populationCap: 8,\n    ascendsTo: 'citizenhouse'\n  },\n  citizenhouse: {\n    name: 'Citizen House',\n    description: 'Home for citizens',\n    category: BUILDING_CATEGORY.HOUSE,\n    upkeep: 0,\n    populationCategory: 'citizen',\n    populationCap: 15,\n    ascendsTo: 'patricianhouse',\n    cost: {\n      wood: 1,\n      tool: 1\n    }\n  },\n\n  // Warehouses\n  smallwarehouse: {\n    name: 'Small Warehouse',\n    description: 'Basic warehouse for your island',\n    category: BUILDING_CATEGORY.WAREHOUSE,\n    upkeep: 10,\n    couriers: 3,\n    capacity: 40\n  },\n  smallstockpile: {\n    name: 'Small Stockpile',\n    description: 'Small depot. Provides 1 courier',\n    category: BUILDING_CATEGORY.WAREHOUSE,\n    upkeep: 10,\n    couriers: 1,\n    capacity: 0\n  }\n};\n\nexport default BuildingDefinitions;\n","import BuildingDefinitions from '../reducers/building-definitions';\n\nexport const ACTIONS = {\n  BUILD_HOUSE: 'BUILD_HOUSE',\n  ASCEND_HOUSE: 'ASCEND_HOUSE'\n};\n\nexport function buildHouse(house) {\n  return { type: ACTIONS.BUILD_HOUSE, payload: { toConstruct: house } };\n}\n\nexport function ascendHouse(fromHouse, toHouse) {\n  const toBuilding = BuildingDefinitions[toHouse];\n  return { type: ACTIONS.ASCEND_HOUSE, payload: { toConstruct: toBuilding, fromHouse: fromHouse }};\n}\n","export const ACTIONS = {\n  BUY_GOODS: 'BUY_GOODS',\n  SELL_GOODS: 'SELL_GOODS'\n};\n\nexport function buyGood(goodToBuy, amount, atPrice) {\n  return { type: ACTIONS.BUY_GOODS, payload: { product: goodToBuy, amount: amount, atPrice: atPrice }};\n};\n\nexport function sellGood(goodToSell, amount, atPrice) {\n  return { type: ACTIONS.SELL_GOODS, payload: { product: goodToSell, amount: amount, atPrice: atPrice }};\n};\n","import { ACTIONS } from '../actions/warehouse';\nimport { ACTIONS as gameActions } from '../actions/game';\nimport { ACTIONS as constructionActions } from '../actions/construction';\nimport { ACTIONS as housingActions } from '../actions/housing';\nimport { ACTIONS as tradeActions } from '../actions/trade';\nimport BuildingDefinitions from './building-definitions';\n\nconst resourceDecorations = {\n  reserved: 0,\n  pending: 0\n}\n\nexport default function(warehouse = {}, action) {\n  const payload = action.payload;\n  switch(action.type) {\n    case gameActions.INIT: {\n      // go through each resource and add the decorator, because I don't wanna copy and paste it a billion times\n      const warehouseCopy = Object.assign({}, warehouse);\n      const newResources = Object.entries(warehouseCopy.resources).reduce((accumulator, [resourceId, resource]) => {\n        const newResource = Object.assign({}, resource, resourceDecorations);\n        accumulator[resourceId] = newResource;\n        return accumulator;\n      }, {});\n      warehouseCopy.resources = newResources;\n      return warehouseCopy;\n    }\n    case housingActions.BUILD_HOUSE:\n    case housingActions.ASCEND_HOUSE:\n    case constructionActions.CONSTRUCT_BUILDING: {\n      const warehouseCopy = Object.assign({}, warehouse);\n      let cost = payload.toConstruct.cost;\n      let newResources = deductCost(warehouseCopy.resources, cost);\n      warehouseCopy.resources = newResources;\n      return warehouseCopy;\n    }\n    case ACTIONS.BUILD_WAREHOUSE: {\n      const warehouseCopy = Object.assign({}, warehouse);\n      let cost = payload.toConstruct.cost;\n      let newResources = deductCost(warehouseCopy.resources, cost);\n      warehouseCopy.resources = newResources;\n\n      const warehouseToBuild = BuildingDefinitions[payload.toConstruct.id];\n\n      warehouseCopy.totalCapacity += warehouseToBuild.capacity;\n\n      return warehouseCopy;\n    }\n    case tradeActions.BUY_GOODS: {\n      const good = payload.product;\n      const amount = payload.amount;\n      const atPrice = payload.atPrice;\n\n      const gold = {...warehouse.resources.gold};\n      gold.owned -= amount * atPrice;\n\n      const goodBought = {...warehouse.resources[good]};\n      goodBought.owned += amount;\n\n      const resources = {...warehouse.resources, gold: gold, [good]: goodBought};\n      return {...warehouse, resources: resources};\n    }\n    case tradeActions.SELL_GOODS: {\n      const good = payload.product;\n      const amount = payload.amount;\n      const atPrice = payload.atPrice;\n\n      const gold = {...warehouse.resources.gold};\n      gold.owned += amount * atPrice;\n\n      const goodBought = {...warehouse.resources[good]};\n      goodBought.owned -= amount;\n\n      const resources = {...warehouse.resources, gold: gold, [good]: goodBought};\n      return {...warehouse, resources: resources};\n    }\n    default:\n      return warehouse;\n  }\n}\n\nfunction deductCost(resources, cost) {\n  let resourceCopy = Object.assign({}, resources);\n  for (let [ingredient, amount] of Object.entries(cost)) {\n    let ingredientCopy = Object.assign({}, resourceCopy[ingredient]);\n    ingredientCopy.owned -= amount;\n    resourceCopy[ingredient] = ingredientCopy;\n  }\n  return resourceCopy;\n}\n","import { ACTIONS } from '../actions/construction';\nimport { ACTIONS as housingActions } from '../actions/housing';\nimport { ACTIONS as warehouseActions } from '../actions/warehouse';\n\nexport default function(constructions = {}, action) {\n  let payload = action.payload;\n  switch(action.type) {\n    case warehouseActions.BUILD_WAREHOUSE:\n    case housingActions.BUILD_HOUSE:\n    case ACTIONS.CONSTRUCT_BUILDING:\n      let toConstructId = payload.toConstruct.id;\n      let toConstruct = constructions[toConstructId];\n      let newOwned = Object.assign({}, toConstruct, {owned: toConstruct.owned+1});\n      return Object.assign({}, constructions, {[toConstructId]: newOwned});\n    case ACTIONS.DESTROY_BUILDING:\n      const toDestroyId = payload.toDestroy.buildingId;\n      const toDestroy = {...constructions[toDestroyId]};\n      toDestroy.owned--;\n      return {...constructions, [toDestroyId]: toDestroy};\n    default:\n      return constructions;\n  }\n}\n","import uuidv4 from 'uuid/v4';\n\nimport { ACTIONS as CONSTRUCTION_ACTIONS } from '../actions/construction';\nimport { ACTIONS as GAME_ACTIONS } from '../actions/game';\nimport { ACTIONS as warehouseActions } from '../actions/warehouse';\nimport BuildingDefinitions, { BUILDING_CATEGORY } from './building-definitions';\n\nconst buildingStatus = {\n  AWAITING_RESOURCES: 'AWAITING_RESOURCES',\n  WORKING: 'WORKING',\n  OUTBOX_FULL: 'OUTBOX_FULL',\n  DISABLED: 'DISABLED'\n}\n\nconst initialProducerState = {\n  status: buildingStatus.AWAITING_RESOURCES,\n  progress: 0,\n  efficiency: 0,\n  inbox: {},\n  outbox: {}\n}\n\nexport const BASE_IN_OUT_BOX_CAPACITY = 5;\n\nexport default function(buildings = {}, action) {\n  const payload = action.payload;\n  switch(action.type) {\n    case GAME_ACTIONS.TICK: {\n      if (!buildings.owned) {\n        return buildings;\n      }\n      const newState = Object.assign({}, buildings);\n      const newOwned = Object.assign({}, newState.owned);\n      newState.owned = newOwned;\n\n      const timeIntervalS = payload.tickIntervalSeconds;\n      Object.values(buildings.owned).forEach((building) => {\n        let updatedBuilding = null;\n        if (building.category === BUILDING_CATEGORY.PRODUCER) {\n          updatedBuilding = doProductionTick(building, timeIntervalS);\n        } else {\n          updatedBuilding = building;\n        }\n        newOwned[updatedBuilding.id] = updatedBuilding;\n      });\n      return newState;\n    }\n    case warehouseActions.BUILD_WAREHOUSE:\n    case CONSTRUCTION_ACTIONS.CONSTRUCT_BUILDING:\n      const buildingToBuild = BuildingDefinitions[payload.toConstruct.id];\n      let newBuilding = Object.assign({}, buildingToBuild, {id: uuidv4(), buildingId: payload.toConstruct.id});\n      if (buildingToBuild.category === BUILDING_CATEGORY.PRODUCER) {\n        newBuilding = Object.assign(newBuilding, initialProducerState);\n        initializeInOutBox(newBuilding);\n      }\n      const newBuildings = Object.assign({}, buildings.owned);\n      newBuildings[newBuilding.id] = newBuilding;\n      return Object.assign({}, buildings, {owned: newBuildings});\n    case CONSTRUCTION_ACTIONS.DESTROY_BUILDING:\n      const buildingToDestroy = payload.toDestroy;\n      const newOwned = {...buildings.owned};\n      delete newOwned[buildingToDestroy.id];\n      return {...buildings, owned: newOwned};\n    default:\n      return buildings;\n  }\n}\n\nfunction initializeInOutBox(building) {\n  building.inbox = {};\n  for (let ingredient of Object.keys(building.consumes)) {\n    building.inbox[ingredient] = 0;\n  }\n\n  building.outbox = {};\n  for (let good of Object.keys(building.produces)) {\n    building.outbox[good] = 0;\n  }\n}\n\nfunction doProductionTick(building, timeIntervalS) {\n  let buildingCopy = Object.assign({}, building);\n\n  if (!canAfford(buildingCopy)) {\n    buildingCopy.status = buildingStatus.AWAITING_RESOURCES;\n    return buildingCopy;\n  }\n\n  if (!outboxHasRoom(buildingCopy)) {\n    buildingCopy.status = buildingStatus.OUTBOX_FULL;\n    return buildingCopy;\n  }\n\n  buildingCopy.status = buildingStatus.WORKING;\n\n  buildingCopy.progress += timeIntervalS;\n  if (buildingCopy.progress > buildingCopy.produceTime) {\n    buildingCopy.progress -= buildingCopy.produceTime;\n    let inboxCopy = Object.assign({}, buildingCopy.inbox);\n    let outboxCopy = Object.assign({}, buildingCopy.outbox);\n\n    for (let [ingredient, consumed] of Object.entries(buildingCopy.consumes)) {\n      inboxCopy[ingredient] -= consumed;\n    }\n\n    for (let [good, produced] of Object.entries(buildingCopy.produces)) {\n      outboxCopy[good] += produced;\n    }\n\n    buildingCopy.inbox = inboxCopy;\n    buildingCopy.outbox = outboxCopy;\n  }\n\n  return buildingCopy;\n}\n\nfunction canAfford(building) {\n  for (let [ingredient, consumed] of Object.entries(building.consumes)) {\n    if (building.inbox[ingredient] < consumed) {\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction outboxHasRoom(building) {\n  for (let [good, produced] of Object.entries(building.produces)) {\n    let outboxGood = building.outbox[good];\n    if (outboxGood + produced > BASE_IN_OUT_BOX_CAPACITY) {\n      return false;\n    }\n  }\n  return true;\n}\n","import uuidv4 from 'uuid/v4';\n\nimport { ACTIONS as gameActions } from '../actions/game';\nimport { ACTIONS as warehouseActions } from '../actions/warehouse';\nimport { ACTIONS as constructionActions } from '../actions/construction';\nimport BuildingDefinitions, { BUILDING_CATEGORY } from './building-definitions';\nimport { BASE_IN_OUT_BOX_CAPACITY } from './building';\n\nconst courierState = {\n  IDLE: 'IDLE',\n  PICKING_UP: 'PICKING_UP',\n  EN_ROUTE: 'EN_ROUTE',\n  DROPPING_OFF: 'DROPPING_OFF'\n}\n\nconst BASE_TRAVEL_TIME_SECONDS = 20;\nconst BASE_PICK_UP_DROP_OFF_TIME_SECONDS = 8;\n\nconst initCourier = {\n  status: courierState.IDLE,\n  progress: 0,\n  timeThreshold: 0,\n  jobDescription: {},\n  payload: {},\n  markedForDeath: false\n}\n\nexport default function(state = {}, action) {\n  const payload = action.payload;\n  const couriers = state.couriers;\n  if (!couriers) {\n    return state;\n  }\n  switch(action.type) {\n    case gameActions.INIT:\n      const startingWarehouse = BuildingDefinitions[state.warehouse.type];\n      const courierArrayCopy = couriers.couriers.slice(0);\n      addCouriers(courierArrayCopy, startingWarehouse.couriers);\n      const courierObjCopy = Object.assign({}, couriers);\n      courierObjCopy.couriers = courierArrayCopy;\n      return Object.assign({}, state, {couriers: courierObjCopy});\n    case warehouseActions.BUILD_WAREHOUSE: {\n      const builtWarehouse = BuildingDefinitions[payload.toConstruct.id];\n      const addedCouriers = builtWarehouse.couriers;\n      const newState = Object.assign({}, state);\n      const newCouriers = Object.assign({}, newState.couriers);\n      newState.couriers = newCouriers;\n      const newArray = newCouriers.couriers.slice(0);\n      addCouriers(newArray, addedCouriers);\n      newCouriers.couriers = newArray;\n      return newState;\n    }\n    case constructionActions.DESTROY_BUILDING: {\n      const toDestroy = payload.toDestroy;\n      if (toDestroy.category !== BUILDING_CATEGORY.WAREHOUSE) {\n        return state;\n      }\n\n      const courierList = [...state.couriers.couriers];\n      const couriers = {...state.couriers, couriers: courierList};\n      const newState = {...state, couriers: couriers};\n\n      // try to find a courier that's idle\n      for (let courierIndex = 0; courierIndex < courierList.length; courierIndex++) {\n        const courier = courierList[courierIndex];\n        if (courier.status === courierState.IDLE && !courier.markmarkedForDeath) {\n          courierList.splice(courierIndex, 1);\n          return newState;\n        }\n      }\n\n      // if not, mark the last one for death that isn't already marked\n      for (let courierIndex = courierList.length-1; courierIndex >= 0; courierIndex--) {\n        const courier = courierList[courierIndex];\n        if (!courier.markmarkedForDeath) {\n          courier.markedForDeath = true;\n          return newState;\n        }\n      }\n\n      // no idle couriers, and all active ones are already marked for death so...uh...\n      return newState;\n    }\n    case gameActions.TICK: {\n      const stateCopy = Object.assign({}, state);\n      const couriersCopy = Object.assign({}, stateCopy.couriers);\n      const warehouse = Object.assign({}, stateCopy.warehouse);\n      const warehouseMax = warehouse.totalCapacity;\n      const resources = Object.assign({}, warehouse.resources);\n      warehouse.resources = resources;\n      const buildings = Object.assign({}, stateCopy.buildings);\n      const buildingRefCopy = Object.assign({}, buildings.owned);\n      buildings.owned = buildingRefCopy;\n      stateCopy.warehouse = warehouse;\n      stateCopy.buildings = buildings;\n      stateCopy.couriers = couriersCopy;\n\n      // add new jobs\n      const newJobs = findJobs(couriers, warehouse, buildingRefCopy);\n      let jobArrayCopy = couriers.jobQueue.slice(0).concat(newJobs.jobList);\n      const jobRefCopy = Object.assign({}, couriers.jobQueueMap, newJobs.jobRef);\n\n      // if any couriers are available, pick from the top of the queue\n      const courierListCopy = couriersCopy.couriers.map((courier) => {\n        if (courier.status === courierState.IDLE) {\n          const newCourier = Object.assign({}, courier);\n\n          let nextJobIndex = getNextAvailableJob(jobArrayCopy, buildingRefCopy);\n          const nextJob = jobArrayCopy[nextJobIndex];\n          jobArrayCopy = jobArrayCopy.slice(nextJobIndex+1);\n          if (!nextJob) {\n            return courier;\n          }\n\n          const pickupFromId = nextJob.from;\n          const deliverToId = nextJob.to;\n          const good = nextJob.carrying;\n          let pickupFrom = null;\n          let deliverTo = null;\n          let amount = 0;\n\n          if (pickupFromId !== 'warehouse') {\n            pickupFrom = buildings.owned[pickupFromId];\n          } else {\n            pickupFrom = warehouse;\n          }\n\n          if (deliverToId !== 'warehouse') {\n            deliverTo = buildings.owned[deliverToId];\n          } else {\n            deliverTo = warehouse;\n          }\n\n          if (pickupFromId === 'warehouse') {\n            const inboxRoom = BASE_IN_OUT_BOX_CAPACITY - deliverTo.inbox[good];\n            const currentSupply = Math.floor(resources[good].owned - resources[good].reserved);\n            amount = Math.min(inboxRoom, currentSupply);\n            const resourceCopy = Object.assign({}, resources[good]);\n            resourceCopy.reserved += amount;\n            resources[good] = resourceCopy;\n          } else {\n            const currentOutbox = pickupFrom.outbox[good];\n            const warehouseRoom = Math.floor(warehouseMax - resources[good].owned - resources[good].pending);\n            amount = Math.min(currentOutbox, warehouseRoom);\n            const resourceCopy = Object.assign({}, resources[good]);\n            resourceCopy.pending += amount;\n            resources[good] = resourceCopy;\n          }\n\n          nextJob.amount = amount;\n\n          newCourier.status = courierState.PICKING_UP;\n          newCourier.timeThreshold = BASE_PICK_UP_DROP_OFF_TIME_SECONDS;\n          newCourier.jobDescription = nextJob;\n\n          return newCourier;\n        } else {\n          return courier;\n        }\n      });\n\n      couriersCopy.jobQueue = jobArrayCopy;\n      couriersCopy.jobQueueMap = jobRefCopy;\n\n      // work the couriers already on the job (look into merging with the map function up above)\n      const progressedCouriers = courierListCopy.map((courier) => {\n        if (courier.status === courierState.IDLE) {\n          return courier;\n        }\n\n        courier.progress += payload.tickIntervalSeconds;\n        if (courier.progress >= courier.timeThreshold) {\n          courier.progress -= courier.timeThreshold;\n          const jobDescription = courier.jobDescription;\n          const fromId = jobDescription.from;\n          const toId = jobDescription.to;\n          const product = jobDescription.carrying;\n          const amount = jobDescription.amount;\n          let pickupFrom = null;\n          let deliverTo = null;\n\n          if (fromId !== 'warehouse') {\n            if (buildingRefCopy.hasOwnProperty(fromId)) {\n              pickupFrom = Object.assign({}, buildingRefCopy[fromId]);\n              buildingRefCopy[fromId] = pickupFrom;\n            }\n          } else {\n            pickupFrom = warehouse;\n          }\n\n          if (toId !== 'warehouse') {\n            if (buildingRefCopy.hasOwnProperty(toId)) {\n              deliverTo = Object.assign({}, buildingRefCopy[toId]);\n              buildingRefCopy[toId] = deliverTo;\n            }\n          } else {\n            deliverTo = warehouse;\n          }\n\n          switch (courier.status) {\n            case courierState.PICKING_UP: {\n              const payload = Object.assign({}, courier.payload);\n              courier.payload = payload;\n\n              if (fromId === 'warehouse') {\n                const resourceToTake = Object.assign({}, resources[product]);\n                resources[product] = resourceToTake;\n                resourceToTake.owned -= amount;\n                resourceToTake.reserved -= amount;\n                payload[product] = amount;\n              } else {\n                if (!pickupFrom) { // building got deleted...\n                  courier.payload = {};\n                  courier.status = courierState.IDLE;\n                  courier.jobDescription = {};\n                  courier.progress = 0;\n                  courier.timeThreshold = 0;\n\n                  delete jobRefCopy[courier.jobDescription.id];\n                  break;\n                }\n                const outbox = Object.assign({}, pickupFrom.outbox);\n                pickupFrom.outbox = outbox;\n                outbox[product] -= amount;\n                payload[product] = amount;\n                delete jobRefCopy[courier.jobDescription.id];\n              }\n\n              courier.status = courierState.EN_ROUTE;\n              courier.timeThreshold = BASE_TRAVEL_TIME_SECONDS;\n              break;\n            }\n            case courierState.EN_ROUTE:\n              courier.status = courierState.DROPPING_OFF;\n              courier.timeThreshold = BASE_PICK_UP_DROP_OFF_TIME_SECONDS;\n              break;\n            case courierState.DROPPING_OFF: {\n              // drop off goods\n              const payload = Object.assign({}, courier.payload);\n\n              if (toId === 'warehouse') {\n                const resourceToDeliver = Object.assign({}, resources[product]);\n                resources[product] = resourceToDeliver;\n                resourceToDeliver.owned += payload[product];\n                resourceToDeliver.pending -= amount;\n              } else {\n                if (!deliverTo) { // building got deleted...\n                  // return to warehouse\n                  const resourceToDeliver = Object.assign({}, resources[product]);\n                  resources[product] = resourceToDeliver;\n                  resourceToDeliver.owned += payload[product];\n                } else {\n                  const inbox = Object.assign({}, deliverTo.inbox);\n                  deliverTo.inbox = inbox;\n                  inbox[product] += amount;\n                }\n                delete jobRefCopy[courier.jobDescription.id];\n              }\n\n              courier.payload = {};\n              courier.status = courierState.IDLE;\n              courier.jobDescription = {};\n              courier.progress = 0;\n              courier.timeThreshold = 0;\n              break;\n            }\n            default:\n              break;\n          }\n        }\n        return courier;\n      });\n\n      // check for any idle couriers marked for death\n      const killedCouriers = courierListCopy.filter((courier) => courier.status !== courierState.IDLE || !courier.markedForDeath);\n\n      couriersCopy.couriers = killedCouriers;\n\n      stateCopy.couriers = couriersCopy;\n      return stateCopy;\n    }\n    default:\n      return state;\n  }\n}\n\nfunction addCouriers(courierArray, numToAdd) {\n  for (let i=0; i<numToAdd; i++) {\n    const newCourier = Object.assign({}, initCourier, {id: uuidv4()});\n    courierArray.push(newCourier);\n  }\n}\n\nconst SUPPLY_SUFFIX = '_SUPPLY';\nconst PICKUP_SUFFIX = '_PICKUP';\nfunction findJobs(courier, warehouse, buildings) {\n  const existingJobs = courier.jobQueueMap;\n  const warehouseMax = warehouse.totalCapacity;\n  const resources = warehouse.resources;\n\n  // check buildings that need input fed\n  const supplies = {\n    jobList: [],\n    jobRef: {}\n  }\n  for (let building of Object.values(buildings)) {\n    if (building.category !== BUILDING_CATEGORY.PRODUCER) {\n      continue;\n    }\n    for (let [ingredient, amount] of Object.entries(building.inbox)) {\n      const supplyKey = building.id + '_' + ingredient + '_' + SUPPLY_SUFFIX;\n      if (amount < BASE_IN_OUT_BOX_CAPACITY && !existingJobs[supplyKey]) {\n        const resource = resources[ingredient];\n        const supplyRemaining = Math.floor(resource.owned - resource.reserved);\n        if (supplyRemaining > 0) {\n          const newJob = {\n            id: supplyKey,\n            from: 'warehouse',\n            to: building.id,\n            carrying: ingredient\n          };\n          supplies.jobList.push(newJob);\n          supplies.jobRef[supplyKey] = newJob;\n        }\n      }\n    }\n  }\n\n  // check buildings that need outbox picked up\n  const pickups = Object.values(buildings).reduce((accumulator, building) => {\n    if (building.category !== BUILDING_CATEGORY.PRODUCER) {\n      return accumulator;\n    }\n    for (let [product, amount] of Object.entries(building.outbox)) {\n      const pickupKey = building.id + PICKUP_SUFFIX;\n      if (amount > 0 && !existingJobs[pickupKey]) {\n        const resource = resources[product];\n        const spaceRemaining = Math.floor(warehouseMax - resource.owned - resource.pending);\n        if (spaceRemaining > 0) {\n          const newJob = {\n            id: pickupKey,\n            from: building.id,\n            to: 'warehouse',\n            carrying: product\n          };\n          accumulator.jobList.push(newJob);\n          accumulator.jobRef[pickupKey] = newJob;\n        }\n      }\n    }\n    return accumulator;\n  }, {jobList: [], jobRef: {}});\n\n  const jobList = supplies.jobList.concat(pickups.jobList);\n  const jobRefs = Object.assign({}, supplies.jobRef, pickups.jobRef);\n  return {jobList: jobList, jobRef: jobRefs}; // TODO, this will need to be changed to include supply jobs\n}\n\n// The way a job is invalid is if one of the buildings has since been destroyed\nfunction getNextAvailableJob(jobArray, buildings) {\n  for (let jobIndex = 0; jobIndex < jobArray.length; jobIndex++) {\n    const nextJob = jobArray[jobIndex];\n\n    const pickupFromId = nextJob.from;\n    const deliverToId = nextJob.to;\n\n    if (pickupFromId !== 'warehouse' && !buildings.hasOwnProperty(pickupFromId)) {\n      continue;\n    }\n\n    if (deliverToId !== 'warehouse' && !buildings.hasOwnProperty(deliverToId)) {\n      continue;\n    }\n\n    return jobIndex;\n  }\n}\n","import { ACTIONS } from '../actions/housing';\nimport BuildingDefinitions from './building-definitions';\n\nconst initHouseState = {\n  popProgress: 0,\n  currentPop: 1\n};\n\nconst ascensionFactors = {\n  peasanthouse: .8,\n  citizenhouse: .6\n}\n\n// precomputed list of current house and up because I'm lazy\nconst rightsLists = {\n  peasanthouse: ['peasanthouse', 'citizenhouse'],\n  citizenhouse: ['citizenhouse'],\n  patricianhouse: []\n}\n\nexport default function(housing = {}, action) {\n  const payload = action.payload;\n  switch (action.type) {\n    case ACTIONS.BUILD_HOUSE: {\n      const newState = Object.assign({}, housing);\n      const types = Object.assign({}, newState.types);\n      const abodes = newState.abodes.slice(0);\n      newState.types = types;\n      newState.abodes = abodes;\n\n      const toBuild = payload.toConstruct.id; // should really just be peasanthouse\n      const type = Object.assign({}, types[toBuild]);\n      types[toBuild] = type;\n      const abode = Object.assign({}, BuildingDefinitions[toBuild], initHouseState, {houseId: toBuild});\n\n      type.owned += 1;\n      abodes.push(abode);\n\n      calculateAscensionRights(types, type, toBuild);\n\n      return newState;\n    }\n    case ACTIONS.ASCEND_HOUSE: {\n      const fromHouseId = payload.fromHouse;\n      const toHouseId = BuildingDefinitions[fromHouseId].ascendsTo;\n\n      const fromType = {...housing.types[fromHouseId]};\n      const toType = {...housing.types[toHouseId]};\n      const types = {...housing.types, [fromHouseId]: fromType, [toHouseId]: toType};\n      const abodes = [...housing.abodes];\n      const newState = {...housing, types: types, abodes: abodes};\n      const nextHouse = BuildingDefinitions[toHouseId];\n\n      // find the first house that's able to be ascended\n      const ascendIndex = abodes.findIndex((house) => house.houseId === fromHouseId);\n      abodes.splice(ascendIndex, 1);\n      abodes.push({...nextHouse, ...initHouseState, houseId: toHouseId});\n      fromType.owned -= 1;\n      toType.owned += 1;\n\n      calculateAscensionRights(types, fromType, fromHouseId);\n      calculateAscensionRights(types, toType, toHouseId);\n\n      return newState;\n    }\n    default:\n      return housing;\n  }\n};\n\nfunction calculateAscensionRights(allTypes, type, toCheck) {\n  const totalHouses = rightsLists[toCheck].reduce((sum, pop) => sum + allTypes[pop].owned, 0);\n  type.totalAscensionRights = Math.floor(ascensionFactors[toCheck] * totalHouses);\n  const ascendTo = BuildingDefinitions[toCheck].ascendsTo;\n  const alreadyAscended = rightsLists[ascendTo].reduce((sum, pop) => sum + allTypes[pop].owned, 0);\n  type.remainingAscensionRights = type.totalAscensionRights - alreadyAscended;\n}\n","import { ACTIONS as housingActions } from '../actions/housing';\nimport { ACTIONS as gameActions } from '../actions/game';\nimport BuildingDefinitions from './building-definitions';\n\nconst POP_ASCENSION_HAPPINESS_THRESHOLD = 97;\n\nconst initValues = {\n  owned: 0,\n  maxPopulation: 0,\n  happiness: 0,\n  canAscend: false,\n  consumeInfo: ''\n}\n\nexport default function(populationState = {}, action) {\n  const payload = action.payload;\n  switch (action.type) {\n    case gameActions.INIT: {\n      const newState = Object.assign({}, populationState);\n\n      for (let [popType, pop] of Object.entries(newState)) {\n        const newPop = Object.assign({}, pop, initValues);\n        newState[popType] = newPop;\n      }\n\n      return newState;\n    }\n    case housingActions.BUILD_HOUSE: {\n      const houseBuilt = BuildingDefinitions[payload.toConstruct.id];\n      const newState = Object.assign({}, populationState);\n\n      const modifiedPop = Object.assign({}, newState[houseBuilt.populationCategory]);\n      newState[modifiedPop.id] = modifiedPop;\n\n      modifiedPop.maxPopulation += houseBuilt.populationCap;\n\n      return newState;\n    }\n    case gameActions.TICK: {\n      const population = Object.assign({}, populationState);\n\n      for (let [popType, pop] of Object.entries(population)) {\n        if (pop.happiness > POP_ASCENSION_HAPPINESS_THRESHOLD && pop.owned === pop.maxPopulation) {\n          population[popType] = { ...pop, canAscend: true };\n        } else {\n          population[popType] = { ...pop, canAscend: false}\n        }\n      }\n\n      return population;\n    }\n    case housingActions.ASCEND_HOUSE: {\n      const currentHouse = BuildingDefinitions[payload.fromHouse];\n      const nextHouse = BuildingDefinitions[currentHouse.ascendsTo];\n\n      const oldPop = {...populationState[currentHouse.populationCategory]};\n      const nextPop = {...populationState[nextHouse.populationCategory]};\n\n      oldPop.owned -= currentHouse.populationCap;\n      nextPop.owned += currentHouse.populationCap;\n      oldPop.maxPopulation -= currentHouse.populationCap;\n      nextPop.maxPopulation += nextHouse.populationCap;\n\n      return {...populationState, [currentHouse.populationCategory]: oldPop, [nextHouse.populationCategory]: nextPop};\n    }\n    default:\n      return populationState;\n  }\n};\n","// this could probably be done with thunk instead\nimport { ACTIONS } from '../actions/game';\nimport { BUILDING_CATEGORY } from './building-definitions';\n\nconst TIME_FACTOR = 1 / 60.0;\n\nexport default function(state = {}, action) {\n  const payload = action.payload;\n  switch (action.type) {\n    case ACTIONS.TICK:\n      const timeIntervalS = payload.tickIntervalSeconds;\n      const newState = Object.assign({}, state);\n      const buildings = state.buildings;\n\n      const amenities = {};\n      for (let building of Object.values(buildings.owned)) {\n        if (building.category !== BUILDING_CATEGORY.AMENITY) {\n          continue;\n        }\n\n        for (let [amenity, amount] of Object.entries(building.produces)) {\n          if (!amenities[amenity]) {\n            amenities[amenity] = 0;\n          }\n\n          amenities[amenity] += amount * timeIntervalS * TIME_FACTOR;\n        }\n      }\n\n      newState.amenities = amenities;\n      return newState;\n    default:\n      return state;\n  }\n}\n","const PopulationDefinitions = {\n  peasant: {\n    name: 'Peasant',\n    taxRate: 0.8,\n    consumes: {\n      community: {\n        quantity: 1,\n        weight: 25\n      },\n      fish: {\n        quantity: 1,\n        weight: 25\n      },\n      cider: {\n        quantity: 0.44,\n        weight: 25\n      },\n      faith: {\n        quantity: 1,\n        weight: 25\n      }\n    }\n  },\n  citizen: {\n    name: 'Citizen',\n    taxRate: 0.95,\n    consumes: {\n      fish: {\n        quantity: .4,\n        weight: 8\n      },\n      spice: {\n        quantity: .4,\n        weight: 12\n      },\n      cider: {\n        quantity: .44,\n        weight: 20\n      },\n      linen: {\n        quantity: 0.42,\n        weight: 20\n      },\n      community: {\n        quantity: 1,\n        weight: 20\n      },\n      faith: {\n        quantity: 1,\n        weight: 20\n      }\n    }\n  }\n};\n\nexport default PopulationDefinitions;\n","import { ACTIONS } from '../actions/game';\nimport PopulationDefinitions from './population-definitions';\n\nconst TIME_FACTOR = 1 / 60.0;\nconst CONSUME_FACTOR = 1 / 100.0;\nconst MIN_HAPPINESS_DELTA = 0.001;\n\nexport default function(state = {}, action) {\n  const payload = action.payload;\n  switch (action.type) {\n    case ACTIONS.TICK:\n      const timeIntervalS = payload.tickIntervalSeconds;\n      const newState = Object.assign({}, state);\n      const warehouse = Object.assign({}, newState.warehouse);\n      const resources = Object.assign({}, warehouse.resources);\n      warehouse.resources = resources;\n      const amenities = newState.amenities;\n      const population = Object.assign({}, newState.population);\n      newState.warehouse = warehouse;\n      newState.population = population;\n\n      for (const [popType, popOriginal] of Object.entries(state.population)) {\n        const pop = Object.assign({}, popOriginal);\n        pop.consumeInfo = null;\n        let currentHappiness = 0;\n        if (popOriginal.owned !== 0) {\n          for (const [product, consumeInfo] of Object.entries(PopulationDefinitions[popType].consumes)) {\n            const consumed = consumeInfo.quantity * pop.owned * timeIntervalS * TIME_FACTOR * CONSUME_FACTOR;\n            let pctSatisfied = 1;\n\n            if (amenities[product]) {\n              if (amenities[product] < consumed) {\n                pctSatisfied = amenities[product] / consumed;\n                if (!pop.consumeInfo) {\n                  pop.consumeInfo = 'Need ' + product;\n                }\n              }\n              amenities[product] -= consumed;\n              if (amenities[product] < 0) {\n                amenities[product] = 0;\n              }\n            } else if (resources[product]) {\n              const resource = Object.assign({}, resources[product]);\n              resources[product] = resource;\n\n              if (resource.owned < consumed) {\n                pctSatisfied = resource.owned / consumed\n                if (!pop.consumeInfo) {\n                  pop.consumeInfo = 'Need ' + product;\n                }\n              }\n              resource.owned -= consumed;\n              if (resource.owned < 0) {\n                resource.owned = 0;\n              }\n            } else {\n              pctSatisfied = 0;\n              if (!pop.consumeInfo) {\n                pop.consumeInfo = 'Need ' + product;\n              }\n            }\n\n            currentHappiness += consumeInfo.weight * pctSatisfied;\n          }\n        }\n\n        let happinessDiff = (currentHappiness - pop.happiness) / 100.0;\n        if (Math.abs(happinessDiff) < MIN_HAPPINESS_DELTA) {\n          happinessDiff = MIN_HAPPINESS_DELTA;\n        }\n        pop.happiness += happinessDiff;\n        population[popType] = pop;\n      }\n\n      return newState;\n    default:\n      return state;\n  }\n}\n","import { ACTIONS } from '../actions/game';\n\nconst POP_GROWTH_TIME_SECONDS = 10;\nconst POP_GROWTH_THRESHOLD = 40;\nconst POP_DECLINE_THRESHOLD = 20;\n\nexport default function(state = {}, action) {\n  let payload = action.payload;\n  switch(action.type) {\n    case ACTIONS.TICK:\n      const timeIntervalS = payload.tickIntervalSeconds;\n      const newState = Object.assign({}, state);\n      const houses = Object.assign({}, newState.housing);\n      const population = Object.assign({}, newState.population);\n      newState.housing = houses;\n      newState.population = population;\n\n      const populationCounts = {};\n      // go house by house, increment growth timer\n      const newAbodes = houses.abodes.map((abodeOriginal) => {\n        const abode = Object.assign({}, abodeOriginal);\n        const curHappiness = population[abode.populationCategory].happiness;\n        let growthFactor = 0;\n\n        if (curHappiness >= POP_GROWTH_THRESHOLD && abode.currentPop < abode.populationCap) {\n          growthFactor = 1;\n        }\n        if (curHappiness <= POP_DECLINE_THRESHOLD && abode.currentPop > 0) {\n          growthFactor = -1;\n        }\n\n        abode.popProgress += timeIntervalS * growthFactor;\n        if (abode.popProgress > POP_GROWTH_TIME_SECONDS || abode.popProgress < -POP_GROWTH_TIME_SECONDS) {\n          abode.popProgress -= POP_GROWTH_TIME_SECONDS * growthFactor;\n          abode.currentPop += growthFactor;\n        }\n\n        if (abode.currentPop < 1) {\n          abode.currentPop = 1;\n        }\n\n        if (!populationCounts[abode.populationCategory]) {\n          populationCounts[abode.populationCategory] = 0;\n        }\n\n        populationCounts[abode.populationCategory] += abode.currentPop;\n\n        return abode;\n      });\n      houses.abodes = newAbodes;\n\n      for (let [popType, popCount] of Object.entries(populationCounts)) {\n        const newPop = Object.assign({}, population[popType]);\n        newPop.owned = popCount;\n        population[popType] = newPop;\n      }\n\n      return newState;\n    default:\n      return state;\n  }\n}\n","import { ACTIONS } from '../actions/game';\nimport BuildingDefinitions from './building-definitions';\nimport PopulationDefinitions from './population-definitions';\n\nconst TIME_FACTOR = 1/60.0;\nconst TAX_HAPPINESS_FACTOR = 1 / 100.0;\nconst TAX_HAPPINESS_MINIMUM = 0.01;\n\nexport default function(state = {}, action) {\n  const payload = action.payload;\n  switch (action.type) {\n    case ACTIONS.TICK:\n      const timeIntervalS = payload.tickIntervalSeconds;\n      const newState = Object.assign({}, state);\n      const warehouse = Object.assign({}, newState.warehouse);\n      const resources = Object.assign({}, warehouse.resources);\n      const gold = Object.assign({}, resources.gold);\n      newState.warehouse = warehouse;\n      warehouse.resources = resources;\n      resources.gold = gold;\n\n      const financeInfo = {\n        maintenanceCost: 0,\n        taxRevenue: 0\n      }\n\n      // start with Warehouse maintenance\n      const warehouseMaintenance = BuildingDefinitions[warehouse.type].upkeep * timeIntervalS * TIME_FACTOR;\n      const totalMaintenance = Object.values(state.construction).reduce((sum, construction) => {\n        return sum + (BuildingDefinitions[construction.id].upkeep * construction.owned * timeIntervalS * TIME_FACTOR);\n      }, warehouseMaintenance);\n\n      const totalTaxes = Object.values(state.population).reduce((sum, population) => {\n        let happinessFactor = population.happiness * TAX_HAPPINESS_FACTOR;\n        if (happinessFactor < TAX_HAPPINESS_MINIMUM) {\n          happinessFactor = TAX_HAPPINESS_MINIMUM;\n        }\n        return sum + (PopulationDefinitions[population.id].taxRate * population.owned * timeIntervalS * TIME_FACTOR * happinessFactor);\n      }, 0);\n\n      financeInfo.maintenanceCost = totalMaintenance;\n      financeInfo.taxRevenue = totalTaxes;\n      newState.financeInfo = financeInfo;\n\n      gold.owned = gold.owned + totalTaxes - totalMaintenance;\n\n      return newState;\n    default:\n      return state;\n  }\n}\n","export const unlockThresholds = [\n  ['peasant', 60],\n  ['peasant', 90],\n  ['citizen', 1],\n  ['citizen', 355],\n  ['patrician', 510],\n  ['patrician', 1190],\n  ['nobleman', 950],\n  ['nobleman', 2200],\n  ['nobleman', 3500],\n  ['nobleman', 7500]\n];\n\nexport const unlocks = [\n  // initial state\n  {\n    title: 'Small Settlement',\n    buildings: ['marketplace', 'fishinghut', 'lumberjackhut'],\n    population: 'peasant',\n    resources: ['gold', 'wood', 'tool', 'fish']\n  },\n  // 60 peasants\n  {\n    buildings: ['orchard', 'ciderfarm'],\n    resources: ['apple', 'cider']\n  },\n  // 90 peasants\n  {\n    title: 'Settlement',\n    buildings: ['chapel']\n  },\n  // 1 citizen\n  {\n    population: 'citizen',\n    resources: ['hemp', 'linen', 'stone', 'stonebrick', 'spice'],\n    buildings: ['hempfarm', 'weavers', 'quarry', 'stonemason'],\n    housing: ['citizenhouse']\n  }\n];\n","import { ACTIONS } from '../actions/game';\nimport { unlockThresholds, unlocks } from './level-up-definitions'\n\nexport default function(state = {}, action) {\n  switch (action.type) {\n    case ACTIONS.TICK: {\n      const [unlockPopType, popRequired] = unlockThresholds[state.island.level - 1];\n      const currentPop = state.population[unlockPopType].owned;\n      if (currentPop >= popRequired) {\n        const newState = Object.assign({}, state);\n        const island = Object.assign({}, newState.island);\n        newState.island = island;\n        island.level++;\n\n        const unlocked = unlocks[island.level - 1];\n        if (unlocked.title) {\n          island.title = unlocked.title;\n        }\n        if (unlocked.buildings) {\n          const constructions = Object.assign({}, newState.construction);\n          newState.construction = constructions;\n          unlocked.buildings.forEach(conId => {\n            const construction = Object.assign({}, constructions[conId]);\n            construction.unlocked = true;\n            constructions[conId] = construction;\n          });\n        }\n        if (unlocked.resources) {\n          const warehouse = Object.assign({}, newState.warehouse);\n          const resources = Object.assign({}, warehouse.resources);\n          newState.warehouse = warehouse;\n          warehouse.resources = resources;\n          unlocked.resources.forEach(resId => {\n            const resource = Object.assign({}, resources[resId]);\n            resources[resId] = resource;\n            resource.unlocked = true;\n          });\n        }\n        if (unlocked.population) {\n          const population = Object.assign({}, newState.population);\n          newState.population = population;\n          const popUnlocked = Object.assign({}, population[unlocked.population]);\n          popUnlocked.unlocked = true;\n          population[unlocked.population] = popUnlocked;\n        }\n        if (unlocked.housing) {\n          const types = {...newState.housing.types}\n          const housing = {...newState.housing, types: types};\n          newState.housing = housing;\n          unlocked.housing.forEach(houseId => {\n            const unlockedHouse = {...types[houseId], unlocked: true};\n            types[houseId] = unlockedHouse;\n          });\n        }\n\n        return newState;\n      }\n      return state;\n    }\n    default:\n      return state;\n  }\n}\n","export const ACTIONS = {\n  SET_TIME_FACTOR: 'SET_TIME_FACTOR'\n}\n\nexport function setTimeFactor(timeFactor) {\n  return { type: ACTIONS.SET_TIME_FACTOR, payload: { timeFactor: timeFactor }};\n}\n","import { ACTIONS } from '../actions/cheats';\n\nexport default function(state = {}, action) {\n  const payload = action.payload;\n  switch (action.type) {\n    case ACTIONS.SET_TIME_FACTOR:\n      return {\n        ...state,\n        cheat: {\n          timeFactor: payload.timeFactor\n        }\n      }\n    default:\n      return state;\n  }\n}\n","const Traders = {\n  lord: {\n    name: 'Lord Dude',\n    rates: {\n      wood: {\n        buy: .5,\n        sell: 1\n      },\n      tool: {\n        buy: .5,\n        sell: 1\n      }\n    },\n    baseCapacity: 40\n  }\n};\n\nexport default Traders;\n","const ResourceDefinitions = {\n  gold: {\n    name: 'Gold',\n    baseTradePrice: 1\n  },\n  tool: {\n    name: 'Tool',\n    baseTradePrice: 15\n  },\n  fish: {\n    name: 'Fish',\n    baseTradePrice: 3\n  },\n  wood: {\n    name: 'Wood',\n    baseTradePrice: 1\n  },\n  apple: {\n    name: 'Apple',\n    baseTradePrice: 0.2\n  },\n  cider: {\n    name: 'Cider',\n    baseTradePrice: 3\n  },\n  hemp: {\n    name: 'Hemp',\n    baseTradePrice: 4\n  },\n  linen: {\n    name: 'Clothing',\n    baseTradePrice: 27\n  },\n  stone: {\n    name: 'Stone',\n    baseTradePrice: 6\n  },\n  stonebrick: {\n    name: 'Stone Brick',\n    baseTradePrice: 8\n  },\n  spice: {\n    name: 'Spice',\n    baseTradePrice: 6\n  },\n};\n\nexport default ResourceDefinitions;\n","import { ACTIONS as gameActions } from '../actions/game';\nimport { ACTIONS } from '../actions/trade';\nimport Traders from '../data/trader-info';\nimport ResourceDefinitions from './resource-definitions';\n\nconst BASE_TRADER_STAY_TIME_SECONDS = 240;\n\nconst INIT_STATE = {\n  traderId: 0,\n  timer: 0,\n  timeToLeave: 300,\n  wares: {}\n};\n\nexport default function(trader=INIT_STATE, action) {\n  const payload = action.payload;\n  switch (action.type) {\n    case ACTIONS.BUY_GOODS: {\n      const toBuy = payload.product;\n      const amount = payload.amount;\n      const wares = {...trader.wares};\n      const newState = {...trader, wares: wares};\n\n      wares[toBuy].held -= amount;\n\n      return newState;\n    }\n    case ACTIONS.SELL_GOODS: {\n      const toBuy = payload.product;\n      const amount = payload.amount;\n      const wares = {...trader.wares};\n      const newState = {...trader, wares: wares};\n\n      wares[toBuy].held += amount;\n\n      return newState;\n    }\n    case gameActions.TICK:\n      const timeIntervalS = payload.tickIntervalSeconds;\n      const newState = {...trader};\n      newState.timer += timeIntervalS;\n      if (newState.timer > newState.timeToLeave) {\n        newState.timer -= newState.timeToLeave;\n        return newTrader(newState);\n      }\n      return newState;\n    default:\n      return trader;\n  }\n};\n\nfunction newTrader(currentState) { // atm, more like \"restock goods\"\n  const traders = Object.keys(Traders);\n  const selectedTrader = traders[Math.floor(Math.random() * traders.length)];\n  const traderInfo = Traders[selectedTrader];\n  const wares = {};\n  const maxCapacity = traderInfo.baseCapacity;\n  const timeToLeave = BASE_TRADER_STAY_TIME_SECONDS;\n  const newState = {\n    ...currentState,\n    traderId: selectedTrader,\n    wares: wares,\n    maxCapacity: maxCapacity,\n    timeToLeave: timeToLeave\n  };\n\n  for (let [good, rates] of Object.entries(traderInfo.rates)) {\n    const goodBasePrice = ResourceDefinitions[good].baseTradePrice;\n    const buyPrice = rates.buy * goodBasePrice;\n    const sellPrice = rates.sell * goodBasePrice;\n\n    wares[good] = {\n      buyPrice: buyPrice,\n      sellPrice: sellPrice,\n      held: 0\n    }\n    if (sellPrice > 0) {\n      wares[good].held = maxCapacity;\n    }\n  }\n\n  return newState;\n}\n","import { ACTIONS } from '../actions/game';\nimport { combineReducers } from 'redux';\nimport island from './island';\nimport warehouse from './warehouse';\nimport construction from './construction';\nimport buildings from './building';\nimport couriers from './couriers';\nimport housing from './housing';\nimport population from './population';\nimport amenity from './amenities';\nimport consume from './consume';\nimport growth from './growth';\nimport finance from './finance';\nimport levelUp from './level-up';\nimport cheat from './cheat';\nimport trader from './trader';\n\nconst combinedReducer = combineReducers({\n  cheat: (state = {}) => { return state },\n  island: island,\n  warehouse: warehouse,\n  construction: construction,\n  buildings: buildings,\n  couriers: (state = {}) => { return state }, // no op\n  housing: housing,\n  population: population,\n  trader: trader\n});\n\nfunction rootReducer(state, action) {\n  if (action.type === ACTIONS.LOAD_GAME) {\n    return action.payload.saveState;\n  }\n  if (action.type === ACTIONS.TICK) {\n    let timeFactor = state.cheat.timeFactor;\n    if (!timeFactor) {\n      timeFactor = 1;\n    }\n    action.payload.tickIntervalSeconds *= timeFactor;\n  }\n  const cheatState = cheat(state, action);\n  const intermediateState = combinedReducer(cheatState, action);\n  const courierState = couriers(intermediateState, action);\n  if (action.type === ACTIONS.TICK) {\n    const amenityState = amenity(courierState, action);\n    const consumptionState = consume(amenityState, action);\n    const growthState = growth(consumptionState, action);\n    const financeState = finance(growthState, action);\n    const levelUpState = levelUp(financeState, action);\n    return levelUpState;\n  } else {\n    return courierState;\n  }\n}\n\nexport default rootReducer;\n","const INITIAL_STATE = {\n  island: {\n    level: 1,\n    title: 'Small Settlement',\n    name: 'New Island'\n  },\n  construction: {\n    peasanthouse: {\n      id: 'peasanthouse',\n      owned: 0,\n      cost: {\n        wood: 2\n      },\n      unlocked: true\n    },\n    marketplace: {\n      id: 'marketplace',\n      owned: 0,\n      cost: {\n        gold: 400,\n        wood: 5,\n        tool: 3\n      },\n      unlocked: true\n    },\n    fishinghut: {\n      id: 'fishinghut',\n      owned: 0,\n      cost: {\n        gold: 100,\n        wood: 3,\n        tool: 2\n      },\n      unlocked: true\n    },\n    lumberjackhut: {\n      id: 'lumberjackhut',\n      owned: 0,\n      cost: {\n        gold: 50,\n        tool: 2\n      },\n      unlocked: true\n    },\n    smallstockpile: {\n      id: 'smallstockpile',\n      owned: 0,\n      cost: {\n        gold: 200,\n        wood: 2,\n        tool: 3\n      },\n      unlocked: true\n    },\n    orchard: {\n      id: 'orchard',\n      owned: 0,\n      cost: {\n        gold: 25\n      },\n      unlocked: false\n    },\n    ciderfarm: {\n      id: 'ciderfarm',\n      owned: 0,\n      cost: {\n        gold: 100,\n        wood: 5,\n        tool: 1\n      },\n      unlocked: false\n    },\n    chapel: {\n      id: 'chapel',\n      owned: 0,\n      cost: {\n        gold: 1500,\n        wood: 12,\n        tool: 5\n      },\n      unlocked: false\n    },\n    hempfarm: {\n      id: 'hempfarm',\n      owned: 0,\n      cost: {\n        gold: 400,\n        wood: 5,\n        tool: 2\n      },\n      unlocked: false\n    },\n    weavers: {\n      id: 'weavers',\n      owned: 0,\n      cost: {\n        gold: 400,\n        wood: 5,\n        tool: 3\n      }\n    },\n    quarry: {\n      id: 'quarry',\n      owned: 0,\n      cost: {\n        gold: 400,\n        wood: 2,\n        tool: 2\n      }\n    },\n    stonemason: {\n      id: 'stonemason',\n      owned: 0,\n      cost: {\n        gold: 400,\n        wood: 2,\n        tool: 2\n      }\n    }\n  },\n  buildings: {\n    owned: {}\n  },\n  warehouse: {\n    type: 'smallwarehouse',\n    totalCapacity: 40,\n    resources: {\n      gold: {\n        id: 'gold',\n        owned: 5000,\n        unlocked: true\n      },\n      tool: {\n        id: 'tool',\n        owned: 40,\n        unlocked: true\n      },\n      fish: {\n        id: 'fish',\n        owned: 2,\n        unlocked: true\n      },\n      wood: {\n        id: 'wood',\n        owned: 40,\n        unlocked: true\n      },\n      apple: {\n        id: 'apple',\n        owned: 0,\n        unlocked: false\n      },\n      cider: {\n        id: 'cider',\n        owned: 0,\n        unlocked: false\n      },\n      hemp: {\n        id: 'hemp',\n        owned: 0,\n        unlocked: false\n      },\n      spice: {\n        id: 'spice',\n        owned: 0,\n        unlocked: false\n      },\n      linen: {\n        id: 'linen',\n        owned: 0,\n        unlocked: false\n      },\n      stone: {\n        id: 'stone',\n        owned: 0,\n        unlocked: false\n      },\n      stonebrick: {\n        id: 'stonebrick',\n        owned: 0,\n        unlocked: false\n      }\n    },\n  },\n  couriers: {\n    couriers:[],\n    jobQueue: [],\n    jobQueueMap: {}\n  },\n  housing: {\n    types: {\n      peasanthouse: {\n        owned: 0,\n        totalAscensionRights: 0,\n        remainingAscensionRights: 0,\n        unlocked: true,\n      },\n      citizenhouse: {\n        owned: 0,\n        totalAscensionRights: 0,\n        remainingAscensionRights: 0,\n        unlocked: false,\n      },\n      patricianhouse: {\n        owned: 0,\n        totalAscensionRights: 0,\n        remainingAscensionRights: 0,\n        unlocked: false,\n      },\n      noblehouse: {\n        owned: 0,\n        totalAscensionRights: 0,\n        remainingAscensionRights: 0,\n        unlocked: false,\n      }\n    },\n    abodes: []\n  },\n  population: {\n    peasant: {\n      id: 'peasant',\n      unlocked: true\n    },\n    citizen: {\n      id: 'citizen',\n      unlocked: false\n    }\n  }\n};\n\nexport default INITIAL_STATE;\n","export default class Scheduler {\n  constructor(functionToRun, targetInterval) {\n    this.targetFunction = functionToRun;\n    this.targetInterval = targetInterval;\n    this.running = false;\n  }\n\n  start() {\n    if (this.running) {\n      return;\n    }\n    let lastTick = Date.now();\n    this.running = true;\n    let repeater = () => {\n      if (!this.running) {\n          return;\n      }\n      let currentTime = Date.now();\n      let elapsedTime = currentTime - lastTick;\n      this.targetFunction(elapsedTime);\n      lastTick = currentTime;\n      setTimeout(repeater.bind(this), this.targetInterval);\n    }\n    setTimeout(repeater.bind(this), this.targetInterval);\n  }\n\n  stop() {\n    this.running = false;\n  }\n}\n","import React, { useState } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { setTimeFactor } from '../../actions/cheats';\n\nconst TimeFactor = () => {\n  const dispatch = useDispatch();\n  const [timeFactor, setTf] = useState(1);\n\n  const handleSubmit = (event) => {\n    dispatch(setTimeFactor(timeFactor));\n    event.preventDefault();\n  }\n\n  return (\n    <div className='time-factor'>\n      <form onSubmit={handleSubmit}>\n        <input type='number' name='timeFactor' onChange={e => setTf(e.target.value)} required></input>\n        <input type='submit' value='Set time factor' />\n      </form>\n    </div>\n  )\n};\n\nexport default TimeFactor;\n","export const filterUnlocked = (collectionObject) => {\n  return Object.entries(collectionObject).reduce((accumulator, [key, value]) => {\n    if (value.unlocked) {\n      accumulator[key] = value;\n    }\n    return accumulator;\n  }, {});\n};\n\nexport const setAffordable = (buyable, resources) => {\n  for (let [resource, amount] of Object.entries(buyable.cost)) {\n    if (resources[resource].owned < amount) {\n      return Object.assign({}, buyable, {canAfford: false});\n    }\n  }\n  return Object.assign({}, buyable, {canAfford: true});\n};\n\nexport const setAllAffordable = (buyableCollection, resources) => {\n  return Object.entries(buyableCollection).reduce((accumulator, [buyableId, buyable]) => {\n    accumulator[buyableId] = setAffordable(buyable, resources);\n    return accumulator;\n  }, {});\n};\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { filterUnlocked } from '../selectors';\nimport ResourceDefinitions from '../reducers/resource-definitions';\n\nimport '../../style/resource.css';\n\nconst mapStateToProps = (state) => { return {resources: filterUnlocked(state.warehouse.resources),\n                                             max: state.warehouse.totalCapacity}};\n\nconst ResourcePanel = ({resources, max}) => {\n  return (\n    <div className='resource-panel'>\n      {Object.keys(resources).map((item, key) => {\n          const resourceName = ResourceDefinitions[item].name;\n          if (item !== 'gold') {\n            return <div key={item}>{resourceName}: {resources[item].owned.toFixed(1)} / {max}</div>;\n          } else {\n            return <div key={item}>{resourceName}: {resources[item].owned.toFixed(1)}</div>;\n          }\n      })}\n    </div>\n  );\n};\n\nexport default connect(mapStateToProps)(ResourcePanel);\n","import React from 'react';\nimport { useSelector, shallowEqual } from 'react-redux';\nimport ResourceDefinitions from '../reducers/resource-definitions';\n\nimport '../../style/courier.css';\n\nconst CourierMonitor = () => {\n  const couriers = useSelector(state => state.couriers, shallowEqual);\n  const buildings = useSelector(state => state.buildings, shallowEqual);\n\n  function jobDescriptionToString(jobDescription) {\n    if (!jobDescription.id) {\n      return 'Sitting idly';\n    }\n    const what = ResourceDefinitions[jobDescription.carrying].name;\n    const howMuch = jobDescription.amount;\n    const fromWhereId = jobDescription.from;\n    let fromWhere = 'nowhere?!';\n    if (fromWhereId === 'warehouse') {\n      fromWhere = 'the warehouse';\n    } else {\n      const building = buildings.owned[fromWhereId];\n      if (!building) {\n        fromWhere = '???';\n      } else {\n        fromWhere = building.name;\n      }\n    }\n    const toWhereId = jobDescription.to;\n    let toWhere = 'nowhere?!';\n    if (toWhereId === 'warehouse') {\n      toWhere = 'the warehouse';\n    } else {\n      const building = buildings.owned[toWhereId];\n      if (!building) {\n        toWhere = '???';\n      } else {\n        toWhere = building.name;\n      }\n    }\n    return `Delivering ${howMuch} ton of ${what} from ${fromWhere} to ${toWhere}`;\n  }\n\n  const courierList = couriers.couriers.map((courier) => {\n    return (\n      <div className='courier' key={courier.id}>\n        <div>{courier.status}</div>\n        <div>{courier.progress.toFixed(1)}</div>\n        {/**<div>{jobDescriptionToString(courier.jobDescription)}</div>**/}\n        <div>{JSON.stringify(courier.payload)}</div>\n      </div>\n    );\n  });\n\n  return (\n    <div className='courier-monitor'>\n      {courierList}\n    </div>\n  );\n};\n\nexport default CourierMonitor;\n","import React from 'react';\nimport { useSelector, useDispatch, shallowEqual } from 'react-redux';\nimport { filterUnlocked, setAllAffordable } from '../selectors';\nimport BuildingDefinitions, { BUILDING_CATEGORY } from '../reducers/building-definitions';\nimport ResourceDefinitions from '../reducers/resource-definitions';\nimport { constructBuilding } from '../actions/construction';\nimport { buildHouse } from '../actions/housing';\nimport { buildWarehouse } from '../actions/warehouse';\n\nimport '../../style/construction.css';\n\nconst ConstructionPanel = () => {\n  const resources = useSelector(state => state.warehouse.resources);\n  const construction = useSelector(state => setAllAffordable(filterUnlocked(state.construction), resources), shallowEqual);\n  const dispatch = useDispatch();\n\n  const constructionList = Object.entries(construction).map(([buildingId, construction]) => {\n    const buildingInfo = BuildingDefinitions[buildingId];\n    const ingredientPanel = Object.keys(construction.cost).map((ingredient) => (\n      <div className='construction-ingredient' key={ingredient}>{ResourceDefinitions[ingredient].name}: {construction.cost[ingredient]}</div>\n    ));\n\n    let buyFunction = null;\n    if (buildingInfo.category === BUILDING_CATEGORY.HOUSE) {\n      buyFunction = () => dispatch(buildHouse(construction));\n    } else if (buildingInfo.category === BUILDING_CATEGORY.WAREHOUSE) {\n      buyFunction = () => dispatch(buildWarehouse(construction));\n    } else {\n      buyFunction = () => dispatch(constructBuilding(construction));\n    }\n\n    return (\n      <div className='construction' key={buildingId}>\n        <div className='construction-header'><h4>{buildingInfo.name}</h4></div>\n        <div>Owned: {construction.owned}</div>\n        <div className='ingredientList'>{ingredientPanel}</div>\n        <button className='purchase' onClick={buyFunction} disabled={!construction.canAfford}>Buy</button>\n      </div>\n    )\n  });\n  return (\n    <div className='construction-panel'>\n      {constructionList}\n    </div>\n  )\n};\n\nexport default ConstructionPanel;\n","import React from 'react';\nimport { useSelector, shallowEqual, useDispatch } from 'react-redux';\nimport { BUILDING_CATEGORY } from '../reducers/building-definitions';\nimport { destroyBuilding } from '../actions/construction';\n\nimport '../../style/building.css';\n\nconst BuildingPanel = () => {\n  const buildingState = useSelector(state => state.buildings, shallowEqual);\n  const dispatch = useDispatch();\n  const buildings = buildingState.owned;\n\n  const destroyBuildingFn = (toDestroy) => {\n    dispatch(destroyBuilding(toDestroy));\n  }\n\n  let buildingList = Object.values(buildings).map((building) => {\n    if (building.category === BUILDING_CATEGORY.PRODUCER) {\n      return <Building building={building} key={building.id} destroyFunc={destroyBuildingFn}></Building>\n    } else {\n      return (\n        <div className='building' key={building.id}>\n          <div className='building-header'><h4>{building.name}</h4></div>\n          <button onClick={() => destroyBuildingFn(building)}>Destroy</button>\n        </div>\n      )\n    }\n  });\n\n  return (\n    <div className='building-panel'>\n      {buildingList}\n    </div>\n  );\n};\n\nconst Building = (props) => {\n  let building = props.building;\n  return (\n    <div className='building'>\n      <div className='building-header'><h4>{building.name}</h4></div>\n      <div className='status'>{building.status}</div>\n      <div>{building.progress.toFixed(1)} / {building.produceTime}</div>\n      <div className='inbox'>Inbox: {JSON.stringify(building.inbox)}</div>\n      <div className='outbox'>Outbox: {JSON.stringify(building.outbox)}</div>\n      <button onClick={() => props.destroyFunc(building)}>Destroy</button>\n    </div>\n  )\n};\n\nexport default BuildingPanel;\n","import React from 'react';\nimport PopulationDefinitions from '../reducers/population-definitions';\nimport { useSelector, shallowEqual } from 'react-redux';\nimport { filterUnlocked } from '../selectors';\n\nimport '../../style/population.css';\n\nconst PopulationPanel = () => {\n  const populationState = useSelector(state => filterUnlocked(state.population), shallowEqual);\n\n  const populationList = Object.values(populationState).map((pop) => {\n      const popName = PopulationDefinitions[pop.id].name;\n      const happiness = pop.happiness ? pop.happiness.toFixed() : 0;\n      return <div className='population' key={pop.id}>\n        {popName}: {pop.owned} / {pop.maxPopulation} Happiness: {happiness} {pop.consumeInfo}\n      </div>\n  });\n\n  return (\n    <div className='population-panel'>\n      {populationList}\n    </div>\n  )\n}\n\nexport default PopulationPanel;\n","import React from 'react';\nimport BuildingDefinitions from '../reducers/building-definitions';\nimport { useSelector, useDispatch, shallowEqual } from 'react-redux';\nimport { filterUnlocked } from '../selectors';\n\nimport { ascendHouse } from '../actions/housing';\n\nimport '../../style/housing.css';\n\nconst HousingPanel = () => {\n  const dispatch = useDispatch();\n\n  const houses = useSelector((state) => filterUnlocked(state.housing.types), shallowEqual);\n  const population = useSelector((state) => state.population, shallowEqual);\n  let housingList = Object.keys(houses).map((houseId) => {\n    const housedPopulation = population[BuildingDefinitions[houseId].populationCategory];\n    const canAscend = (houses[houseId].remainingAscensionRights > 0) && housedPopulation.canAscend;\n    const availableAscensions = canAscend ? houses[houseId].remainingAscensionRights : 0;\n    return <div className='housing' key={houseId}>\n      <div className='housing-data'>{BuildingDefinitions[houseId].name}: {houses[houseId].owned}</div>\n      <div><button onClick={() => {dispatch(ascendHouse(houseId, BuildingDefinitions[houseId].ascendsTo))}} disabled={!canAscend}>Ascend</button>{availableAscensions}</div>\n    </div>\n  });\n\n  return (\n    <div className='housing-panel'>\n      {housingList}\n    </div>\n  )\n};\n\nexport default HousingPanel;\n","import React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\n\nimport { loadGame } from '../actions/game';\n\nconst SaveLoad = () => {\n  const state = useSelector(state => state);\n  const dispatch = useDispatch();\n\n  const copyState = () => {\n    const saveState = btoa(JSON.stringify(state));\n    navigator.clipboard.writeText(saveState).then(() => {\n      alert('Saved to clipboard');\n    });\n  }\n\n  const loadState = () => {\n    const loadState = JSON.parse(atob(prompt('Enter load data')));\n    if (!loadState) {\n      alert('Invalid save state');\n    } else {\n      dispatch(loadGame(loadState));\n    }\n  }\n\n  return (\n    <div className='save-load'>\n      <button onClick={copyState}>Save</button>\n      <button onClick={loadState}>Load</button>\n    </div>\n  )\n}\n\nexport default SaveLoad;\n","import React from 'react';\nimport { useSelector, useDispatch, shallowEqual } from 'react-redux';\nimport Resources from '../reducers/resource-definitions';\nimport Traders from '../data/trader-info';\nimport { buyGood, sellGood } from '../actions/trade';\n\nimport '../../style/trade.css';\n\nconst TradePanel = () => {\n  const traderState = useSelector(state => state.trader, shallowEqual);\n  const warehouse = useSelector(state => state.warehouse, shallowEqual);\n  const dispatch = useDispatch();\n\n  if (traderState.traderId === 0) {\n    return (\n      <div className='trade-panel'>\n      </div>\n    );\n  }\n\n  const resources = warehouse.resources;\n  const goldOnHand = resources.gold.owned;\n\n  const goodsToTrade = Object.entries(traderState.wares).map(([good, tradeData]) => {\n    const goodInWarehouse = resources[good];\n    const canBuy = (goldOnHand >= tradeData.sellPrice) && (tradeData.held > 0) && (goodInWarehouse.owned + goodInWarehouse.pending - goodInWarehouse.reserved < warehouse.totalCapacity);\n    const canSell = (tradeData.held < traderState.maxCapacity) && (goodInWarehouse.owned > 0);\n    return <div className='trade-good' key={good}>\n      {Resources[good].name} available: {tradeData.held}\n      <button onClick={() => dispatch(buyGood(good, 1, tradeData.sellPrice))} disabled={!canBuy}>Buy for {tradeData.sellPrice} Gold</button>\n      <button onClick={() => dispatch(sellGood(good, 1, tradeData.buyPrice))} disabled={!canSell}>Sell for {tradeData.buyPrice} Gold</button>\n    </div>\n  });\n\n  return (\n    <div className='trade-panel'>\n      {goodsToTrade}\n    </div>\n  );\n};\n\nexport default TradePanel;\n","import React, { useState, useEffect } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { tick as dispatchTick, init as dispatchInit } from './actions/game';\nimport Scheduler from './scheduler';\n\nimport TimeFactor from './components/cheats/TimeFactor';\nimport ResourcePanel from './components/ResourcePanel';\nimport CourierMonitor from './components/CourierMonitor';\nimport ConstructionPanel from './components/ConstructionPanel';\nimport BuildingPanel from './components/BuildingPanel';\nimport PopulationPanel from './components/PopulationPanel';\nimport HousingPanel from './components/HousingPanel';\nimport SaveLoad from './components/SaveLoad';\nimport TradePanel from './components/TradePanel';\n\nconst MS_TO_S = 1/1000.0;\n\nfunction Game() {\n  const [scheduler] = useState(new Scheduler(tick, 100));\n  const dispatch = useDispatch();\n\n  function tick(timeIntervalMs) {\n    dispatch(dispatchTick(timeIntervalMs * MS_TO_S));\n  }\n\n  useEffect(() => {\n    dispatch(dispatchInit());\n    scheduler.start();\n  }, []);\n\n  return (\n    <div className=\"game\">\n      <SaveLoad></SaveLoad>\n      <TimeFactor></TimeFactor>\n      <ResourcePanel></ResourcePanel>\n      <TradePanel></TradePanel>\n      <PopulationPanel></PopulationPanel>\n      <HousingPanel></HousingPanel>\n      <CourierMonitor></CourierMonitor>\n      <ConstructionPanel></ConstructionPanel>\n      <BuildingPanel></BuildingPanel>\n    </div>\n  );\n}\n\nexport default Game;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport configureStore from './js/store/store';\n\nimport './style/index.css';\nimport Game from './js/Game';\nimport * as serviceWorker from './js/serviceWorker';\n\nReactDOM.render(\n<Provider store={configureStore()}>\n  <Game></Game>\n</Provider>, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import { createStore, applyMiddleware } from 'redux';\nimport thunk from 'redux-thunk';\nimport rootReducer from '../reducers/root-reducer';\nimport INITIAL_STATE from './initial-state';\n\nexport default function configureStore(initialState=INITIAL_STATE) {\n  const saveState = localStorage.getItem('save');\n  if (saveState) {\n    initialState = JSON.parse(atob(prompt('Enter load data')));\n  }\n  if (!initialState) {\n    initialState = INITIAL_STATE;\n  }\n return createStore(\n   rootReducer,\n   initialState,\n   applyMiddleware(thunk) && window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()\n );\n}\n"],"sourceRoot":""}